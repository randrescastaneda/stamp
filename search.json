[{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"key-concepts","dir":"Articles","previous_headings":"","what":"Key concepts","title":"Builders, Plans, and Rebuilds","text":"Builder: function registered st_register_builder(path, builder_fn). Signature: function(path, parents). must return list least: x: object save code: producing function(s) used compute x (used compute code_hash) optional code_label: short tag used sidecars Plan: result st_plan_rebuild() inspects recorded parents, code_hash values artifact presence. describes actions required bring targets --date. Rebuild: executing plan st_rebuild(plan). st_rebuild() calls registered builders st_save() produced artifact, recording new versions sidecars.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"minimal-example-single-target","dir":"Articles","previous_headings":"","what":"Minimal example (single-target)","title":"Builders, Plans, and Rebuilds","text":"","code":"# Suppose we have a summary target path summary_path <- \"outputs/welfare_summary.qs2\"  # Register a simple builder that loads parents and returns x+code st_register_builder(summary_path, function(path, parents) {   # Load welfare parents (illustrative — adapt to your parents layout)   welfare_paths <- vapply(     parents,     function(p) grepl(\"welfare\", p$path),     logical(1)   )   welfare_list <- lapply(parents[welfare_paths], function(p) st_load(p$path))    # Load macros (shared parents)   cpi_tbl <- st_load(\"data/macro/cpi.qs2\")   gdp_tbl <- st_load(\"data/macro/gdp.qs2\")   pop_tbl <- st_load(\"data/macro/population.qs2\")    # call a pure worker that accepts pre-loaded inputs   out <- bar(welfare_list, cpi_tbl, gdp_tbl, pop_tbl)    list(     x = out,     code = list(bar = bar),     code_label = \"aggregate_welfare\"   ) })  # Inspect plan (strict mode is conservative) plan <- st_plan_rebuild(   targets = summary_path,   include_targets = TRUE,   mode = \"strict\" ) plan  # Run only if you're ready # st_rebuild(plan)"},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"multi-function-code-metadata","dir":"Articles","previous_headings":"","what":"Multi-function code metadata","title":"Builders, Plans, and Rebuilds","text":"target depends multiple functions (e.g. bar() calls helpers h1() h2()), include explicitly code st_save() computes combined hash changes helper changes: ensures st_is_stale() plan computation detect code changes across whole chain.","code":"# Good: include all contributing functions st_save(   x,   summary_path,   pk = c(\"country\", \"year\"),   parents = parents,   code = list(bar = bar, h1 = h1, h2 = h2) )"},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"partitioned-targets-and-partial-rebuilds","dir":"Articles","previous_headings":"","what":"Partitioned targets and partial rebuilds","title":"Builders, Plans, and Rebuilds","text":"Builders can produce partitioned outputs can register many builders — one per partition — enable targeted re-computation. Two patterns: Parent-driven builders: builder receives parents loads parents needs. simple parents explicit named sidecar. Directory-driven builders: builder identifies partition key path argument computes output key (see vignettes/stamp.Rmd end--end example). Example: register partitioned builder per-key summaries (illustrative): macro like CPI changes COL 2012, st_plan_rebuild() mark partitioned targets stale st_rebuild() execute registered builders required.","code":"summary_parts_dir <- \"outputs/summary_parts\"  st_register_builder(   fs::path(     summary_parts_dir,     \"country=COL/year=2012/reporting_level=urban/out.qs2\"   ),   function(path, parents) {     # parse key from path or use parents to find the matching welfare partition     key <- list(country = \"COL\", year = 2012L, reporting_level = \"urban\")      # load only matching partition + macros     w <- st_load(st_part_path(\"data/welfare_parts\", key))     cpi <- st_load(\"data/macro/cpi.qs2\")[       country == key$country &         year == key$year &         reporting_level == key$reporting_level     ]     gdp <- st_load(\"data/macro/gdp.qs2\")[       country == key$country & year == key$year     ]      out <- bar(       list(w),       cpi,       gdp,       st_load(\"data/macro/population.qs2\")[         country == key$country &           year == key$year &           reporting_level == key$reporting_level       ]     )      list(x = out, code = list(bar = bar), code_label = \"partition_summary\")   } )"},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"modes-strict-vs-relaxed","dir":"Articles","previous_headings":"","what":"Modes: strict vs relaxed","title":"Builders, Plans, and Rebuilds","text":"mode = \"strict\" treats missing parents mismatched code hashes conservatively — prefer correctness. mode = \"relaxed\" may skip checks avoid unnecessary recomputation noisy environments; use caution.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"tips-best-practices","dir":"Articles","previous_headings":"","what":"Tips & best practices","title":"Builders, Plans, and Rebuilds","text":"Prefer pure worker functions accept inputs arguments. makes testing registration easier. Register builders use parents argument; avoid global state possible. Include helper functions code metadata relevant change invalidates dependent artifacts. Keep builders deterministic side-effect free (don’t write inside builder; instead return x let st_rebuild() call st_save()).","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"try-it-locally","dir":"Articles","previous_headings":"","what":"Try it locally","title":"Builders, Plans, and Rebuilds","text":"try examples interactively, set eval = TRUE setup chunk run examples inside interactive R session. Use short root_dir avoid Windows PATH length issues.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"appendix-example-plan-interpretation","dir":"Articles","previous_headings":"","what":"Appendix: example plan interpretation","title":"Builders, Plans, and Rebuilds","text":"plan list--lists; entry includes target (path), reason (parent_changed, code_changed, missing) builder info. Inspect plan filter reorder actions calling st_rebuild(). Example (pseudo-inspection):","code":"plan <- st_plan_rebuild(targets = summary_path, include_targets = TRUE) # Show targets that are stale Filter(function(x) x$reason != \"uptodate\", plan)"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"recommended-options","dir":"Articles","previous_headings":"","what":"Recommended options","title":"Hashing, Change Detection and Versions","text":"","code":"st_opts_reset() st_opts(   versioning = \"content\", # skip write when content unchanged   code_hash = TRUE, # store code hash when 'code=' is provided to st_save()   store_file_hash = TRUE, # compute & store file hash after write   verify_on_load = TRUE, # verify content on load (warn on mismatch)   meta_format = \"both\" # write JSON + QS2 sidecars ) ## ✔ stamp options updated ##   versioning = \"content\", code_hash = \"TRUE\", store_file_hash = \"TRUE\", ##   verify_on_load = \"TRUE\", meta_format = \"both\""},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"save-with-hashes-and-skip-if-content-identical","dir":"Articles","previous_headings":"","what":"Save with hashes (and skip if content identical)","title":"Hashing, Change Detection and Versions","text":"snippet stamp serializes x deterministic way computes content hash. content hash (provided) code hash match stored metadata, new version created versioning = \"content\". Note: first write always create artifact sidecar(s). see first write skipped, check path passed st_save() exactly matches subsequent calls. change content (change code), new version recorded: Policy: design, changing code= pass st_save() creates new version even x identical. makes code provenance explicit. short practical pattern: Pass transformation code st_save(..., code = <function expression>) stamp can record code hash. Use st_changed() st_should_save() cheaply decide whether run expensive computations calling st_save().","code":"root <- tempdir() st_init(root) ## ✔ stamp initialized ##   root: /tmp/RtmpyTTjdZ ##   state: /tmp/RtmpyTTjdZ/.stamp p <- fs::path(root, \"demo.qs\") x <- data.frame(a = 1:3)  # First write: creates artifact + sidecars + catalog entry st_save(x, p, code = function(z) z) ## ✔ Saved [qs] → /tmp/RtmpyTTjdZ/demo.qs @ version ## c5ccbce04ac9cb64 # Second write, same content & same code: skipped (no new version) st_save(x, p, code = function(z) z) ## ✔ Skip save (reason: no_change_policy) for ## /tmp/RtmpyTTjdZ/demo.qs nrow(st_versions(p)) # should be 1 ## [1] 1 x2 <- transform(x, a = a + 1L) st_save(x2, p, code = function(z) z) ## ✔ Saved [qs] → /tmp/RtmpyTTjdZ/demo.qs @ version ## 3277d2156df5ee06 nrow(st_versions(p)) # now 2 ## [1] 2 st_latest(p) # latest version id (string) ## [1] \"3277d2156df5ee06\""},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"inspect-sidecars-metadata","dir":"Articles","previous_headings":"","what":"Inspect sidecars & metadata","title":"Hashing, Change Detection and Versions","text":"Explanation: content_hash stable hash R object written (via st_hash_obj()). code_hash recorded provide code= st_save() (via st_hash_code()). file_hash computed file write (store_file_hash = TRUE) can used detect external file tampering. content_hash comes st_hash_obj(x) code_hash comes st_hash_code(code) supplied code= file_hash optional (post-write) used verify load","code":"meta <- st_read_sidecar(p) meta[c(   \"format\",   \"created_at\",   \"size_bytes\",   \"content_hash\",   \"code_hash\",   \"file_hash\" )] ## $format ## [1] \"qs\" ##  ## $created_at ## [1] \"2026-01-12T22:55:25.515351Z\" ##  ## $size_bytes ## [1] 137 ##  ## $content_hash ## [1] \"7e25cdd35cd37239\" ##  ## $code_hash ## [1] \"488e8fa49c740261\" ##  ## $file_hash ## [1] \"28d069cce24a86f3\""},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"change-detection-without-writing","dir":"Articles","previous_headings":"","what":"Change detection (without writing)","title":"Hashing, Change Detection and Versions","text":"Use expensive work, decide whether recompute. call st_changed() st_changed_reason() avoid performing file writes. helpers ideal guards inside functions compute expensive results necessary: Example pattern inside pipeline function:","code":"x_same <- x2 x_new <- transform(x2, a = a + 10L)  st_changed(p, x = x_same, code = function(z) z) ## $changed ## [1] FALSE ##  ## $reason ## [1] \"no_change\" ##  ## $details ## $details$content_changed ## [1] FALSE ##  ## $details$code_changed ## [1] FALSE ##  ## $details$file_changed ## [1] FALSE st_changed_reason(p, x = x_same, code = function(z) z) # \"no_change\" ## [1] \"no_change\" st_changed(p, x = x_new, code = function(z) z) ## $changed ## [1] TRUE ##  ## $reason ## [1] \"content\" ##  ## $details ## $details$content_changed ## [1] TRUE ##  ## $details$code_changed ## [1] FALSE ##  ## $details$file_changed ## [1] FALSE st_changed_reason(p, x = x_new, code = function(z) z) # \"content\" ## [1] \"content\" st_should_save(p, x = x_same, code = function(z) z) # recommends skip ## $save ## [1] FALSE ##  ## $reason ## [1] \"no_change_policy\" st_should_save(p, x = x_new, code = function(z) z) # recommends save ## $save ## [1] TRUE ##  ## $reason ## [1] \"content\" if (st_should_save(p, x = out, code = my_transform)$save) {   st_save(out, p, code = my_transform) } else {   message(\"Skipping write; content and code unchanged\") }"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"loading-specific-versions","dir":"Articles","previous_headings":"","what":"Loading specific versions","title":"Hashing, Change Detection and Versions","text":"st_versions() returns table version metadata. row includes version_id, created_at, snapshot sidecar fields available commit time. Use st_load_version() restore artifact version.","code":"vids <- st_versions(p) head(vids) ##          version_id      artifact_id     content_hash        code_hash ##              <char>           <char>           <char>           <char> ## 1: 3277d2156df5ee06 3be112d87e0d3b53 7e25cdd35cd37239 488e8fa49c740261 ## 2: c5ccbce04ac9cb64 3be112d87e0d3b53 1811ba4b2bd2a26a 488e8fa49c740261 ##    size_bytes                  created_at sidecar_format ##         <num>                      <char>         <char> ## 1:        137 2026-01-12T22:55:25.515351Z           both ## 2:        137 2026-01-12T22:55:25.367851Z           both vid_latest <- st_latest(p) obj_latest <- st_load_version(p, vid_latest) ## ✔ Loaded ← /tmp/RtmpyTTjdZ/demo.qs @ ## 3277d2156df5ee06 [qs] # Load an older version by id if (nrow(vids) > 1L) {   vid_old <- vids$version_id[[nrow(vids)]]   obj_old <- st_load_version(p, vid_old) } ## ✔ Loaded ← /tmp/RtmpyTTjdZ/demo.qs @ ## c5ccbce04ac9cb64 [qs]"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"where-are-versions-stored","dir":"Articles","previous_headings":"Loading specific versions","what":"Where are versions stored?","title":"Hashing, Change Detection and Versions","text":"Snapshots live .stamp/versions/<relative-path>/<version_id>/. snapshot dir contains: artifact — copy saved file sidecar.json /sidecar.qs2 — depending meta_format Additionally snapshot may include parents.json file capturing committed lineage artifacts; created stamp records explicit parents commit. Sidecar metadata (stmeta/) primary local source used decide whether write, snapshots long-term committed record.","code":"p <- fs::path(root, \"demo.qs\") x <- data.frame(a = 1:5)  # Write once to create a version snapshot st_save(x, p, code = function(z) z) ## ✔ Saved [qs] → /tmp/RtmpyTTjdZ/demo.qs @ version ## 24ee3249a40f304a # Now list the versions tree vroot <- stamp:::.st_versions_root() fs::dir_tree(vroot, recurse = TRUE, all = TRUE) ## /tmp/RtmpyTTjdZ/.stamp/versions ## └── demo.qs ##     ├── 24ee3249a40f304a ##     │   ├── artifact ##     │   ├── sidecar.json ##     │   └── sidecar.qs2 ##     ├── 3277d2156df5ee06 ##     │   ├── artifact ##     │   ├── sidecar.json ##     │   └── sidecar.qs2 ##     └── c5ccbce04ac9cb64 ##         ├── artifact ##         ├── sidecar.json ##         └── sidecar.qs2"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"integrity-checks-on-load-optional","dir":"Articles","previous_headings":"","what":"Integrity checks on load (optional)","title":"Hashing, Change Detection and Versions","text":"verify_on_load = TRUE content_hash exists sidecar, st_load() recomputes object’s hash warns differs (indicating file changed outside stamp). verify_on_load = TRUE, st_load() recomputes st_hash_obj() compares content_hash recorded sidecar snapshot. mismatch usually means file modified outside stamp re-saving recommended.","code":"invisible(st_load(p)) # triggers optional verify; warns on mismatch ## Warning: Loaded object hash mismatch for /tmp/RtmpyTTjdZ/demo.qs (content hash differs ## from sidecar). ## Warning: No primary key recorded for /tmp/RtmpyTTjdZ/demo.qs. ## ℹ You can add one with `st_add_pk()`. ## ✔ Loaded [qs] ← /tmp/RtmpyTTjdZ/demo.qs"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"troubleshooting","dir":"Articles","previous_headings":"","what":"Troubleshooting","title":"Hashing, Change Detection and Versions","text":"Q: first st_save() skipped st_versions(p) 0. : first write never skipped. Ensure ’re using current st_should_save() returns save = TRUE artifact missing sidecar missing. Q: st_changed_reason() says \"missing_meta\". : artifact exists sidecar removed unreadable. Call st_save(x, p, code = ...) ; re-materialize metadata record version. Q: Changing code= didn’t create new version. : design, code change create new version. Confirm st_opts(\"code_hash\", .get = TRUE) TRUE passed code= consistently (e.g., function literal, different object pointers identical functions rare cases). Q: CSV round-trips aren’t byte-identical. : data.table::fread/fwrite may coerce types (e.g., integers vs doubles). Compare relaxed checks coerce types comparison. Q: see warning load hash mismatch. : verify_on_load = TRUE, stamp recomputes object hash warns differs sidecar’s content_hash. indicates file modified outside stamp sidecar stale. Re-save repair. Q: qs2 isn’t installed. : qs2 preferred. unavailable, stamp falls back qs read/write \"qs2\" handler. Install qs2 best performance. Q: Sidecars appearing. : Check st_opts(\"meta_format\", .get = TRUE) — set \"json\", \"qs2\", \"\". Sidecars written stmeta/ next artifact. Q: Versions aren’t expect. : Version snapshots live .stamp/versions/<relative-path>/<version_id>/. Use code snippet explore tree.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"tips-conventions","dir":"Articles","previous_headings":"","what":"Tips & conventions","title":"Hashing, Change Detection and Versions","text":"Keep versioning = \"content\" reproducible artifacts; use \"timestamp\" want new version every save; \"\" skip versioning entirely. Use st_changed() / st_should_save() gate expensive computation inside functions. Sidecars: prefer meta_format = \"json\" readability, \"qs2\" compactness, \"\" redundancy. reading / next steps: See lineage-rebuilds vignette committed parents sidecar parents interact st_rebuild(). Consider recording code= critical data transformations provenance preserved even object content identical.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"setup-a-tiny-graph-a-ba-cb","dir":"Articles","previous_headings":"","what":"Setup a tiny graph A → B(A) → C(B)","title":"Lineage and Rebuilds","text":"Note: saves artifact sidecar (stmeta/) snapshots .stamp/versions/. Committed parents vs sidecar example short interactive example shows difference committed parents (stored inside version snapshot) light-weight sidecar parents next artifact file. deliberately remove committed snapshot B simulate case sidecar remains; st_lineage() still return immediate parents (level 1) reading sidecar, recursive walking beyond level 1 uses snapshot-backed parents.","code":"st_opts_reset() st_opts(   versioning = \"content\",   code_hash = TRUE,   store_file_hash = TRUE,   verify_on_load = TRUE,   meta_format = \"both\" ) ## ✔ stamp options updated ##   versioning = \"content\", code_hash = \"TRUE\", store_file_hash = \"TRUE\", ##   verify_on_load = \"TRUE\", meta_format = \"both\" root <- tempdir() st_init(root) ## ✔ stamp initialized ##   root: /tmp/RtmpPTf7N7 ##   state: /tmp/RtmpPTf7N7/.stamp # A pA <- fs::path(root, \"A.qs\") xA <- data.frame(a = 1:3) st_save(xA, pA, code = function(z) z) ## ✔ Saved [qs] → /tmp/RtmpPTf7N7/A.qs @ version ## 956d68be4541e835 # B depends on A pB <- fs::path(root, \"B.qs\") xB <- transform(xA, b = a * 2) st_save(   xB,   pB,   code = function(z) z,   parents = list(list(path = pA, version_id = st_latest(pA))) ) ## ✔ Saved [qs] → /tmp/RtmpPTf7N7/B.qs @ version ## 9826a7845729bc71 # C depends on B pC <- fs::path(root, \"C.qs\") xC <- transform(xB, c = b + 1L) st_save(   xC,   pC,   code = function(z) z,   parents = list(list(path = pB, version_id = st_latest(pB))) ) ## ✔ Saved [qs] → /tmp/RtmpPTf7N7/C.qs @ version ## 3120fe309bee5c0c # Remove committed snapshot for B to simulate a no-snapshot state vdir_b <- stamp:::.st_version_dir(pB, st_latest(pB)) if (fs::dir_exists(vdir_b)) {   fs::dir_delete(vdir_b) }  # Now st_info will show snapshot_dir = NA but sidecar present st_info(pB) ## $sidecar ## $sidecar$path ## [1] \"/tmp/RtmpPTf7N7/B.qs\" ##  ## $sidecar$format ## [1] \"qs\" ##  ## $sidecar$created_at ## [1] \"2026-01-12T22:55:27.949097Z\" ##  ## $sidecar$size_bytes ## [1] 148 ##  ## $sidecar$content_hash ## [1] \"bba6fe40c1133df8\" ##  ## $sidecar$code_hash ## [1] \"488e8fa49c740261\" ##  ## $sidecar$file_hash ## [1] \"aedd22253abcd70c\" ##  ## $sidecar$code_label ## NULL ##  ## $sidecar$parents ##                   path       version_id ## 1 /tmp/RtmpPTf7N7/A.qs 956d68be4541e835 ##  ## $sidecar$attrs ## list() ##  ##  ## $catalog ## $catalog$latest_version_id ## [1] \"9826a7845729bc71\" ##  ## $catalog$n_versions ## [1] 1 ##  ##  ## $snapshot_dir ## [1] NA ##  ## $parents ##                   path       version_id ## 1 /tmp/RtmpPTf7N7/A.qs 956d68be4541e835 # st_lineage will fall back to the sidecar for immediate parents (level 1) st_lineage(pB, depth = 1) ##   level           child_path    child_version          parent_path ## 1     1 /tmp/RtmpPTf7N7/B.qs 9826a7845729bc71 /tmp/RtmpPTf7N7/A.qs ##     parent_version ## 1 956d68be4541e835 # But recursive lineage (depth > 1) will only follow snapshot-backed parents # (no recursive walk available once snapshots are missing) st_lineage(pB, depth = 2) ##   level           child_path    child_version          parent_path ## 1     1 /tmp/RtmpPTf7N7/B.qs 9826a7845729bc71 /tmp/RtmpPTf7N7/A.qs ##     parent_version ## 1 956d68be4541e835"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"inspect-lineage","dir":"Articles","previous_headings":"","what":"Inspect lineage","title":"Lineage and Rebuilds","text":"","code":"# Immediate children of A (depth 1) st_children(pA, depth = 1) ## [1] level          child_path     child_version  parent_path    parent_version ## <0 rows> (or 0-length row.names) # Full lineage (parents of an artifact) st_lineage(pC, depth = Inf) ##   level           child_path    child_version          parent_path ## 1     1 /tmp/RtmpPTf7N7/C.qs 3120fe309bee5c0c /tmp/RtmpPTf7N7/B.qs ##     parent_version ## 1 9826a7845729bc71"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"make-a-change-upstream-detect-staleness","dir":"Articles","previous_headings":"","what":"Make a change upstream & detect staleness","title":"Lineage and Rebuilds","text":"","code":"# Change A → new version xA2 <- transform(xA, a = a + 10L) st_save(xA2, pA, code = function(z) z) ## ✔ Saved [qs] → /tmp/RtmpPTf7N7/A.qs @ version ## 931a11a9449c10c8 # Strict staleness st_is_stale(pB) # TRUE (B's recorded A version is now old) ## [1] FALSE st_is_stale(pC) # FALSE (C points to B, which hasn't changed yet) ## [1] FALSE"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"plan-rebuilds","dir":"Articles","previous_headings":"","what":"Plan rebuilds","title":"Lineage and Rebuilds","text":"Two strategies: strict: items whose recorded parent IDs differ parents’ current latest. propagate: assume targets change plan descendants BFS layers.","code":"# Strict: only B right now plan_strict <- st_plan_rebuild(pA, depth = Inf, mode = \"strict\") plan_strict ## [1] level                 path                  reason                ## [4] latest_version_before ## <0 rows> (or 0-length row.names) # Propagate: includes B (level 1) and C (level 2) plan <- st_plan_rebuild(pA, depth = Inf, mode = \"propagate\") plan ## [1] level                 path                  reason                ## [4] latest_version_before ## <0 rows> (or 0-length row.names)"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"register-builders-and-rebuild-in-level-order","dir":"Articles","previous_headings":"","what":"Register builders and rebuild in level order","title":"Lineage and Rebuilds","text":"Builders tiny functions produce artifact parents. receive (path, parents) return list least x = <object>. rebuilding B, C becomes strictly stale B changes later. can re-plan B keep propagating:","code":"# Clear any previous registry st_clear_builders() ## ✔ Cleared all registered builders # Register a builder for B: rebuild from A's committed version st_register_builder(pB, function(path, parents) {   # parents is list(list(path=..., version_id=...))   A <- st_load_version(parents[[1]]$path, parents[[1]]$version_id)   list(     x = transform(A, b = a * 2),     code = function(z) z,     code_label = \"B <- A * 2\"   ) }) ## ✔ Registered builder for /tmp/RtmpPTf7N7/B.qs ## (default) # Register a builder for C: rebuild from B's committed version st_register_builder(pC, function(path, parents) {   B <- st_load_version(parents[[1]]$path, parents[[1]]$version_id)   list(     x = transform(B, c = b + 1L),     code = function(z) z,     code_label = \"C <- B + 1\"   ) }) ## ✔ Registered builder for /tmp/RtmpPTf7N7/C.qs ## (default) # Dry run first (uses registered builders found by st_rebuild when rebuild_fun is NULL) st_rebuild(plan, dry_run = TRUE) ## ✔ Nothing to rebuild (empty plan). # Now actually rebuild (will use registered builders) res <- st_rebuild(plan, dry_run = FALSE) ## ✔ Nothing to rebuild (empty plan). res ## [1] level                 path                  reason                ## [4] latest_version_before status                version_id            ## [7] msg                   ## <0 rows> (or 0-length row.names) st_is_stale(pB) ## [1] FALSE st_is_stale(pC) ## [1] FALSE st_plan_rebuild(pB, depth = Inf, mode = \"propagate\") ##   level                 path           reason latest_version_before ## 1     1 /tmp/RtmpPTf7N7/C.qs upstream_changed      3120fe309bee5c0c"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"inspect-snapshots-on-disk","dir":"Articles","previous_headings":"","what":"Inspect snapshots on disk","title":"Lineage and Rebuilds","text":"Tip: st_info(path) summarizes sidecar, catalog status, latest snapshot dir, plus parsed parents.json committed snapshot (present).","code":"vroot <- stamp:::.st_versions_root() fs::dir_tree(vroot, recurse = TRUE, all = TRUE) ## /tmp/RtmpPTf7N7/.stamp/versions ## ├── A.qs ## │   ├── 931a11a9449c10c8 ## │   │   ├── artifact ## │   │   ├── sidecar.json ## │   │   └── sidecar.qs2 ## │   └── 956d68be4541e835 ## │       ├── artifact ## │       ├── sidecar.json ## │       └── sidecar.qs2 ## ├── B.qs ## └── C.qs ##     └── 3120fe309bee5c0c ##         ├── artifact ##         ├── parents.json ##         ├── sidecar.json ##         └── sidecar.qs2 st_info(pC) ## $sidecar ## $sidecar$path ## [1] \"/tmp/RtmpPTf7N7/C.qs\" ##  ## $sidecar$format ## [1] \"qs\" ##  ## $sidecar$created_at ## [1] \"2026-01-12T22:55:28.002533Z\" ##  ## $sidecar$size_bytes ## [1] 159 ##  ## $sidecar$content_hash ## [1] \"28e3e19ddcccd8c6\" ##  ## $sidecar$code_hash ## [1] \"488e8fa49c740261\" ##  ## $sidecar$file_hash ## [1] \"4286965c99aa6527\" ##  ## $sidecar$code_label ## NULL ##  ## $sidecar$parents ##                   path       version_id ## 1 /tmp/RtmpPTf7N7/B.qs 9826a7845729bc71 ##  ## $sidecar$attrs ## list() ##  ##  ## $catalog ## $catalog$latest_version_id ## [1] \"3120fe309bee5c0c\" ##  ## $catalog$n_versions ## [1] 1 ##  ##  ## $snapshot_dir ## /tmp/RtmpPTf7N7/.stamp/versions/C.qs/3120fe309bee5c0c ##  ## $parents ## $parents[[1]] ## $parents[[1]]$path ## [1] \"/tmp/RtmpPTf7N7/B.qs\" ##  ## $parents[[1]]$version_id ## [1] \"9826a7845729bc71\""},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"takeaways","dir":"Articles","previous_headings":"Inspect snapshots on disk","what":"Takeaways","title":"Lineage and Rebuilds","text":"Use strict staleness detect objective mismatches. Use propagate planning build full downstream schedule. Keep builders small, pure, deterministic; make rebuilds trivial.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick Start","title":"Working with Partitioned Datasets","text":"manifest shows: - partition_key: List key-value pairs partition - path: File location Hive-style structure - version_id: Version identifier tracking - n_rows: Number rows partition","code":"# Initialize stamp tdir <- tempfile(\"stamp-partitions-\") dir.create(tdir) st_init(tdir) #> ✔ stamp initialized #>   root: /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb #>   state: /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/.stamp  # Create sample welfare data set.seed(123)  # for reproducible vignette output welfare <- data.table(   country = rep(c(\"USA\", \"CAN\", \"MEX\"), each = 100),   year = rep(2020:2024, 60),   reporting_level = sample(     c(\"national\", \"urban\", \"rural\"),     300,     replace = TRUE   ),   hh_id = 1:300,   income = rnorm(300, 50000, 15000),   consumption = rnorm(300, 35000, 10000) )  # Auto-partition and save (eliminates manual looping!) parts_dir <- file.path(tdir, \"welfare_parts\")  manifest <- st_write_parts(   welfare,   base = parts_dir,   partitioning = c(\"country\", \"year\", \"reporting_level\"),   code_label = \"welfare_data\" ) #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet #>   @ version 261088049130a989 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet #>   @ version 2eb1f36c167a90f6 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet #>   @ version 4bcd99bed1268d41 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet #>   @ version f1507b3a6ba6568f #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet #>   @ version d6467c7a8d20b67d #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet #>   @ version 9f97ad7ccfea9a52 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet #>   @ version 314aa19feb4a6e9c #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet #>   @ version 3d171a6fd7ec064b #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet #>   @ version a0eb250fdc53ebde #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #>   @ version c66d4bf96b665617 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet #>   @ version 03f786d463c1b557 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet #>   @ version 98c86730b36a21ee #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet #>   @ version 642c8c741e0818a8 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet #>   @ version 42eea9710e4d04e0 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet #>   @ version ecff08d843da15f3 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2020/part.parquet #>   @ version adb1aa412248e1c1 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2021/part.parquet #>   @ version e05c653876f64a9a #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2022/part.parquet #>   @ version f037f5b839c2ac2a #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2023/part.parquet #>   @ version fe00ee29dc7d3cda #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2024/part.parquet #>   @ version 2933d24fa6c3f9f2 #> ⠙ Saving 20/45 partitions [1s] #>  #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2020/part.parquet #>   @ version 1c6104df2c90f8a4 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2021/part.parquet #>   @ version 0640591935d3ec67 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2023/part.parquet #>   @ version 193a2ef603f001d3 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2024/part.parquet #>   @ version 230c5ed7e22328f5 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2020/part.parquet #>   @ version 9651fb50b44aba6d #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2024/part.parquet #>   @ version af672ed87ad2de07 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2022/part.parquet #>   @ version ac2b185c885a6d1e #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2023/part.parquet #>   @ version 67600650cf92e9ee #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2021/part.parquet #>   @ version 8ef9660f5e24e884 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2022/part.parquet #>   @ version 426bf104eca9f918 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2020/part.parquet #>   @ version 157b2d4c0e773c4c #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2021/part.parquet #>   @ version 6c0d5305feba7306 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2022/part.parquet #>   @ version 5e247eb2c76f343a #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2023/part.parquet #>   @ version 577795c698fdebf1 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2024/part.parquet #>   @ version 632e5bda7f248f79 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2020/part.parquet #>   @ version 8ea6a0dd679f885c #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2021/part.parquet #>   @ version cb4e85e80c5b9456 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2022/part.parquet #>   @ version cb82ceb3ce513d0a #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2023/part.parquet #>   @ version b15dc296b5f60960 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2020/part.parquet #>   @ version 3306a1d92edbb11c #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2022/part.parquet #>   @ version a64d42471608a4ef #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2023/part.parquet #>   @ version 7ce61201951040cb #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2024/part.parquet #>   @ version 4373f3e90ac33c45 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2024/part.parquet #>   @ version 34f7230a59a8eff3 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2021/part.parquet #>   @ version 56067e60c3ad2c5a #> ⠙ Saving 45/45 partitions [2s] #>  #> ✔ Saved 45 partitions to #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts  # View manifest head(manifest, 3) #>   partition_key #> 1  USA, 202.... #> 2  USA, 202.... #> 3  USA, 202.... #>                                                                                                                   path #> 1 /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet #> 2 /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet #> 3 /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet #>         version_id n_rows #> 1 261088049130a989      3 #> 2 2eb1f36c167a90f6      9 #> 3 4bcd99bed1268d41     10"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"hive-style-partitioning","dir":"Articles","previous_headings":"","what":"Hive-Style Partitioning","title":"Working with Partitioned Datasets","text":"Partitions organized directories following Hive convention: example: structure: - Self-documenting: Directory names encode partition values - Efficient discovery: Tools can scan directory structure find partitions - Standard format: Compatible Apache Spark, Apache Arrow, DuckDB, etc.","code":"base_dir/   key1=value1/     key2=value2/       part.parquet welfare_parts/   country=USA/     year=2020/       reporting_level=national/         part.parquet       reporting_level=urban/         part.parquet"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"auto-partitioning-with-st_write_parts","dir":"Articles","previous_headings":"","what":"Auto-Partitioning with st_write_parts()","title":"Working with Partitioned Datasets","text":"st_write_parts(), manually loop partition combinations: Now ’s single function call:","code":"# ❌ OLD WAY - Manual looping (verbose, error-prone) for (ctry in unique(welfare$country)) {   for (yr in unique(welfare$year)) {     for (rl in unique(welfare$reporting_level)) {       part_dt <- welfare[country == ctry & year == yr & reporting_level == rl]       if (nrow(part_dt) > 0) {         st_save_part(           part_dt,           base = parts_dir,           key = list(country = ctry, year = yr, reporting_level = rl)         )       }     }   } } # ✅ NEW WAY - Auto-partitioning (clean, efficient) manifest <- st_write_parts(   welfare,   base = parts_dir,   partitioning = c(\"country\", \"year\", \"reporting_level\"),   code_label = \"welfare_data\",   .progress = FALSE # Disable progress bar for vignette ) #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2021/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2021/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2021/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2021/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2021/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2020/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2022/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2023/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2024/part.parquet #> ✔ Skip save (reason: no_change_policy) for #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2021/part.parquet #> ✔ Saved 45 partitions to #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts    cat(sprintf(\"Saved %d partitions\\n\", nrow(manifest))) #> Saved 45 partitions"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"benefits","dir":"Articles","previous_headings":"Auto-Partitioning with st_write_parts()","what":"Benefits","title":"Working with Partitioned Datasets","text":"Automatic splitting: Handles combinations partition values Progress tracking: Shows progress bar many partitions (>10 default) Error handling: Gracefully handles failed partitions Consistent metadata: partitions get code_label, versioning Performance: Uses data.table::split() available speed","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"format-selection","dir":"Articles","previous_headings":"Auto-Partitioning with st_write_parts()","what":"Format Selection","title":"Working with Partitioned Datasets","text":"default, st_write_parts() uses parquet format optimal columnar performance: Override explicit format:","code":"# Default format is parquet format_manifest <- st_write_parts(   welfare[1:50],   base = file.path(tdir, \"test_format\"),   partitioning = \"country\",   .progress = FALSE ) #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/test_format/country=USA/part.parquet #>   @ version 1b508c41ce1abe80 #> ✔ Saved 1 partition to #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/test_format  # Check file extension basename(format_manifest$path[1]) #> [1] \"part.parquet\" # Use fst format instead manifest_fst <- st_write_parts(   welfare[1:50],   base = file.path(tdir, \"test_fst\"),   partitioning = \"country\",   format = \"fst\",   .progress = FALSE ) #> ✔ Saved [fst] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/test_fst/country=USA/part.fst @ #>   version 71f6893a3597df06 #> ✔ Saved 1 partition to /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/test_fst  basename(manifest_fst$path[1]) #> [1] \"part.fst\""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"load-all-partitions","dir":"Articles","previous_headings":"Loading Partitions","what":"Load All Partitions","title":"Working with Partitioned Datasets","text":"","code":"# Load all partitions and row-bind all_data <- st_load_parts(parts_dir, as = \"dt\") #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet  cat(sprintf(   \"Loaded %d rows from %d partitions\\n\",   nrow(all_data),   nrow(manifest) )) #> Loaded 300 rows from 45 partitions  # Partition columns are automatically added head(all_data[, .(country, year, reporting_level, hh_id, income)], 3) #>    country   year reporting_level hh_id   income #>     <char> <char>          <char> <int>    <num> #> 1:     CAN   2020        national   106 53133.61 #> 2:     CAN   2020        national   116 45187.54 #> 3:     CAN   2020        national   141 44242.25"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"exact-match-filtering-named-list","dir":"Articles","previous_headings":"Loading Partitions","what":"Exact Match Filtering (Named List)","title":"Working with Partitioned Datasets","text":"Use named list exact equality matching (backward compatible): Notice possible use numeric string “2020”. See Filter Expression Capabilities clarification.","code":"# Load only USA data usa_data <- st_load_parts(   parts_dir,   filter = list(country = \"USA\"),   as = \"dt\" ) #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet  cat(sprintf(\"USA data: %d rows\\n\", nrow(usa_data))) #> USA data: 100 rows unique(usa_data$country) #> [1] \"USA\" # Multiple exact matches (AND logic) usa_2020 <- st_load_parts(   parts_dir,   filter = list(country = \"USA\", year = \"2020\"),   as = \"dt\" ) #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet  cat(sprintf(\"USA 2020: %d rows\\n\", nrow(usa_2020))) #> USA 2020: 20 rows unique(usa_2020[, .(country, year)]) #>    country   year #>     <char> <char> #> 1:     USA   2020"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"expression-based-filtering-formula","dir":"Articles","previous_headings":"Loading Partitions","what":"Expression-Based Filtering (Formula)","title":"Working with Partitioned Datasets","text":"flexible filtering comparisons boolean logic, use formula syntax:","code":"# Load data where year > 2021 (numeric comparison) recent_data <- st_load_parts(   parts_dir,   filter = ~ year > 2021,   as = \"dt\" ) #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet  cat(sprintf(\"Recent data (year > 2021): %d rows\\n\", nrow(recent_data))) #> Recent data (year > 2021): 180 rows table(recent_data$year) #>  #> 2022 2023 2024  #>   60   60   60 # Complex boolean logic: (country == \"USA\" AND year >= 2023) OR (country == \"CAN\" AND year == 2020) complex_filter <- st_load_parts(   parts_dir,   filter = ~ (country == \"USA\" & year >= 2023) |     (country == \"CAN\" & year == 2020),   as = \"dt\" ) #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=national/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=rural/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=CAN/reporting_level=urban/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet  cat(sprintf(\"Complex filter: %d rows\\n\", nrow(complex_filter))) #> Complex filter: 60 rows complex_filter[, .N, by = .(country, year)][order(country, year)] #>    country   year     N #>     <char> <char> <int> #> 1:     CAN   2020    20 #> 2:     USA   2023    20 #> 3:     USA   2024    20 # Use %in% for multiple values selected_countries <- st_load_parts(   parts_dir,   filter = ~ country %in% c(\"USA\", \"MEX\") & year != 2020,   as = \"dt\" ) #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=MEX/reporting_level=urban/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet  cat(sprintf(\"USA/MEX (not 2020): %d rows\\n\", nrow(selected_countries))) #> USA/MEX (not 2020): 160 rows selected_countries[, .N, by = country] #>    country     N #>     <char> <int> #> 1:     MEX    80 #> 2:     USA    80"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"filter-expression-capabilities","dir":"Articles","previous_headings":"Loading Partitions","what":"Filter Expression Capabilities","title":"Working with Partitioned Datasets","text":"Formula filters support: Comparisons: >, <, >=, <=, ==, != Boolean logic: & (), | (), ! () Set operations: %%, %nin% (defined) Parentheses: grouping complex logic Type conversion: Automatic numeric partition keys Important: Partition keys automatically type-converted: - Numeric strings (\"2020\") → numeric (2020) - Boolean strings (\"TRUE\") → logical (TRUE) - strings remain strings","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"columnar-loading-column-selection","dir":"Articles","previous_headings":"","what":"Columnar Loading (Column Selection)","title":"Working with Partitioned Datasets","text":"using parquet fst formats, can load specific columns massive performance gains:","code":"# Load only income column (+ partition keys automatically included) income_only <- st_load_parts(   parts_dir,   columns = c(\"income\"),   as = \"dt\" )  names(income_only) # income + partition keys (country, year, reporting_level) #> [1] \"income\"          \"country\"         \"reporting_level\" \"year\""},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"native-vs--fallback-column-selection","dir":"Articles","previous_headings":"Columnar Loading (Column Selection)","what":"Native vs. Fallback Column Selection","title":"Working with Partitioned Datasets","text":"","code":"# Parquet: native column selection (efficient) parquet_cols <- st_load_parts(   parts_dir,   columns = c(\"hh_id\", \"income\"),   as = \"dt\" )  cat(\"Columns loaded:\", paste(names(parquet_cols), collapse = \", \"), \"\\n\") #> Columns loaded: hh_id, income, country, reporting_level, year"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"combining-filters-and-column-selection","dir":"Articles","previous_headings":"Columnar Loading (Column Selection)","what":"Combining Filters and Column Selection","title":"Working with Partitioned Datasets","text":"real power comes combining : approach: 1. Filters partitions reading (loads relevant files) 2. Reads needed columns files (parquet/fst) 3. Minimizes memory /O large datasets","code":"# Load recent USA data, only income and consumption columns usa_recent_finance <- st_load_parts(   parts_dir,   filter = ~ country == \"USA\" & year >= 2022,   columns = c(\"income\", \"consumption\"),   as = \"dt\" )  cat(sprintf(   \"Loaded %d rows × %d columns\\n\",   nrow(usa_recent_finance),   ncol(usa_recent_finance) )) #> Loaded 60 rows × 5 columns  head(usa_recent_finance, 3) #>      income consumption country reporting_level   year #>       <num>       <num>  <char>          <char> <char> #> 1: 52886.62    45512.59     USA        national   2022 #> 2: 28921.19    41564.68     USA        national   2022 #> 3: 68243.75    48980.75     USA        national   2022"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"discovering-partitions-with-st_list_parts","dir":"Articles","previous_headings":"","what":"Discovering Partitions with st_list_parts()","title":"Working with Partitioned Datasets","text":"List available partitions without loading data: Use cases: - Inventory check: partitions exist? - Validation: Ensure expected partitions created - Selective processing: Get file paths external processing - Metadata extraction: Extract partition values without loading data","code":"# List all partitions all_partitions <- st_list_parts(parts_dir)  cat(sprintf(\"Found %d partitions\\n\", nrow(all_partitions))) #> Found 45 partitions head(all_partitions[, c(\"country\", \"year\", \"reporting_level\")], 6) #>   country year reporting_level #> 1     CAN 2020        national #> 2     CAN 2021        national #> 3     CAN 2022        national #> 4     CAN 2023        national #> 5     CAN 2024        national #> 6     CAN 2020           rural # List specific partitions with filter mexico_partitions <- st_list_parts(   parts_dir,   filter = ~ country == \"MEX\" & year >= 2022 )  cat(sprintf(\"Mexico (2022+): %d partitions\\n\", nrow(mexico_partitions))) #> Mexico (2022+): 9 partitions mexico_partitions[, c(\"country\", \"year\", \"reporting_level\")] #>   country year reporting_level #> 1     MEX 2022        national #> 2     MEX 2023        national #> 3     MEX 2024        national #> 4     MEX 2022           rural #> 5     MEX 2023           rural #> 6     MEX 2024           rural #> 7     MEX 2022           urban #> 8     MEX 2023           urban #> 9     MEX 2024           urban"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"single-partition-operations","dir":"Articles","previous_headings":"","what":"Single Partition Operations","title":"Working with Partitioned Datasets","text":"fine-grained control, use st_save_part() st_part_path():","code":"# Save a single partition explicitly single_partition <- welfare[   country == \"USA\" & year == 2024 & reporting_level == \"urban\" ]  st_save_part(   single_partition,   base = file.path(tdir, \"manual_parts\"),   key = list(country = \"USA\", year = 2024, reporting_level = \"urban\"),   code_label = \"manual_partition\" ) #> ✔ Saved [qs2] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/manual_parts/country=USA/reporting_level=urban/year=2024/part.qs2 #>   @ version 5daa2987cf81d6d5  # Get expected path for a partition expected_path <- st_part_path(   base = file.path(tdir, \"manual_parts\"),   key = list(country = \"USA\", year = 2024, reporting_level = \"urban\") )  cat(\"Expected path:\\n\", expected_path, \"\\n\") #> Expected path: #>  /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/manual_parts/country=USA/reporting_level=urban/year=2024/part.qs2 file.exists(expected_path) #> [1] TRUE"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"primary-keys-and-partitions","dir":"Articles","previous_headings":"","what":"Primary Keys and Partitions","title":"Working with Partitioned Datasets","text":"Combine partitioning primary key validation: unique = TRUE: - Validates PK uniqueness within partition file - Stores PK definition sidecar metadata - Fails save duplicates found","code":"# Define primary key spanning partition columns pk_manifest <- st_write_parts(   welfare,   base = file.path(tdir, \"welfare_pk\"),   partitioning = c(\"country\", \"year\"),   pk = c(\"country\", \"year\", \"reporting_level\", \"hh_id\"),   unique = TRUE, # Enforce uniqueness   .progress = FALSE ) #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=USA/year=2020/part.parquet #>   @ version b940d3b716df5966 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=USA/year=2021/part.parquet #>   @ version f447e32a32ef2b3e #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=USA/year=2022/part.parquet #>   @ version 245646207cb76a93 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=USA/year=2023/part.parquet #>   @ version 0fdee97a1ad8d080 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=USA/year=2024/part.parquet #>   @ version 9d80ff720d9e976b #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=CAN/year=2020/part.parquet #>   @ version 799a2654187dcfdf #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=CAN/year=2021/part.parquet #>   @ version 934512e8aa638718 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=CAN/year=2022/part.parquet #>   @ version 55bc34908409bc11 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=CAN/year=2023/part.parquet #>   @ version 16a7b72b4efc09be #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=CAN/year=2024/part.parquet #>   @ version 7e17f9e59402261c #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=MEX/year=2020/part.parquet #>   @ version be15f3bd0a457791 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=MEX/year=2021/part.parquet #>   @ version bcda757d48afc18e #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=MEX/year=2022/part.parquet #>   @ version 5695ec8c08c2b3e3 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=MEX/year=2023/part.parquet #>   @ version 9ad3ff061457af47 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk/country=MEX/year=2024/part.parquet #>   @ version 82accf28e9619710 #> ✔ Saved 15 partitions to #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_pk  # Each partition file has PK validation in sidecar metadata"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"when-to-use-partitioning","dir":"Articles","previous_headings":"Performance Considerations","what":"When to Use Partitioning","title":"Working with Partitioned Datasets","text":"Good : - Datasets > 100MB natural groupings (country, date, category) - Workloads frequently filter partition keys - Parallel/distributed processing - Incremental updates (update changed partitions) ideal : - Small datasets (< 10MB) - overhead worth - Random access patterns across partitions - High cardinality partition keys (millions unique values)","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"format-selection-1","dir":"Articles","previous_headings":"Performance Considerations","what":"Format Selection","title":"Working with Partitioned Datasets","text":"Recommendation: Use parquet (default) unless specific needs.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"partition-key-selection","dir":"Articles","previous_headings":"Performance Considerations","what":"Partition Key Selection","title":"Working with Partitioned Datasets","text":"Choose partition keys : Match query patterns: always filter country, make partition key moderate cardinality: 10-1000 unique values ideal per key Create balanced partitions: Avoid one huge partition + many tiny ones immutable: Values shouldn’t change time Example - Good: Example - Bad:","code":"partitioning = c(\"country\", \"year\", \"quarter\")  # 195 countries × 10 years × 4 quarters = ~8K partitions partitioning = c(\"user_id\", \"timestamp\")  # Millions of users × millions of timestamps = too many!"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"memory-optimization","dir":"Articles","previous_headings":"Performance Considerations","what":"Memory Optimization","title":"Working with Partitioned Datasets","text":"","code":"# Bad: Load everything then filter in R # all_data <- st_load_parts(parts_dir) # usa_data <- all_data[country == \"USA\"]  # ❌ Wasteful  # Good: Filter partitions before loading usa_data <- st_load_parts(   parts_dir,   filter = ~ country == \"USA\" # ✅ Only loads USA partitions ) #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=rural/year=2024/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2020/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2021/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2022/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2023/part.parquet #> Warning: No primary key recorded for #> /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [parquet] ← #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet  # Better: Also select columns usa_income <- st_load_parts(   parts_dir,   filter = ~ country == \"USA\",   columns = c(\"income\") # ✅ Only loads USA partitions, income column )"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"incremental-updates","dir":"Articles","previous_headings":"Advanced Patterns","what":"Incremental Updates","title":"Working with Partitioned Datasets","text":"Update specific partitions:","code":"# New data for USA 2024 only new_usa_2024 <- data.table(   country = \"USA\",   year = 2024,   reporting_level = c(\"national\", \"urban\"),   hh_id = 1001:1002,   income = c(60000, 55000),   consumption = c(40000, 38000) )  # Overwrite just the USA 2024 partitions st_write_parts(   new_usa_2024,   base = parts_dir,   partitioning = c(\"country\", \"year\", \"reporting_level\"),   code_label = \"incremental_update\",   .progress = FALSE ) #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=national/year=2024/part.parquet #>   @ version 5c8805f117fe22be #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts/country=USA/reporting_level=urban/year=2024/part.parquet #>   @ version 69d81e15e30c26cd #> ✔ Saved 2 partitions to #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/welfare_parts  # Other partitions remain unchanged"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"processing-pipeline","dir":"Articles","previous_headings":"Advanced Patterns","what":"Processing Pipeline","title":"Working with Partitioned Datasets","text":"","code":"# 1. List partitions matching criteria target_partitions <- st_list_parts(   parts_dir,   filter = ~ year >= 2022 )  cat(sprintf(\"Processing %d partitions...\\n\", nrow(target_partitions))) #> Processing 27 partitions...  # 2. Load filtered data recent_data <- st_load_parts(   parts_dir,   filter = ~ year >= 2022,   columns = c(\"income\", \"consumption\"),   as = \"dt\" )  # 3. Process recent_data[, income_ratio := income / consumption]  # 4. Save results to new partition set st_write_parts(   recent_data,   base = file.path(tdir, \"processed_welfare\"),   partitioning = c(\"country\", \"year\"),   code_label = \"computed_ratios\",   .progress = FALSE ) #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=CAN/year=2022/part.parquet #>   @ version c6635a797e5ebdc6 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=CAN/year=2023/part.parquet #>   @ version a713861c6fc69edc #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=CAN/year=2024/part.parquet #>   @ version ee6e5cb66f18ce41 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=MEX/year=2022/part.parquet #>   @ version 994d6088ae4bcab4 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=MEX/year=2023/part.parquet #>   @ version 7a88703f01bb8d5a #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=MEX/year=2024/part.parquet #>   @ version 246b00e2f9902f72 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=USA/year=2022/part.parquet #>   @ version 94ecbb4528dc3153 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=USA/year=2023/part.parquet #>   @ version 8922fb8ff8d99235 #> ✔ Saved [parquet] → #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare/country=USA/year=2024/part.parquet #>   @ version a16a5452f73c6732 #> ✔ Saved 9 partitions to #>   /tmp/Rtmp2KmiyV/stamp-partitions-226b5d4254cb/processed_welfare"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"comparison-with-arrowduckdb","dir":"Articles","previous_headings":"","what":"Comparison with Arrow/DuckDB","title":"Working with Partitioned Datasets","text":"stamp partitions compatible tools: Differences: Use stamp : - need versioning lineage tracking - want lightweight dependencies - ’re primarily working R Use Arrow/DuckDB : - need advanced query capabilities - ’re working multi-language teams - Dataset size exceeds memory (lazy evaluation needed)","code":"# stamp partitions can be read by Arrow library(arrow) ds <- open_dataset(   parts_dir,   partitioning = c(\"country\", \"year\", \"reporting_level\") ) ds %>%   filter(year > 2021) %>%   select(income, consumption) %>%   collect()  # Or DuckDB library(duckdb) con <- dbConnect(duckdb()) dbGetQuery(   con,   sprintf(\"SELECT * FROM read_parquet('%s/**/*.parquet')\", parts_dir) )"},{"path":"https://randrescastaneda.github.io/stamp/articles/partitions.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Working with Partitioned Datasets","text":"Key takeaways: st_write_parts(): Auto-partition datasets (eliminates manual loops) Hive-style paths: key1=value1/key2=value2/file.ext (self-documenting) Named list: filter = list(country = \"USA\") (exact match) Formula: filter = ~ year > 2021 (flexible expressions) Column selection: columns = c(\"col1\", \"col2\") (native parquet/fst) Default format: Parquet (optimal analytics) Partition discovery: st_list_parts() (inventory without loading) Next steps: - See vignette(\"hashing--versions\") versioning details - See vignette(\"lineage-rebuilds\") dependency tracking - See ?st_write_parts full API documentation","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"initialize-a-project","dir":"Articles","previous_headings":"","what":"1. Initialize a project","title":"Setup and Basics","text":"st_init() prepares small internal state directory (default .stamp/) hold temporary files, logs, sidecars, version snapshots. Use temporary directory vignette examples saves snapshots isolated. Notes - Default state dir: .stamp/ (can override via st_init(state_dir = \"_stamp\")).","code":"# Use a private temp dir so the vignette is reproducible locally tdir <- fs::path_temp(\"stamp-vignette\") fs::dir_create(tdir) st_init(tdir) ## ✔ stamp initialized ##   root: /tmp/Rtmpk4ZM8o/stamp-vignette ##   state: /tmp/Rtmpk4ZM8o/stamp-vignette/.stamp # Inspect created structure fs::path(tdir, \".stamp\") |>   fs::dir_tree(recurse = TRUE, all = TRUE) ## /tmp/Rtmpk4ZM8o/stamp-vignette/.stamp ## ├── logs ## └── temp"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"options-st_opts","dir":"Articles","previous_headings":"","what":"2. Options (st_opts())","title":"Setup and Basics","text":"Global behavior controlled via st_opts(). Typical options use: meta_format: sidecars written. Allowed: \"json\", \"qs2\", \"\". default_format: format use none inferred path. versioning: controls whether saves create version snapshots (\"content\" vs \"timestamp\" vs `“”). Example: Use versioning control version snapshot recorded. default \"content\" mode records new version content/code changed; \"timestamp\" forces version every save (useful audit trails).","code":"# show defaults st_opts(.get = TRUE) ## $force_on_code_change ## [1] TRUE ##  ## $retain_versions ## [1] Inf ##  ## $versioning ## [1] \"content\" ##  ## $meta_format ## [1] \"json\" ##  ## $usetz ## [1] FALSE ##  ## $timeformat ## [1] \"%Y%m%d%H%M%S\" ##  ## $code_hash ## [1] TRUE ##  ## $default_format ## [1] \"qs2\" ##  ## $verify_on_load ## [1] FALSE ##  ## $store_file_hash ## [1] FALSE ##  ## $verbose ## [1] TRUE ##  ## $timezone ## [1] \"UTC\" ##  ## $require_pk_on_load ## [1] FALSE ##  ## $warn_missing_pk_on_load ## [1] TRUE # write both JSON and QS2 sidecars st_opts(meta_format = \"both\") ## ✔ stamp options updated ##   meta_format = \"both\" st_opts(\"meta_format\", .get = TRUE) ## [1] \"both\""},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"paths-and-format-registry","dir":"Articles","previous_headings":"","what":"3. Paths and format registry","title":"Setup and Basics","text":"st_path() wraps path string optionally carries explicit format hint. Format inference also maps known extensions (via internal registry). can extend registry st_register_format() add new format (e.g. Parquet). registry also map file extensions provide .","code":"p1 <- st_path(\"data/iris.qs2\") p2 <- st_path(\"data/mtcars.fst\", format = \"fst\") p1 ## <st_path> data/iris.qs2 [format=qs2] st_formats()  # built-in handlers: qs2, rds, csv, fst, json ## [1] \"csv\"     \"fst\"     \"json\"    \"parquet\" \"qs\"      \"qs2\"     \"rds\""},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"save-load-atomic-with-sidecar-metadata","dir":"Articles","previous_headings":"","what":"4. Save & load (atomic, with sidecar metadata)","title":"Setup and Basics","text":"Use st_save() st_load() robust writes. st_save() performs atomic write (temp file move), writes sidecar metadata, — depending versioning — records version snapshot. st_save() accepts additional arguments useful provenance: code: function/expression whose hash recorded (via st_hash_code). parents: optional list parent descriptors (list(list(path=…, version_id=…), …)) record provenance. code_label: short human label producing code.","code":"x <- data.frame(a = 1:3, b = letters[1:3]) outdir <- fs::path_temp(\"stamp-output\") fs::dir_create(outdir)  res <- st_save(x, fs::path(outdir, \"example.qs2\"), metadata = list(description = \"toy\")) ## ✔ Saved [qs2] → /tmp/Rtmpk4ZM8o/stamp-output/example.qs2 @ version ##   02a5a22f15346e49 res$path ## /tmp/Rtmpk4ZM8o/stamp-output/example.qs2 # load back (format auto-detected) y <- st_load(res$path) ## Warning: No primary key recorded for /tmp/Rtmpk4ZM8o/stamp-output/example.qs2. ## ℹ You can add one with `st_add_pk()`. ## ✔ Loaded [qs2] ← ## /tmp/Rtmpk4ZM8o/stamp-output/example.qs2 identical(x, y) ## [1] TRUE"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"loading-specific-versions","dir":"Articles","previous_headings":"4. Save & load (atomic, with sidecar metadata)","what":"4.1 Loading specific versions","title":"Setup and Basics","text":"version argument st_load() allows load historical versions artifacts. useful comparing changes time recovering mistakes. version argument supports several modes: NULL (default): loads current artifact file 0: NULL, loads latest version Negative integers (-1, -2, etc.): load versions relative latest Character string: specific version ID (st_versions()) \"select\", \"pick\", \"choose\": interactive menu (interactive sessions)","code":"# Create multiple versions by modifying and saving v_path <- fs::path(outdir, \"versioned.qs2\")  # Version 1 v1 <- data.frame(x = 1:3, y = c(\"a\", \"b\", \"c\")) st_save(v1, v_path, code_label = \"initial\") ## ✔ Saved [qs2] → /tmp/Rtmpk4ZM8o/stamp-output/versioned.qs2 @ version ##   189aa82ea7c6017b Sys.sleep(0.15)  # ensure distinct timestamps  # Version 2 v2 <- data.frame(x = 1:5, y = c(\"a\", \"b\", \"c\", \"d\", \"e\")) st_save(v2, v_path, code_label = \"added rows\") ## ✔ Saved [qs2] → /tmp/Rtmpk4ZM8o/stamp-output/versioned.qs2 @ version ##   549c19e662778f5a Sys.sleep(0.15)  # Version 3 v3 <- data.frame(x = 1:5, y = c(\"a\", \"b\", \"c\", \"d\", \"e\"), z = 10:14) st_save(v3, v_path, code_label = \"added column z\") ## ✔ Saved [qs2] → /tmp/Rtmpk4ZM8o/stamp-output/versioned.qs2 @ version ##   954334affb5da38b # Check available versions versions <- st_versions(v_path) print(versions[, .(version_id, created_at, size_bytes)]) ##          version_id                  created_at size_bytes ##              <char>                      <char>      <num> ## 1: 954334affb5da38b 2026-01-12T22:55:48.147594Z        287 ## 2: 549c19e662778f5a 2026-01-12T22:55:47.928481Z        262 ## 3: 189aa82ea7c6017b 2026-01-12T22:55:47.655686Z        261 # Load latest (default) current <- st_load(v_path) ## Warning: No primary key recorded for /tmp/Rtmpk4ZM8o/stamp-output/versioned.qs2. ## ℹ You can add one with `st_add_pk()`. ## ✔ Loaded [qs2] ← ## /tmp/Rtmpk4ZM8o/stamp-output/versioned.qs2 nrow(current)  # 5 rows, 3 columns ## [1] 5 # Load previous version (version = -1) previous <- st_load(v_path, version = -1) ## ✔ Loaded ← /tmp/Rtmpk4ZM8o/stamp-output/versioned.qs2 @ ## 549c19e662778f5a [qs2] nrow(previous)  # 5 rows, 2 columns (before adding z) ## [1] 5 # Load two versions back (version = -2) older <- st_load(v_path, version = -2) ## ✔ Loaded ← /tmp/Rtmpk4ZM8o/stamp-output/versioned.qs2 @ ## 189aa82ea7c6017b [qs2] nrow(older)  # 3 rows, 2 columns (original) ## [1] 3 # Load specific version by ID vid <- versions$version_id[1]  # oldest version specific <- st_load(v_path, version = vid) ## ✔ Loaded ← /tmp/Rtmpk4ZM8o/stamp-output/versioned.qs2 @ ## 954334affb5da38b [qs2] identical(specific, older) ## [1] FALSE # Interactive menu to choose a version (only works in interactive R sessions) # This will display a menu with formatted timestamps and file sizes selected <- st_load(v_path, version = \"select\")  # The menu looks like: # ℹ Select a version to load from versioned.qs2: #   Latest version is [1] #  # Available versions: #  # 1: [1] 2025-11-26 10:30:15 (0.12 MB) - 20251126T103015Z # 2: [2] 2025-11-26 10:30:10 (0.10 MB) - 20251126T103010Z # 3: [3] 2025-11-26 10:30:05 (0.08 MB) - 20251126T103005Z #  # Selection: _"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"sidecars-quick-metadata","dir":"Articles","previous_headings":"","what":"5. Sidecars (quick metadata)","title":"Setup and Basics","text":"Sidecars live stmeta/ sibling directory next artifact contain metadata path, format, created_at (UTC), size_bytes, content_hash, code_hash, code_label, parents (quick view). sidecar intended quick inspection storing metadata even version snapshot may recorded (e.g., versioning = \"content\" nothing changed). reproducible lineage rebuilds, st_save() writes snapshot .stamp/versions/ includes committed copies artifact parents.json.","code":"sc <- st_read_sidecar(res$path) str(sc) ## List of 11 ##  $ path        : chr \"/tmp/Rtmpk4ZM8o/stamp-output/example.qs2\" ##  $ format      : chr \"qs2\" ##  $ created_at  : chr \"2026-01-12T22:55:47.460690Z\" ##  $ size_bytes  : int 256 ##  $ content_hash: chr \"99235ac79dea7ab0\" ##  $ code_hash   : NULL ##  $ file_hash   : NULL ##  $ code_label  : NULL ##  $ parents     : list() ##  $ attrs       : list() ##  $ description : chr \"toy\""},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"versions-lineage-and-inspection","dir":"Articles","previous_headings":"","what":"6. Versions, lineage, and inspection","title":"Setup and Basics","text":"package maintains simple catalog versions. Useful functions: st_versions(path) — list recorded versions artifact. st_latest(path) — get latest version id. st_load_version(path, version_id) — load specific recorded version. st_info(path) — quick inspection: returns current sidecar, catalog info, snapshot dir (present), parents (snapshot sidecar fallback). st_lineage(path, depth=1) — walk immediate recursive parents. Example demonstrates parents lineage (parents passed st_save): Notes behavior - sidecar always contains parents quick inspection. However, default versioning = \"content\" mode new committed snapshot (parents.json) created content code changed. vignette code deliberately saves upstream derived artifacts snapshot recorded.","code":"# upstream artifact in_path <- fs::path(outdir, \"upstream.qs\") st_save(data.frame(id=1:3), in_path) ## ✔ Saved [qs] → /tmp/Rtmpk4ZM8o/stamp-output/upstream.qs @ version ##   de4362c851a4c072 in_vid <- st_latest(in_path)  # derived artifact recording parent info out_path <- fs::path(outdir, \"derived.qs\") parents <- list(list(path = in_path, version_id = in_vid)) st_save(data.frame(id=1:3, v=10), out_path, parents = parents, code_label = \"multiply\") ## ✔ Saved [qs] → /tmp/Rtmpk4ZM8o/stamp-output/derived.qs @ version ##   a9a6213cead3fa10 st_info(out_path)$sidecar ## $path ## [1] \"/tmp/Rtmpk4ZM8o/stamp-output/derived.qs\" ##  ## $format ## [1] \"qs\" ##  ## $created_at ## [1] \"2026-01-12T22:55:48.618234Z\" ##  ## $size_bytes ## [1] 150 ##  ## $content_hash ## [1] \"a6f9da7f2b465601\" ##  ## $code_hash ## NULL ##  ## $file_hash ## NULL ##  ## $code_label ## [1] \"multiply\" ##  ## $parents ##                                       path       version_id ## 1 /tmp/Rtmpk4ZM8o/stamp-output/upstream.qs de4362c851a4c072 ##  ## $attrs ## list() st_lineage(out_path, depth = 1) ##   level                              child_path    child_version ## 1     1 /tmp/Rtmpk4ZM8o/stamp-output/derived.qs a9a6213cead3fa10 ##                                parent_path   parent_version ## 1 /tmp/Rtmpk4ZM8o/stamp-output/upstream.qs de4362c851a4c072"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"primary-key-helpers-optional","dir":"Articles","previous_headings":"","what":"7. Primary-key helpers (optional)","title":"Setup and Basics","text":"can record primary-key (pk) artifact sidecar make easier identify rows later. Helpers: st_pk() — normalize/validate pk spec. st_add_pk(path, keys) — record pk artifact sidecar (optionally validate -disk content). st_inspect_pk(path) — read pk sidecar. st_with_pk(df, keys) st_get_pk() — -memory helpers. Example:","code":"st_add_pk(out_path, keys = c(\"id\")) ## ✔ stamp options updated ##   require_pk_on_load = \"FALSE\" ## Warning: No primary key recorded for /tmp/Rtmpk4ZM8o/stamp-output/derived.qs. ## ℹ You can add one with `st_add_pk()`. ## ✔ Loaded [qs] ← /tmp/Rtmpk4ZM8o/stamp-output/derived.qs ## ✔ Recorded primary key for /tmp/Rtmpk4ZM8o/stamp-output/derived.qs --> id ## ✔ stamp options updated ##   require_pk_on_load = \"FALSE\" st_inspect_pk(out_path) ## [1] \"id\" # load and filter by pk using st_filter df <- st_load(out_path) ## ✔ Loaded [qs] ← ## /tmp/Rtmpk4ZM8o/stamp-output/derived.qs st_filter(df, list(id = 1)) ##   id  v ## 1  1 10"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"retention-pruning","dir":"Articles","previous_headings":"","what":"8. Retention / pruning","title":"Setup and Basics","text":"control disk usage, st_prune_versions() prunes older version snapshots according retention policy. simplest call applies default project policy; can also pass policy use dry_run = TRUE preview.","code":"# dry-run to preview deletions for this artifact st_prune_versions(path = out_path, policy = 5, dry_run = TRUE)  # apply retention (non-dry) st_prune_versions(path = out_path, policy = list(n = 5, days = 30), dry_run = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"tips-and-conventions","dir":"Articles","previous_headings":"","what":"9. Tips and conventions","title":"Setup and Basics","text":"Prefer qs2 artifact storage speed/space, use JSON sidecars readability development. Use st_path() want explicit format hints code. Use st_info() st_lineage() inspect provenance; use st_versions() st_load_version() access historical snapshots.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"The .stamp Directory: Structure and Internals","text":".stamp/ directory persistent storage backend stamp package’s versioning system. vignette explains: .stamp/ created internal directory structure versioning metadata work hood Troubleshooting common issues Audience: vignette serves users (understanding .stamp ) developers (understanding internal implementation details).","code":""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"creating--stamp-with-st_init","dir":"Articles","previous_headings":"1. Creation and Initialization","what":"1.1 Creating .stamp/ with st_init()","title":"The .stamp Directory: Structure and Internals","text":".stamp/ directory created call st_init(): happens initialization: Creates directory structure (doesn’t exist): .stamp/ - Root state directory .stamp/temp/ - Temporary files atomic writes .stamp/logs/ - Future use logging (currently unused) Records project root package state (-memory reference) create initialize catalog yet - happens first save","code":"# Create a temporary project directory for demonstration demo_dir <- fs::path_temp(\"stamp-demo\") fs::dir_create(demo_dir)  # Initialize stamp st_init(demo_dir) #> ✔ stamp initialized #>   root: /tmp/RtmpfskHSq/stamp-demo #>   state: /tmp/RtmpfskHSq/stamp-demo/.stamp  # Inspect what was created fs::dir_tree(fs::path(demo_dir, \".stamp\"), recurse = TRUE, all = TRUE) #> /tmp/RtmpfskHSq/stamp-demo/.stamp #> ├── logs #> └── temp"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"re-running-st_init-safe-and-non-destructive","dir":"Articles","previous_headings":"1. Creation and Initialization","what":"1.2 Re-running st_init(): Safe and Non-Destructive","title":"The .stamp Directory: Structure and Internals","text":"Important: Running st_init() multiple times safe delete overwrite existing version history. safe? st_init() creates directories don’t exist catalog file (catalog.qs2) read present, never deleted Version snapshots versions/ never touched initialization","code":"# Save an artifact to create version history test_data <- data.frame(x = 1:5, y = letters[1:5]) test_path <- fs::path(demo_dir, \"data\", \"test.qs2\") st_save(test_data, test_path) #> ✔ Saved [qs2] → /tmp/RtmpfskHSq/stamp-demo/data/test.qs2 @ version #>   85a7ee1efbbb2bec  # Check versions exist versions_before <- st_versions(test_path) nrow(versions_before) #> [1] 1  # Re-initialize (this is safe!) st_init(demo_dir) #> ✔ stamp initialized #>   root: /tmp/RtmpfskHSq/stamp-demo #>   state: /tmp/RtmpfskHSq/stamp-demo/.stamp  # Version history is preserved versions_after <- st_versions(test_path) identical(versions_before, versions_after) #> [1] TRUE"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"high-level-layout","dir":"Articles","previous_headings":"2. Directory Structure Explained","what":"2.1 High-Level Layout","title":"The .stamp Directory: Structure and Internals","text":"Let’s explore component:","code":".stamp/                          # Root state directory ├── catalog.qs2                  # Central version registry (created on first save) ├── catalog.lock                 # Lock file for concurrent access control ├── temp/                        # Temporary files during atomic writes ├── logs/                        # Reserved for future logging features └── versions/                    # Version snapshots (created on first save)     ├── data/                    # Mirrors your project structure     │   └── test.qs2/            # One folder per artifact     │       ├── 20250108T121500Z-abc12345/   # Version snapshot directory     │       │   ├── artifact                  # Snapshot of the file itself     │       │   ├── sidecar.json              # Metadata at save time     │       │   ├── sidecar.qs2               # (optional) Binary metadata     │       │   └── parents.json              # Lineage information     │       └── 20250108T143000Z-def67890/   # Another version     │           └── ...     └── external/                # Artifacts outside project root         └── a1b2c3d4-external.csv/             └── ..."},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"the-catalog-catalog-qs2","dir":"Articles","previous_headings":"2. Directory Structure Explained","what":"2.2 The Catalog: catalog.qs2","title":"The .stamp Directory: Structure and Internals","text":"catalog central registry tracking artifacts versions. ’s QS2-serialized list containing two data.table objects: Key functions read catalog:","code":"catalog <- list(   artifacts = data.table(     artifact_id,          # Stable hash of normalized path     path,                 # Current canonical path     format,               # File format (rds, qs2, csv, etc.)     latest_version_id,    # Most recent version identifier     n_versions            # Total number of saved versions   ),   versions = data.table(     version_id,           # Unique version identifier     artifact_id,          # Links to artifacts table     content_hash,         # Hash of file contents     code_hash,            # Hash of generating code (if tracked)     size_bytes,           # File size in bytes     created_at,           # ISO8601 UTC timestamp     sidecar_format        # \"json\", \"qs2\", \"both\", or \"none\"   ) ) # List all versions of an artifact versions <- st_versions(test_path) str(versions) #> Classes 'data.table' and 'data.frame':   1 obs. of  7 variables: #>  $ version_id    : chr \"85a7ee1efbbb2bec\" #>  $ artifact_id   : chr \"0a9be1ded6025310\" #>  $ content_hash  : chr \"2d26c6e5d9121bfd\" #>  $ code_hash     : chr NA #>  $ size_bytes    : num 262 #>  $ created_at    : chr \"2026-01-12T22:55:51.445941Z\" #>  $ sidecar_format: chr \"json\" #>  - attr(*, \".internal.selfref\")=<externalptr>  # Get latest version ID latest_id <- st_latest(test_path) latest_id #> [1] \"85a7ee1efbbb2bec\"  # Get comprehensive info (catalog + sidecar + snapshot location) info <- st_info(test_path) str(info, max.level = 1) #> List of 4 #>  $ sidecar     :List of 10 #>  $ catalog     :List of 2 #>  $ snapshot_dir: 'fs_path' chr \"/tmp/RtmpfskHSq/stamp-demo/.stamp/versions/data/test.qs2/85a7ee1efbbb2bec\" #>  $ parents     : list()"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"version-snapshots-versions","dir":"Articles","previous_headings":"2. Directory Structure Explained","what":"2.3 Version Snapshots: versions/","title":"The .stamp Directory: Structure and Internals","text":"time save artifact (versioning enabled), new immutable snapshot created: ’s inside version snapshot directory? artifact - complete copy file point time Content hash Code hash (tracked) File size Timestamp Custom metadata tags Parent references (quick view) parents.json - Immutable provenance chain showing artifacts version depends (present parents specified) Example specifying parents save: Notice parents.json file present example . created parents specified.","code":"# Save the same artifact multiple times with changes v1 <- data.frame(x = 1:3) st_save(v1, test_path, code_label = \"initial\") #> ✔ Saved [qs2] → /tmp/RtmpfskHSq/stamp-demo/data/test.qs2 @ version #>   7e0a85ef12d60814 Sys.sleep(0.2)  v2 <- data.frame(x = 1:5) st_save(v2, test_path, code_label = \"added rows\") #> ✔ Saved [qs2] → /tmp/RtmpfskHSq/stamp-demo/data/test.qs2 @ version #>   5c5d86ee8313573d Sys.sleep(0.2)  v3 <- data.frame(x = 1:5, y = 10:14) st_save(v3, test_path, code_label = \"added column\") #> ✔ Saved [qs2] → /tmp/RtmpfskHSq/stamp-demo/data/test.qs2 @ version #>   fda5655bac7a27aa  # Each version gets its own directory fs::dir_tree(fs::path(demo_dir, \".stamp\", \"versions\"), recurse = 2) #> /tmp/RtmpfskHSq/stamp-demo/.stamp/versions #> └── data #>     └── test.qs2 #>         ├── 5c5d86ee8313573d #>         ├── 7e0a85ef12d60814 #>         ├── 85a7ee1efbbb2bec #>         └── fda5655bac7a27aa # Get the latest version directory path latest_vdir <- st_info(test_path)$snapshot_dir  # List contents - note: parents.json only exists if parents were specified fs::dir_ls(latest_vdir) #> /tmp/RtmpfskHSq/stamp-demo/.stamp/versions/data/test.qs2/fda5655bac7a27aa/artifact #> /tmp/RtmpfskHSq/stamp-demo/.stamp/versions/data/test.qs2/fda5655bac7a27aa/sidecar.json  # Read the sidecar from the snapshot sidecar_path <- fs::path(latest_vdir, \"sidecar.json\") if (fs::file_exists(sidecar_path)) {   sidecar <- jsonlite::read_json(sidecar_path)   str(sidecar[c(\"path\", \"format\", \"created_at\", \"size_bytes\", \"code_label\")]) } #> List of 5 #>  $ path      : chr \"/tmp/RtmpfskHSq/stamp-demo/data/test.qs2\" #>  $ format    : chr \"qs2\" #>  $ created_at: chr \"2026-01-12T22:55:52.386253Z\" #>  $ size_bytes: int 265 #>  $ code_label: chr \"added column\" # First, create an upstream artifact upstream_path <- fs::path(demo_dir, \"data\", \"upstream.qs2\") upstream_data <- data.frame(id = 1:10, value = rnorm(10)) st_save(upstream_data, upstream_path, code_label = \"upstream data\") #> ✔ Saved [qs2] → /tmp/RtmpfskHSq/stamp-demo/data/upstream.qs2 @ version #>   8263c131d1c3c3fd upstream_version <- st_latest(upstream_path)  # Now create a derived artifact with parent reference derived_path <- fs::path(demo_dir, \"data\", \"derived.qs2\") derived_data <- data.frame(id = 1:10, transformed = upstream_data$value * 2) st_save(   derived_data,    derived_path,   parents = list(list(path = upstream_path, version_id = upstream_version)),   code_label = \"derived from upstream\" ) #> ✔ Saved [qs2] → /tmp/RtmpfskHSq/stamp-demo/data/derived.qs2 @ version #>   d9a34af045c614c3  # Now check the derived artifact's snapshot - parents.json will be present derived_vdir <- st_info(derived_path)$snapshot_dir fs::dir_ls(derived_vdir) #> /tmp/RtmpfskHSq/stamp-demo/.stamp/versions/data/derived.qs2/d9a34af045c614c3/artifact #> /tmp/RtmpfskHSq/stamp-demo/.stamp/versions/data/derived.qs2/d9a34af045c614c3/parents.json #> /tmp/RtmpfskHSq/stamp-demo/.stamp/versions/data/derived.qs2/d9a34af045c614c3/sidecar.json  # Read parents.json parents_file <- fs::path(derived_vdir, \"parents.json\") if (fs::file_exists(parents_file)) {   parents <- jsonlite::read_json(parents_file)   str(parents) } #> List of 1 #>  $ :List of 2 #>   ..$ path      : chr \"/tmp/RtmpfskHSq/stamp-demo/data/upstream.qs2\" #>   ..$ version_id: chr \"8263c131d1c3c3fd\""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"artifact-organization-path-based-vs--external-storage","dir":"Articles","previous_headings":"2. Directory Structure Explained","what":"2.4 Artifact Organization: Path-Based vs. External Storage","title":"The .stamp Directory: Structure and Internals","text":"versions/ directory organizes snapshots differently depending whether artifact inside outside project directory. affects ’ll find version snapshots disk.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"artifacts-inside-project-root-path-based-organization","dir":"Articles","previous_headings":"2. Directory Structure Explained > 2.4 Artifact Organization: Path-Based vs. External Storage","what":"Artifacts Inside Project Root (Path-Based Organization)","title":"The .stamp Directory: Structure and Internals","text":"save artifact lives inside project directory, stamp mirrors relative path structure: Example: Project root /home/user/myproject/, save /home/user/myproject/data/cleaned.rds path data/cleaned.rds/ mirrors project structure, making versions easy locate.","code":".stamp/versions/ └── data/                        # Mirrors the relative path \"data/\"     └── cleaned.rds/             # One directory per artifact         ├── 20250108T121500Z-abc12345/  # Version 1         ├── 20250108T143000Z-def67890/  # Version 2         └── 20250108T165500Z-ghi13579/  # Version 3"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"artifacts-outside-project-root-hash-based-organization","dir":"Articles","previous_headings":"2. Directory Structure Explained > 2.4 Artifact Organization: Path-Based vs. External Storage","what":"Artifacts Outside Project Root (Hash-Based Organization)","title":"The .stamp Directory: Structure and Internals","text":"save artifact outside project directory (e.g., temp folder shared drive), stamp use relative path. Instead, uses hash-based identifier prevent naming collisions: Example: Project root /home/user/myproject/, save /tmp/external_data.csv a1b2c3d4 first 8 characters artifact’s unique ID (hash absolute path). ensures two files name different absolute paths don’t collide.","code":".stamp/versions/ └── external/                    # Special folder for out-of-project artifacts     └── a1b2c3d4-external_data.csv/   # Hash prefix + basename         ├── 20250108T121500Z-abc12345/         └── 20250108T143000Z-def67890/"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"real-world-example","dir":"Articles","previous_headings":"2. Directory Structure Explained > 2.4 Artifact Organization: Path-Based vs. External Storage","what":"Real-World Example","title":"The .stamp Directory: Structure and Internals","text":"","code":"# Scenario 1: File inside project (uses relative path) project_file <- fs::path(demo_dir, \"outputs\", \"results.qs2\") st_save(data.frame(x = 1:5), project_file)  # Versions stored at: .stamp/versions/outputs/results.qs2/ # ✓ Easy to navigate - mirrors your project structure  # Scenario 2: File outside project (uses hash + basename) external_file <- fs::path_temp(\"temp_results.qs2\") st_save(data.frame(y = 6:10), external_file)  # Versions stored at: .stamp/versions/external/<hash>-temp_results.qs2/ # ✓ Collision-free - different absolute paths get different hashes"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"why-this-matters","dir":"Articles","previous_headings":"2. Directory Structure Explained > 2.4 Artifact Organization: Path-Based vs. External Storage","what":"Why This Matters","title":"The .stamp Directory: Structure and Internals","text":"Inside project: Intuitive navigation - version directories match project structure Outside project: Still tracked, requires using st_info() find exact snapshot location Collision safety: Two files named data.csv different absolute paths never conflict Best practice: Keep artifacts inside project directory possible easier manual inspection .stamp/versions/ tree.","code":""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"the-version-creation-process","dir":"Articles","previous_headings":"3. How Versioning Works","what":"3.1 The Version Creation Process","title":"The .stamp Directory: Structure and Internals","text":"call st_save(), ’s happens internally: step designed atomic crash-safe, ensuring partial writes never corrupt version history.","code":"┌─────────────────────────────────────────────────────────────────┐ │                       st_save(data, path)                       │ └─────────────────────────┬───────────────────────────────────────┘                           │                           ▼          ┌────────────────────────────────────────┐          │  1. Decide if save is needed           │          │     (st_should_save)                   │          ├────────────────────────────────────────┤          │  • Check if file exists                │          │  • Compare content hash                │          │  • Compare code hash                   │          │  • Check versioning policy             │          └────────────────┬───────────────────────┘                           │                           ▼          ┌────────────────────────────────────────┐          │  2. Write artifact atomically          │          ├────────────────────────────────────────┤          │  • Write to temp file                  │          │  • Move to destination (atomic)        │          └────────────────┬───────────────────────┘                           │                           ▼          ┌────────────────────────────────────────┐          │  3. Write sidecar metadata             │          ├────────────────────────────────────────┤          │  • Compute hashes                      │          │  • Record timestamp                    │          │  • Store in stmeta/ directory          │          └────────────────┬───────────────────────┘                           │                           ▼          ┌────────────────────────────────────────┐          │  4. Update catalog                     │          ├────────────────────────────────────────┤          │  • Add version row to catalog          │          │  • Update artifact's latest_version_id │          │  • Increment n_versions counter        │          └────────────────┬───────────────────────┘                           │                           ▼          ┌────────────────────────────────────────┐          │  5. Create version snapshot            │          ├────────────────────────────────────────┤          │  • Copy artifact to versions/          │          │  • Copy sidecars                       │          │  • Write parents.json                  │          └────────────────┬───────────────────────┘                           │                           ▼          ┌────────────────────────────────────────┐          │  6. Apply retention policy             │          │     (if configured)                    │          ├────────────────────────────────────────┤          │  • Prune old versions based on policy  │          └────────────────────────────────────────┘"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"version-identifiers","dir":"Articles","previous_headings":"3. How Versioning Works","what":"3.2 Version Identifiers","title":"The .stamp Directory: Structure and Internals","text":"Version IDs deterministic hashes combining: Timestamp (microsecond precision) Content hash Code hash (available) Artifact ID Example: 20250108T121507123456Z-abc12345 ensures: Chronological ordering - Timestamps sort naturally Uniqueness - Hash suffix prevents collisions Traceability - Hash links specific content state","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"versioning-modes","dir":"Articles","previous_headings":"3. How Versioning Works","what":"3.3 Versioning Modes","title":"The .stamp Directory: Structure and Internals","text":"Control versioning behavior st_opts():","code":"# Show current versioning mode st_opts(\"versioning\", .get = TRUE) #> [1] \"content\"  # Available modes: # - \"content\" (default): Save version only when content or code changes # - \"timestamp\": Save version on every st_save() call # - \"off\": Disable versioning (only update current file + sidecar)  # Example: Force version on every save st_opts(versioning = \"timestamp\") #> ✔ stamp options updated #>   versioning = \"timestamp\" v_same <- data.frame(x = 1:3) st_save(v_same, test_path, code_label = \"first\") #> ✔ Saved [qs2] → /tmp/RtmpfskHSq/stamp-demo/data/test.qs2 @ version #>   c8346a160e2ed778 Sys.sleep(0.2) st_save(v_same, test_path, code_label = \"second identical\")  # Still creates version! #> ✔ Saved [qs2] → /tmp/RtmpfskHSq/stamp-demo/data/test.qs2 @ version #>   3f8ac5c84006610d  # Check: two versions with identical content recent_versions <- st_versions(test_path) tail(recent_versions[, .(version_id, created_at, content_hash)], 2) #>          version_id                  created_at     content_hash #>              <char>                      <char>           <char> #> 1: 7e0a85ef12d60814 2026-01-12T22:55:51.837927Z 41c16cfe6598913b #> 2: 85a7ee1efbbb2bec 2026-01-12T22:55:51.445941Z 2d26c6e5d9121bfd  # Reset to default st_opts(versioning = \"content\") #> ✔ stamp options updated #>   versioning = \"content\""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"key-internal-functions","dir":"Articles","previous_headings":"4. Developer Details","what":"4.1 Key Internal Functions","title":"The .stamp Directory: Structure and Internals","text":"functions power .stamp/ infrastructure (R/version_store.R): Path ID Management: Catalog Operations: Version Management:","code":".st_norm_path(path)           # Normalize path to absolute canonical form .st_artifact_id(path)         # Compute stable hash identifier from path .st_root_dir()                # Get project root from st_init() .st_state_dir_abs()           # Get absolute .stamp/ path .st_catalog_path()            # Path to catalog.qs2 .st_catalog_read()            # Read catalog (or create empty if missing) .st_catalog_write(cat)        # Atomic catalog write with locking .st_catalog_record_version()  # Add new version row to catalog .st_versions_root()           # Get versions/ directory path .st_version_dir(path, vid)    # Compute specific version snapshot path .st_version_commit_files()    # Copy artifact + sidecars to snapshot .st_version_read_parents()    # Read parents.json from snapshot .st_version_write_parents()   # Write parents.json to snapshot"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"file-based-locking-explained","dir":"Articles","previous_headings":"4. Developer Details > 4.2 Concurrency and Safety","what":"File-Based Locking Explained","title":"The .stamp Directory: Structure and Internals","text":"Problem: Imagine two R sessions running simultaneously, trying save artifacts: Without coordination, Session B might overwrite Session ’s changes, losing version records. Solution: stamp uses file-based locking ensure one process modifies catalog time: implemented via lock file (.stamp/catalog.lock): Real-world scenarios locking matters: Parallel processing: Running future::plan(multisession) multiple workers saving artifacts Shared filesystems: Multiple analysts server saving project Background jobs: RStudio background jobs running st_save() work interactively happens without filelock package? stamp falls back advisory locking (enforcement, relies cooperation) Risk corruption increases high-concurrency scenarios Install filelock production use: install.packages(\"filelock\")","code":"Session A: Reads catalog → Modifies → Writes back Session B: Reads catalog → Modifies → Writes back Session A: Acquires lock → Reads → Modifies → Writes → Releases lock Session B: Waits for lock → Acquires lock → Reads → Modifies → Writes → Releases lock # Internal locking mechanism (simplified) .st_with_lock(path, {   cat <- .st_catalog_read()     # Read catalog safely   # ... modify catalog ...       # Make changes   .st_catalog_write(cat)         # Write back safely })  # Lock file: .stamp/catalog.lock # - Created automatically during catalog updates # - Uses filelock package if available (recommended) # - 5-second timeout prevents permanent deadlocks # - Automatically cleaned up after operation completes"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"atomic-operations","dir":"Articles","previous_headings":"4. Developer Details > 4.2 Concurrency and Safety","what":"Atomic Operations","title":"The .stamp Directory: Structure and Internals","text":"Beyond locking, stamp uses atomic operations prevent partial writes corrupt data. “atomic” means: operation either completes entirely fails entirely, -state visible processes. matters: Consider go wrong without atomicity: stamp ensures atomicity: File writes: Always write temp file → move final location (filesystem-level atomic operation) Catalog updates: Read-modify-write lock ensures serialized updates Version snapshots: Immutable created (copy operations, never modified)","code":"# Bad scenario (non-atomic): 1. Start writing new data to file 2. ❌ CRASH (power outage, R session killed, etc.) 3. File now contains partial/corrupt data 4. Version history references a broken file"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"user-level-inspection","dir":"Articles","previous_headings":"5. Inspecting .stamp/ Programmatically","what":"5.1 User-Level Inspection","title":"The .stamp Directory: Structure and Internals","text":"","code":"# List all versions of an artifact versions <- st_versions(test_path) versions[, .(version_id, created_at, size_bytes)] #>          version_id                  created_at size_bytes #>              <char>                      <char>      <num> #> 1: 3f8ac5c84006610d 2026-01-12T22:55:53.027700Z        245 #> 2: c8346a160e2ed778 2026-01-12T22:55:52.787423Z        245 #> 3: fda5655bac7a27aa 2026-01-12T22:55:52.386253Z        265 #> 4: 5c5d86ee8313573d 2026-01-12T22:55:52.145704Z        246 #> 5: 7e0a85ef12d60814 2026-01-12T22:55:51.837927Z        245 #> 6: 85a7ee1efbbb2bec 2026-01-12T22:55:51.445941Z        262  # Get comprehensive info info <- st_info(test_path) info$catalog  # Latest version and count #> $latest_version_id #> [1] \"3f8ac5c84006610d\" #>  #> $n_versions #> [1] 6 info$snapshot_dir  # Path to latest snapshot #> /tmp/RtmpfskHSq/stamp-demo/.stamp/versions/data/test.qs2/3f8ac5c84006610d  # Load a specific historical version if (nrow(versions) > 1) {   old_version <- st_load(test_path, version = -1)  # Previous version   str(old_version) } #> ✔ Loaded ← /tmp/RtmpfskHSq/stamp-demo/data/test.qs2 @ #> c8346a160e2ed778 [qs2] #> 'data.frame':    3 obs. of  1 variable: #>  $ x: int  1 2 3"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"direct-catalog-access-advanced","dir":"Articles","previous_headings":"5. Inspecting .stamp/ Programmatically","what":"5.2 Direct Catalog Access (Advanced)","title":"The .stamp Directory: Structure and Internals","text":"","code":"# NOT recommended for users, but useful for debugging catalog_path <- fs::path(demo_dir, \".stamp\", \"catalog.qs2\") if (fs::file_exists(catalog_path)) {   cat <- qs2::qs_read(catalog_path)      # View all artifacts   print(cat$artifacts)      # View all versions   print(cat$versions) }"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"exploring-snapshots","dir":"Articles","previous_headings":"5. Inspecting .stamp/ Programmatically","what":"5.3 Exploring Snapshots","title":"The .stamp Directory: Structure and Internals","text":"","code":"# Get all version directories for an artifact versions_root <- fs::path(demo_dir, \".stamp\", \"versions\") artifact_dir <- fs::path(versions_root, \"data\", \"test.qs2\")  if (fs::dir_exists(artifact_dir)) {   # List all version snapshots   snapshot_dirs <- fs::dir_ls(artifact_dir, type = \"directory\")      # Inspect contents of latest snapshot   if (length(snapshot_dirs) > 0) {     latest <- snapshot_dirs[length(snapshot_dirs)]     fs::dir_tree(latest)          # Read parents.json if present     parents_file <- fs::path(latest, \"parents.json\")     if (fs::file_exists(parents_file)) {       parents <- jsonlite::read_json(parents_file)       str(parents)     }   } } #> /tmp/RtmpfskHSq/stamp-demo/.stamp/versions/data/test.qs2/fda5655bac7a27aa #> ├── artifact #> └── sidecar.json"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"missing-or-corrupt--stamp-directory","dir":"Articles","previous_headings":"6. Troubleshooting","what":"6.1 Missing or Corrupt .stamp/ Directory","title":"The .stamp Directory: Structure and Internals","text":"Symptom: Functions like st_versions() return empty results error. Diagnosis: Solution:","code":"# Check if .stamp exists stamp_dir <- fs::path(demo_dir, \".stamp\") fs::dir_exists(stamp_dir)  # Check if catalog exists catalog_path <- fs::path(stamp_dir, \"catalog.qs2\") fs::file_exists(catalog_path) # Re-initialize (safe, won't delete existing data) st_init(demo_dir)  # If catalog is corrupt, it will be recreated empty on first st_save() # Note: This means version history is lost - restore from backup if available"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"catalog-schema-mismatch","dir":"Articles","previous_headings":"6. Troubleshooting","what":"6.2 Catalog Schema Mismatch","title":"The .stamp Directory: Structure and Internals","text":"Symptom: Error: “Catalog schema mismatch versions table.” Cause: Package upgrade changed catalog structure, manual corruption. Solution:","code":"# Back up existing catalog backup_path <- fs::path(stamp_dir, \"catalog_backup.qs2\") fs::file_copy(catalog_path, backup_path, overwrite = TRUE)  # Option 1: Delete catalog and rebuild (LOSES VERSION HISTORY) fs::file_delete(catalog_path) # Next st_save() will create fresh catalog  # Option 2: Manual migration (advanced - contact package maintainer)"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"disk-space-issues","dir":"Articles","previous_headings":"6. Troubleshooting","what":"6.3 Disk Space Issues","title":"The .stamp Directory: Structure and Internals","text":"Symptom: .stamp/versions/ grows large. Diagnosis: Solution:","code":"# Check total size info <- fs::dir_info(stamp_dir, recurse = TRUE) data.table::data.table(total_mb = sum(info$size) / 1024^2)  # Find largest directories info <- data.table::as.data.table(   fs::dir_info(fs::path(stamp_dir, \"versions\"), recurse = TRUE) ) info[order(-size)][1:10] # Configure retention policy to auto-prune old versions st_opts(retention_policy = list(n = 10, days = 90))  # Manually prune versions for specific artifact st_prune_versions(test_path, policy = list(n = 5), dry_run = FALSE)  # Prune all artifacts (use with caution!) catalog <- stamp:::.st_catalog_read() for (aid in unique(catalog$versions$artifact_id)) {   artifact_path <- catalog$artifacts[artifact_id == aid]$path[1]   st_prune_versions(artifact_path, policy = list(n = 5), dry_run = FALSE) }"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"version-timestamp-issues","dir":"Articles","previous_headings":"6. Troubleshooting","what":"6.4 Version Timestamp Issues","title":"The .stamp Directory: Structure and Internals","text":"Symptom: Timestamps appear corrupted versions won’t load. Diagnosis: Solution: package automatically drops corrupt version rows reading. happens frequently, check : System clock issues Concurrent access without proper locking Manual modification catalog files","code":"# Check for invalid timestamps vers <- st_versions(test_path) bad_timestamps <- vers[is.na(created_at) | created_at == \"\"] nrow(bad_timestamps) #> [1] 0"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"artifacts-outside-project-root","dir":"Articles","previous_headings":"6. Troubleshooting","what":"6.5 Artifacts Outside Project Root","title":"The .stamp Directory: Structure and Internals","text":"Symptom: Can’t find version snapshots artifacts outside project directory. Explanation: stored versions/external/ special naming convention.","code":"# Artifact outside project root external_path <- fs::path_temp(\"external_data.csv\") st_save(data.frame(a = 1:3), external_path)  # Snapshot is under external/ aid <- stamp:::.st_artifact_id(external_path) substr(aid, 1, 8)  # First 8 chars used in directory name  external_dir <- fs::path(stamp_dir, \"versions\", \"external\") fs::dir_ls(external_dir)"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"lock-file-issues","dir":"Articles","previous_headings":"6. Troubleshooting","what":"6.6 Lock File Issues","title":"The .stamp Directory: Structure and Internals","text":"Symptom: catalog.lock file persists crash. Solution:","code":"# Safe to delete if no stamp operations are running lock_file <- fs::path(stamp_dir, \"catalog.lock\") if (fs::file_exists(lock_file)) {   fs::file_delete(lock_file) }"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"version-control-integration","dir":"Articles","previous_headings":"7. Best Practices","what":"7.1 Version Control Integration","title":"The .stamp Directory: Structure and Internals","text":"Include .gitignore: Consider including: - .stamp/catalog.qs2 - Enables version history tracking across team - .stamp/versions/ - Useful small datasets, prohibitive large files large projects:","code":".stamp/temp/ .stamp/logs/ .stamp/catalog.lock # .gitignore .stamp/versions/  # Too large for git .stamp/catalog.qs2  # Local catalog only"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"backup-strategy","dir":"Articles","previous_headings":"7. Best Practices","what":"7.2 Backup Strategy","title":"The .stamp Directory: Structure and Internals","text":"","code":"# Periodic catalog backup backup_dir <- fs::path(demo_dir, \"_backups\") fs::dir_create(backup_dir)  catalog_src <- fs::path(stamp_dir, \"catalog.qs2\") catalog_dst <- fs::path(backup_dir, sprintf(\"catalog_%s.qs2\", Sys.Date())) fs::file_copy(catalog_src, catalog_dst, overwrite = TRUE)  # For critical projects, also backup versions/ versions_src <- fs::path(stamp_dir, \"versions\") versions_dst <- fs::path(backup_dir, sprintf(\"versions_%s\", Sys.Date())) fs::dir_copy(versions_src, versions_dst, overwrite = TRUE)"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"summary","dir":"Articles","previous_headings":"","what":"8. Summary","title":"The .stamp Directory: Structure and Internals","text":".stamp/ directory robust, append-version store : ✅ Persists across sessions - Re-running st_init() safe ✅ Tracks complete version history - Every save creates immutable snapshot ✅ Enables lineage tracking - Parent relationships preserved parents.json ✅ Supports concurrent access - File-based locking prevents corruption ✅ Scales retention policies - Auto-prune old versions manage disk space Key takeaways users: .stamp/ created grows version Safe re-initialize without losing history Use st_versions(), st_info(), st_load(version=...) explore history Configure retention policies manage disk usage Key takeaways developers: Catalog source truth (two tables: artifacts, versions) Version snapshots immutable organized relative path writes use atomic operations + locking safety Internal functions prefixed .st_ provide infrastructure","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp-directory.html","id":"further-reading","dir":"Articles","previous_headings":"","what":"Further Reading","title":"The .stamp Directory: Structure and Internals","text":"vignette(\"setup--basics\", package = \"stamp\") - General introduction vignette(\"hashing--versions\", package = \"stamp\") - Deep dive content hashing","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"the-problem","dir":"Articles","previous_headings":"","what":"The Problem","title":"Stamp","text":"multiple input files produced different processes. want read, process, save derived artifacts capturing. Let’s simulate data folder structure:","code":"if (requireNamespace(\"pkgload\", quietly = TRUE)) {   pkgload::load_all(\".\") } else {   library(stamp) } #> ℹ Loading stamp library(data.table) set.seed(123)  # Create an isolated temporary root so all writes occur outside the package tree. # Use a short name to avoid long path issues on Windows (PATH_MAX = 260). root_dir <- fs::path_temp(\"s\") |>   fs::dir_create() old_wd <- setwd(root_dir) on.exit(setwd(old_wd), add = TRUE)  # Initialize stamp under this temp root st_init(root = root_dir) #> ✔ stamp initialized #>   root: /tmp/Rtmpn04LOV/s #>   state: /tmp/Rtmpn04LOV/s/.stamp  # Define subdirectories (they will be created as needed) welfare_dir <- fs::path(root_dir, \"data\", \"welfare\") macro_dir <- fs::path(root_dir, \"data\", \"macro\") population_dir <- macro_dir outputs_dir <- fs::path(root_dir, \"outputs\") |>   fs::dir_create() welfare_parts_dir <- fs::path(root_dir, \"data\", \"welfare_parts\") summary_parts_dir <- fs::path(root_dir, \"outputs\", \"summary_parts\")  fs::dir_create(c(welfare_dir, macro_dir, welfare_parts_dir, summary_parts_dir))  # Helper: list only data files with known extensions to avoid locks/sidecars data_files <- function(dir) {   f <- fs::dir_ls(dir, type = \"file\")   ext <- tolower(fs::path_ext(f))   allowed <- c(\"qs2\", \"qs\", \"rds\", \"csv\", \"fst\", \"json\")   f[ext %in% allowed] }"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"harmonizing-economic-indicators-with-versioning-lineage","dir":"Articles","previous_headings":"The Solution","what":"Harmonizing Economic Indicators with Versioning & Lineage","title":"Stamp","text":"walk realistic data engineering scenario: several country/year micro datasets macro indicators must combined standardized output table. want: Consistent saving, versioning, timestamp metadata input artifact. Explicit primary keys (PK) recorded disk. derived summary table saved full lineage (parents listed). Demonstrating single input change propagates using st_is_stale(), st_plan_rebuild(), st_rebuild(). Adding new data (ARG 2015) observing minimal recomputation. Producing output using partitioned artifacts partial re-runs. Countries/years welfare (micro) data: COL2010, COL2012, MEX2010, MEX2015, PRY2011, PRY2014. Reporting levels: COL MEX: urban rural. PRY: national. Macro data (CPI, GDP, population) exist COL, MEX, PRY, BRA, ARG (2010–2015). CPI & population three reporting levels (national, urban, rural) every country-year.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"simulate-and-save-input-micro-data","dir":"Articles","previous_headings":"The Solution","what":"1. Simulate and Save Input Micro Data","title":"Stamp","text":"’ll create small synthetic micro datasets columns: country, year, reporting_level, hh_id, welfare, weight. call st_save() assigns version id (content differs) writes sidecar metadata including PK. Inspect one artifact:","code":"fs::dir_create(welfare_dir)  welfare_specs <- data.frame(   country = c(\"COL\", \"COL\", \"MEX\", \"MEX\", \"PRY\", \"PRY\"),   year = c(2010, 2012, 2010, 2015, 2011, 2014),   stringsAsFactors = FALSE )  mk_reporting <- function(cty) {   if (cty %in% c(\"COL\", \"MEX\")) c(\"urban\", \"rural\") else c(\"national\") }  simulate_welfare <- function(country, year) {   rl <- mk_reporting(country)   # 200 households per reporting level   dt_list <- lapply(rl, function(rlev) {     n <- 200L     data.table(       country = country,       year = year,       reporting_level = rlev,       hh_id = sprintf(\"%s_%s_%s_%03d\", country, year, rlev, seq_len(n)),       welfare = round(         rlnorm(n, meanlog = log(1000 + year) - 7, sdlog = 0.5),         2       ),       weight = runif(n, 0.5, 2)     )   })   rbindlist(dt_list) }  welfare_paths <- list() for (i in seq_len(nrow(welfare_specs))) {   row <- welfare_specs[i, ]   dt <- simulate_welfare(row$country, row$year)   fn <- fs::path(welfare_dir, sprintf(\"%s_%d.qs2\", row$country, row$year))   # Primary key columns include household id for uniqueness   st_save(     dt,     fn,     pk = c(\"country\", \"year\", \"reporting_level\", \"hh_id\"),     domain = \"welfare\"   )   welfare_paths[[length(welfare_paths) + 1]] <- fn } #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 @ version #>   3c53cc8767cf3867 #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 @ version #>   eb2b88f7ce7cda5a #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 @ version #>   092be2dac254bbbf #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 @ version #>   2573a0bf69f6d327 #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 @ version #>   56f2ff0112ad66c3 #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 @ version #>   fe16a5a5f834b248 unlist(welfare_paths) #> [1] \"/tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2\" #> [2] \"/tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2\" #> [3] \"/tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2\" #> [4] \"/tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2\" #> [5] \"/tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2\" #> [6] \"/tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2\" st_info(fs::path(welfare_dir, \"COL_2010.qs2\")) #> $sidecar #> $sidecar$path #> [1] \"/tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2\" #>  #> $sidecar$format #> [1] \"qs2\" #>  #> $sidecar$created_at #> [1] \"2026-01-12T22:55:57.415405Z\" #>  #> $sidecar$size_bytes #> [1] 4805 #>  #> $sidecar$content_hash #> [1] \"051b413d268e903b\" #>  #> $sidecar$code_hash #> NULL #>  #> $sidecar$file_hash #> NULL #>  #> $sidecar$code_label #> NULL #>  #> $sidecar$parents #> list() #>  #> $sidecar$attrs #> list() #>  #> $sidecar$pk #> $sidecar$pk$keys #> [1] \"country\"         \"year\"            \"reporting_level\" \"hh_id\"           #>  #>  #> $sidecar$domain #> [1] \"welfare\" #>  #>  #> $catalog #> $catalog$latest_version_id #> [1] \"3c53cc8767cf3867\" #>  #> $catalog$n_versions #> [1] 1 #>  #>  #> $snapshot_dir #> /tmp/Rtmpn04LOV/s/.stamp/versions/data/welfare/COL_2010.qs2/3c53cc8767cf3867 #>  #> $parents #> list()"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"simulate-and-save-macro-data-cpi-gdp-population","dir":"Articles","previous_headings":"The Solution","what":"2. Simulate and Save Macro Data (CPI, GDP, Population)","title":"Stamp","text":"CPI & population reporting-level granular; GDP country-year . Version listing CPI:","code":"fs::dir_create(macro_dir)  years <- 2010:2015 countries_macro <- c(\"COL\", \"MEX\", \"PRY\", \"BRA\", \"ARG\") levels_all <- c(\"national\", \"urban\", \"rural\")  simulate_cpi <- function() {   out <- CJ(     country = countries_macro,     year = years,     reporting_level = levels_all   )   out[, cpi := round(runif(.N, 80, 140), 2)]   out }  simulate_population <- function() {   out <- CJ(     country = countries_macro,     year = years,     reporting_level = levels_all   )   out[, population := round(runif(.N, 5e5, 20e6))]   out }  simulate_gdp <- function() {   out <- CJ(country = countries_macro, year = years)   out[, gdp := round(runif(.N, 1e9, 5e11))]   out }  cpi <- simulate_cpi() pop <- simulate_population() gdp <- simulate_gdp()  st_save(   cpi,   fs::path(macro_dir, \"cpi.qs2\"),   pk = c(\"country\", \"year\", \"reporting_level\"),   domain = \"macro\" ) #> ✔ Saved [qs2] → #> /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 @ version 65f271360e0bb143 st_save(   pop,   fs::path(macro_dir, \"population.qs2\"),   pk = c(\"country\", \"year\", \"reporting_level\"),   domain = \"macro\" ) #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/data/macro/population.qs2 @ version #>   215eeb990b946d57 st_save(   gdp,   fs::path(macro_dir, \"gdp.qs2\"),   pk = c(\"country\", \"year\"),   domain = \"macro\" ) #> ✔ Saved [qs2] → #> /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 @ version 8edd083eb0d3b03d st_versions(fs::path(macro_dir, \"cpi.qs2\"))"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"aggregation-function-foo-and-output-table","dir":"Articles","previous_headings":"The Solution","what":"3. Aggregation Function foo() and Output Table","title":"Stamp","text":"compute per (country, year, reporting_level) welfare statistics merge CPI, GDP, population. demonstrate loading inputs inside function self-containment. Save summary lineage: parents include welfare micro datasets plus CPI/GDP/population. Note: make provenance explicit, pass producing function code= st_save() records function hash. demonstrate patterns: foo() loads data, bar() accepts pre-loaded objects saved code = bar. Handling multiple function dependencies output depends one function (example foo() calls f1() f2()), can provide combined code metadata st_save() captures producing functions. st_save() accepts object code; best practice pass short list functions involved, e.g. code = list(foo = foo, helper1 = f1, helper2 = f2). package hashes code records code_hash sidecar downstream st_is_stale() can detect changes contributor. Example pattern:","code":"foo <- function() {   # Load all welfare micro artifacts (only recognized data files)   welfare_files <- data_files(welfare_dir)   wf <- rbindlist(lapply(welfare_files, st_load))    stats <- wf[,     .(       welfare_mean = weighted.mean(welfare, weight),       welfare_median = as.numeric(stats::median(welfare)),       welfare_sd = stats::sd(welfare),       welfare_n = .N     ),     by = .(country, year, reporting_level)   ]    cpi <- st_load(fs::path(macro_dir, \"cpi.qs2\"))   gdp <- st_load(fs::path(macro_dir, \"gdp.qs2\"))   pop <- st_load(fs::path(macro_dir, \"population.qs2\"))    # Merge; CPI & population contain rows not present in welfare; keep welfare rows only   out <- merge(     stats,     cpi,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(     out,     pop,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(out, gdp, by = c(\"country\", \"year\"), all.x = TRUE)   setcolorder(     out,     c(       \"country\",       \"year\",       \"reporting_level\",       \"welfare_mean\",       \"welfare_median\",       \"welfare_sd\",       \"welfare_n\",       \"cpi\",       \"gdp\",       \"population\"     )   )   out }  summary_table <- foo() #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/population.qs2 head(summary_table) #> Key: <country, year> #>    country  year reporting_level welfare_mean welfare_median welfare_sd #>     <char> <int>          <char>        <num>          <num>      <num> #> 1:     COL  2010           rural     3.188479          2.895   1.604006 #> 2:     COL  2010           urban     3.065242          2.665   1.681036 #> 3:     COL  2012           rural     3.196254          2.820   1.872963 #> 4:     COL  2012           urban     3.079524          2.750   1.627238 #> 5:     MEX  2010           rural     3.247370          2.775   1.696690 #> 6:     MEX  2010           urban     3.006862          2.710   1.606477 #>    welfare_n    cpi          gdp population #>        <int>  <num>        <num>      <num> #> 1:       200  92.71 449669674645   10746038 #> 2:       200  99.10 449669674645    5152778 #> 3:       200  93.11  55701684731    7761159 #> 4:       200 111.42  55701684731   15249755 #> 5:       200  93.68 384563952393    5367608 #> 6:       200 125.54 384563952393   12591517 parent_paths <- c(   data_files(welfare_dir),   fs::path(macro_dir, \"cpi.qs2\"),   fs::path(macro_dir, \"gdp.qs2\"),   fs::path(macro_dir, \"population.qs2\") ) parents <- lapply(parent_paths, function(p) {   list(path = p, version_id = st_latest(p)) })  out_summary_path <- fs::path(outputs_dir, \"welfare_summary.qs2\") st_save(   summary_table,   out_summary_path,   pk = c(\"country\", \"year\", \"reporting_level\"),   parents = parents,   domain = \"summary\" ) #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 @ version #>   200fd0715678021a st_lineage(out_summary_path, depth = 1) #>   level                                    child_path    child_version #> 1     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #> 2     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #> 3     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #> 4     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #> 5     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #> 6     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #> 7     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #> 8     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #> 9     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 200fd0715678021a #>                                   parent_path   parent_version #> 1 /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 3c53cc8767cf3867 #> 2 /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 eb2b88f7ce7cda5a #> 3 /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 092be2dac254bbbf #> 4 /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 2573a0bf69f6d327 #> 5 /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 56f2ff0112ad66c3 #> 6 /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 fe16a5a5f834b248 #> 7        /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 65f271360e0bb143 #> 8        /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 8edd083eb0d3b03d #> 9 /tmp/Rtmpn04LOV/s/data/macro/population.qs2 215eeb990b946d57 # Variant that accepts loaded objects (preferred for testability and clarity) bar <- function(welfare_list, cpi_tbl, gdp_tbl, pop_tbl) {   wf <- data.table::rbindlist(welfare_list)   stats <- wf[,     .(       welfare_mean = weighted.mean(welfare, weight),       welfare_median = as.numeric(stats::median(welfare)),       welfare_sd = stats::sd(welfare),       welfare_n = .N     ),     by = .(country, year, reporting_level)   ]    out <- merge(     stats,     cpi_tbl,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(     out,     pop_tbl,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(out, gdp_tbl, by = c(\"country\", \"year\"), all.x = TRUE)   setcolorder(     out,     c(       \"country\",       \"year\",       \"reporting_level\",       \"welfare_mean\",       \"welfare_median\",       \"welfare_sd\",       \"welfare_n\",       \"cpi\",       \"gdp\",       \"population\"     )   )   out }  # Example: load inputs outside the worker and call bar() welfare_files <- data_files(welfare_dir) welfare_list <- lapply(welfare_files, st_load) #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 cpi_tbl <- st_load(fs::path(macro_dir, \"cpi.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 gdp_tbl <- st_load(fs::path(macro_dir, \"gdp.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 pop_tbl <- st_load(fs::path(macro_dir, \"population.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/Rtmpn04LOV/s/data/macro/population.qs2  summary_table2 <- bar(welfare_list, cpi_tbl, gdp_tbl, pop_tbl) st_save(   summary_table2,   out_summary_path,   pk = c(\"country\", \"year\", \"reporting_level\"),   parents = parents,   code = bar, # addition the function as parent so st_save() can track it   domain = \"summary\" ) #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 @ version #>   5f45794586f2bc13 st_lineage(out_summary_path, depth = 1) #>   level                                    child_path    child_version #> 1     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #> 2     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #> 3     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #> 4     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #> 5     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #> 6     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #> 7     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #> 8     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #> 9     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 5f45794586f2bc13 #>                                   parent_path   parent_version #> 1 /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 3c53cc8767cf3867 #> 2 /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 eb2b88f7ce7cda5a #> 3 /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 092be2dac254bbbf #> 4 /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 2573a0bf69f6d327 #> 5 /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 56f2ff0112ad66c3 #> 6 /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 fe16a5a5f834b248 #> 7        /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 65f271360e0bb143 #> 8        /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 8edd083eb0d3b03d #> 9 /tmp/Rtmpn04LOV/s/data/macro/population.qs2 215eeb990b946d57 # Provide multiple functions to st_save so code_hash changes if any of them change # st_save(x, path, code = list(foo = foo, helper1 = f1, helper2 = f2))"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"modify-cpi-col-2012-new-version-staleness","dir":"Articles","previous_headings":"The Solution","what":"4. Modify CPI (COL 2012) → New Version & Staleness","title":"Stamp","text":"change CPI COL 2012 (reporting levels) illustrate new version stale downstream artifact.","code":"cpi2 <- st_load(fs::path(macro_dir, \"cpi.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 cpi2[country == \"COL\" & year == 2012, cpi := cpi * 1.05] # 5% adjustment st_save(cpi2, fs::path(macro_dir, \"cpi.qs2\")) # new version recorded #> ✔ Saved [qs2] → #> /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 @ version d75a3607799c9d92 st_versions(fs::path(macro_dir, \"cpi.qs2\"))[1:3] #>          version_id      artifact_id     content_hash code_hash size_bytes #>              <char>           <char>           <char>    <char>      <num> #> 1: d75a3607799c9d92 be0215ab0ea6d47b 24996ec3b7463f5f      <NA>        895 #> 2: 65f271360e0bb143 be0215ab0ea6d47b c1456c61190cd9b6      <NA>        880 #> 3:             <NA>             <NA>             <NA>      <NA>         NA #>                     created_at sidecar_format #>                         <char>         <char> #> 1: 2026-01-12T22:55:59.038950Z           json #> 2: 2026-01-12T22:55:57.945061Z           json #> 3:                        <NA>           <NA> st_is_stale(out_summary_path) # should be TRUE #> [1] TRUE"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"builders-plans-and-rebuilds-concepts-and-how-we-use-them-here","dir":"Articles","previous_headings":"The Solution","what":"Builders, plans and rebuilds — concepts and how we use them here","title":"Stamp","text":"short glossary explanation concepts used examples : Artifact: saved object disk (one path managed stamp). Sidecar: metadata file beside artifact (PKs, parents, code hash, domain, timestamps). Version: immutable snapshot; new version id recorded st_save() detects changed content. Parent: pointer (path + version_id) upstream artifact used produce downstream artifact. Lineage: directed graph linking artifacts via parent relationships; inspect st_lineage(). Builder: function registered st_register_builder(path, builder_fn) knows produce one artifact. Returns least x (object save) code (function(s) used) code changes trigger staleness. Plan: result st_plan_rebuild() describing targets stale (parents changed, code changed, artifact missing) thus need rebuilding. Rebuild: executing plan via st_rebuild(plan); runs builders, saves artifacts, updates sidecars/versions. General idea - Register builders reproducible targets. Builders deterministic return object save (save directly inside builder). - Use st_plan_rebuild() compute needs rebuilt (inspects recorded parents code hashes). - Inspect plan, call st_rebuild() execute builders record new versions. vignette implements ideas - register builder out_summary_path (see st_register_builder() call ). builder returns list(x = foo(), code = foo, code_label = \"aggregate_welfare\"). - st_plan_rebuild() compares current parent version ids code hash foo sidecar recorded; parent code changed plan mark target stale. - st_rebuild(plan) calls registered builder, st_save() persistently records new artifact sidecar (including new code_hash parent pointers). - flow gives lightweight, auditable, incremental pipeline: change upstream artifact function plan tell rebuild. Practical tips small example - Builders prefer use parents argument passed (avoids global state makes builders easier test). - target depends multiple functions, pass code st_save() records combined code hash: code = list(foo = foo, helper = f1). Example builder loads parents explicitly returns multiple functions code: Inspect plan running : Run plan execute builders record new versions: example shows recommended pattern: load parents, call pure worker (like bar()), return x code. ensures st_rebuild() can uniformly save artifacts, record lineage, compute code_hash changes future incremental rebuilds. Plan & rebuild using registered builder summary artifact.","code":"# Example: register a builder that uses the provided `parents` list and avoids global loads st_register_builder(out_summary_path, function(path, parents) {   # parents is a list of lists: each element has $path and $version_id   # Filter parent paths to identify welfare partitions vs macros, then load them   welfare_parent_paths <- vapply(     parents,     function(p) grepl(\"welfare\", p$path),     logical(1)   )   welfare_list <- lapply(parents[welfare_parent_paths], function(p) {     st_load(p$path)   })    cpi_tbl <- st_load(fs::path(macro_dir, \"cpi.qs2\"))   gdp_tbl <- st_load(fs::path(macro_dir, \"gdp.qs2\"))   pop_tbl <- st_load(fs::path(macro_dir, \"population.qs2\"))    # Produce the output using a helper function (bar) that accepts pre-loaded inputs   out <- bar(welfare_list, cpi_tbl, gdp_tbl, pop_tbl)    # Return the produced object plus code metadata (capture both producer and helpers)   list(     x = out,     code = list(bar = bar), # include helpers as needed     code_label = \"aggregate_welfare_partitioned\"   ) }) #> ✔ Registered builder for /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 #>   (default) plan <- st_plan_rebuild(   targets = out_summary_path,   include_targets = TRUE,   mode = \"strict\" ) print(plan) #>   level                                          path         reason #> 1     0 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 parent_changed #>   latest_version_before #> 1      5f45794586f2bc13 st_rebuild(plan) #> ✔ Rebuild level 0: 1 artifact #>   • /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 (parent_changed) #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/population.qs2 #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 @ version #>   ded6e5c18105e4de #> OK @ version ded6e5c18105e4de #> ✔ Rebuild summary #>   built 1 st_register_builder(out_summary_path, function(path, parents) {   list(x = foo(), code = foo, code_label = \"aggregate_welfare\") }) #> ✔ Registered builder for /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 #>   (default)  plan <- st_plan_rebuild(   targets = out_summary_path,   include_targets = TRUE,   mode = \"strict\" ) plan #> [1] level                 path                  reason                #> [4] latest_version_before #> <0 rows> (or 0-length row.names) st_rebuild(plan) #> ✔ Nothing to rebuild (empty plan). st_lineage(out_summary_path, depth = 1) #>   level                                    child_path    child_version #> 1     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #> 2     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #> 3     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #> 4     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #> 5     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #> 6     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #> 7     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #> 8     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #> 9     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 ded6e5c18105e4de #>                                   parent_path   parent_version #> 1 /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 3c53cc8767cf3867 #> 2 /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 eb2b88f7ce7cda5a #> 3 /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 092be2dac254bbbf #> 4 /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 2573a0bf69f6d327 #> 5 /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 56f2ff0112ad66c3 #> 6 /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 fe16a5a5f834b248 #> 7        /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 d75a3607799c9d92 #> 8        /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 8edd083eb0d3b03d #> 9 /tmp/Rtmpn04LOV/s/data/macro/population.qs2 215eeb990b946d57"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"add-new-data-arg-2015-welfare","dir":"Articles","previous_headings":"The Solution","what":"5. Add New Data (ARG 2015 Welfare)","title":"Stamp","text":"introduce new welfare dataset (ARG 2015) appears macro tables already. summary rows ARG 2015 newly added.","code":"dt_arg_2015 <- simulate_welfare(\"ARG\", 2015) st_save(   dt_arg_2015,   fs::path(welfare_dir, \"ARG_2015.qs2\"),   pk = c(\"country\", \"year\", \"reporting_level\", \"hh_id\"),   domain = \"welfare\" ) #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/data/welfare/ARG_2015.qs2 @ version #>   9b63ac36d55105e2  parents2 <- lapply(   c(     data_files(welfare_dir),     fs::path(macro_dir, \"cpi.qs2\"),     fs::path(macro_dir, \"gdp.qs2\"),     fs::path(macro_dir, \"population.qs2\")   ),   function(p) list(path = p, version_id = st_latest(p)) ) st_save(   foo(),   out_summary_path,   pk = c(\"country\", \"year\", \"reporting_level\"),   parents = parents2,   domain = \"summary\" ) #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/ARG_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 #> ✔ Loaded [qs2] ← /tmp/Rtmpn04LOV/s/data/macro/population.qs2 #> ✔ Saved [qs2] → /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 @ version #>   281771d8ce9f6bc4 head(st_load(out_summary_path)) #> ✔ Loaded [qs2] ← #> /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 #>    country  year reporting_level welfare_mean welfare_median welfare_sd #>     <char> <int>          <char>        <num>          <num>      <num> #> 1:     ARG  2015        national     3.100148          2.510   1.700340 #> 2:     COL  2010           rural     3.188479          2.895   1.604006 #> 3:     COL  2010           urban     3.065242          2.665   1.681036 #> 4:     COL  2012           rural     3.196254          2.820   1.872963 #> 5:     COL  2012           urban     3.079524          2.750   1.627238 #> 6:     MEX  2010           rural     3.247370          2.775   1.696690 #>    welfare_n      cpi          gdp population #>        <int>    <num>        <num>      <num> #> 1:       200 120.4800 250154797653    8785981 #> 2:       200  92.7100 449669674645   10746038 #> 3:       200  99.1000 449669674645    5152778 #> 4:       200  97.7655  55701684731    7761159 #> 5:       200 116.9910  55701684731   15249755 #> 6:       200  93.6800 384563952393    5367608"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"partitioned-workflow-for-partial-re-execution","dir":"Articles","previous_headings":"The Solution","what":"6. Partitioned Workflow for Partial Re-execution","title":"Stamp","text":"Instead storing one large welfare micro file per country-year, can store partitions per (country, year, reporting_level) using st_save_part() recompute affected partitions input changes. Define partitioned builder writing one output partition per (country, year, reporting_level) summary row. output partition depends : corresponding welfare partition + CPI + GDP + population (three macro artifacts shared parents).","code":"fs::dir_create(welfare_parts_dir)  # Write partitioned welfare (one partition per country/year/reporting_level) for (i in seq_len(nrow(welfare_specs))) {   row <- welfare_specs[i, ]   dt <- simulate_welfare(row$country, row$year) # new simulated (independent from earlier saves)   # split by reporting_level   for (rl in unique(dt$reporting_level)) {     part_dt <- dt[reporting_level == rl]     st_save_part(       part_dt,       base = welfare_parts_dir,       key = list(country = row$country, year = row$year, reporting_level = rl),       code_label = \"welfare_partition\",       pk = c(\"country\", \"year\", \"reporting_level\", \"hh_id\")     )   } } #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=COL/reporting_level=urban/year=2010/part.qs2 #>   @ version d52293e12613a1a7 #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=COL/reporting_level=rural/year=2010/part.qs2 #>   @ version a710b6e09112ca3a #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=COL/reporting_level=urban/year=2012/part.qs2 #>   @ version 41a9d52093b5491e #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=COL/reporting_level=rural/year=2012/part.qs2 #>   @ version c4e39bb86de07f13 #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=MEX/reporting_level=urban/year=2010/part.qs2 #>   @ version eaeedfbed5bf4e10 #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=MEX/reporting_level=rural/year=2010/part.qs2 #>   @ version 534efcd4536e0251 #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=MEX/reporting_level=urban/year=2015/part.qs2 #>   @ version 48baddc800b9c652 #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=MEX/reporting_level=rural/year=2015/part.qs2 #>   @ version e2761953a8151332 #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=PRY/reporting_level=national/year=2011/part.qs2 #>   @ version 5812ea73029c504b #> ✔ Saved [qs2] → #>   /tmp/Rtmpn04LOV/s/data/welfare_parts/country=PRY/reporting_level=national/year=2014/part.qs2 #>   @ version 1733573badd0f9ac st_list_parts(welfare_parts_dir)[1:6, ] #>                                                                                        path #> 1 /tmp/Rtmpn04LOV/s/data/welfare_parts/country=COL/reporting_level=rural/year=2010/part.qs2 #> 2 /tmp/Rtmpn04LOV/s/data/welfare_parts/country=COL/reporting_level=rural/year=2012/part.qs2 #> 3 /tmp/Rtmpn04LOV/s/data/welfare_parts/country=COL/reporting_level=urban/year=2010/part.qs2 #> 4 /tmp/Rtmpn04LOV/s/data/welfare_parts/country=COL/reporting_level=urban/year=2012/part.qs2 #> 5 /tmp/Rtmpn04LOV/s/data/welfare_parts/country=MEX/reporting_level=rural/year=2010/part.qs2 #> 6 /tmp/Rtmpn04LOV/s/data/welfare_parts/country=MEX/reporting_level=rural/year=2015/part.qs2 #>   country reporting_level year #> 1     COL           rural 2010 #> 2     COL           rural 2012 #> 3     COL           urban 2010 #> 4     COL           urban 2012 #> 5     MEX           rural 2010 #> 6     MEX           rural 2015 fs::dir_create(summary_parts_dir)  partition_keys <- st_list_parts(welfare_parts_dir)  build_partition_summary <- function(path, parents) {   # path is the final destination for this partition artifact   # Extract key by parsing path (we stored key in directory names)   rel <- fs::path_rel(path, start = summary_parts_dir)   segs <- strsplit(dirname(rel), .Platform$file.sep)[[1]]   segs <- segs[nzchar(segs)]   # Extract only segments that follow the key=value pattern and ignore others   kv_pairs <- lapply(segs, function(s) {     m <- regmatches(s, regexec(\"^([^=]+)=(.*)$\", s))[[1]]     if (length(m) == 3L) list(k = m[2], v = m[3]) else NULL   })   kv_pairs <- Filter(Negate(is.null), kv_pairs)   if (!length(kv_pairs)) {     key <- list()   } else {     key <- setNames(       lapply(kv_pairs, function(x) x$v),       vapply(kv_pairs, function(x) x$k, character(1))     )   }    # Load welfare partition matching key   w_path <- st_part_path(welfare_parts_dir, key, format = NULL)   w <- st_load(w_path)    stats <- w[,     .(       welfare_mean = weighted.mean(welfare, weight),       welfare_median = as.numeric(median(welfare)),       welfare_sd = sd(welfare),       welfare_n = .N     ),     by = .(country, year, reporting_level)   ]    # Load macro (shared) and subset to key   cpi <- st_load(fs::path(macro_dir, \"cpi.qs2\"))[     country == key$country &       year == as.integer(key$year) &       reporting_level == key$reporting_level   ]   pop <- st_load(fs::path(macro_dir, \"population.qs2\"))[     country == key$country &       year == as.integer(key$year) &       reporting_level == key$reporting_level   ]   gdp <- st_load(fs::path(macro_dir, \"gdp.qs2\"))[     country == key$country & year == as.integer(key$year)   ]    out <- merge(     stats,     cpi,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(     out,     pop,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(out, gdp, by = c(\"country\", \"year\"), all.x = TRUE)   list(     x = out,     code = build_partition_summary,     code_label = \"partition_summary\"   ) } # List a few partitioned summary partitions st_list_parts(summary_parts_dir)[1:6, ] #> [1] NA NA NA NA NA NA"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"partial-re-execution-after-cpi-change","dir":"Articles","previous_headings":"The Solution > 6. Partitioned Workflow for Partial Re-execution","what":"Partial Re-execution After CPI Change","title":"Stamp","text":"CPI changes COL 2012, want rebuild partitions COL 2012 across reporting levels. Rebuild stale partitions (manually filtered): COL 2012 partitions recomputed, avoiding unnecessary work countries/years.","code":"# Modify CPI again (COL 2012) to trigger staleness cpi3 <- st_load(fs::path(macro_dir, \"cpi.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 cpi3[country == \"COL\" & year == 2012, cpi := cpi * 1.02] st_save(cpi3, fs::path(macro_dir, \"cpi.qs2\")) #> ✔ Saved [qs2] → #> /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 @ version 96a62d0e73c7d581  # Detect which partition outputs are stale (simple check: those whose parent CPI version differs) summary_parts <- st_list_parts(summary_parts_dir) stale_idx <- vapply(summary_parts$path, st_is_stale, logical(1)) summary_parts[stale_idx, ] #> character(0) stale_paths <- summary_parts$path[stale_idx] for (p in stale_paths) {   # reconstruct key from path to identify its welfare partition parent   rel <- fs::path_rel(p, start = summary_parts_dir)   segs <- strsplit(dirname(rel), .Platform$file.sep)[[1]]   kv <- lapply(segs, function(s) strsplit(s, \"=\")[[1]])   key <- setNames(lapply(kv, function(x) x[2]), lapply(kv, function(x) x[1]))   parents <- list(     list(       path = st_part_path(welfare_parts_dir, key),       version_id = st_latest(st_part_path(welfare_parts_dir, key))     ),     list(       path = fs::path(macro_dir, \"cpi.qs2\"),       version_id = st_latest(fs::path(macro_dir, \"cpi.qs2\"))     ),     list(       path = fs::path(macro_dir, \"gdp.qs2\"),       version_id = st_latest(fs::path(macro_dir, \"gdp.qs2\"))     ),     list(       path = fs::path(macro_dir, \"population.qs2\"),       version_id = st_latest(fs::path(macro_dir, \"population.qs2\"))     )   )   b <- build_partition_summary(p, parents)   st_save(     b$x,     p,     parents = parents,     pk = c(\"country\", \"year\", \"reporting_level\"),     code = b$code,     code_label = b$code_label   ) }"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"summary","dir":"Articles","previous_headings":"The Solution","what":"7. Summary","title":"Stamp","text":"demonstrated: Saving multiple artifacts PK metadata automatic versioning. Building derived summary explicit lineage rebuilding upstream change. Adding new data (ARG 2015) incorporating minimal friction. partitioned strategy enabling targeted re-execution changed inputs. Explore lineage :","code":"st_lineage(out_summary_path, depth = 2)[1:10, ] #>    level                                    child_path    child_version #> 1      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 2      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 3      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 4      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 5      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 6      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 7      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 8      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 9      1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #> 10     1 /tmp/Rtmpn04LOV/s/outputs/welfare_summary.qs2 281771d8ce9f6bc4 #>                                    parent_path   parent_version #> 1  /tmp/Rtmpn04LOV/s/data/welfare/ARG_2015.qs2 9b63ac36d55105e2 #> 2  /tmp/Rtmpn04LOV/s/data/welfare/COL_2010.qs2 3c53cc8767cf3867 #> 3  /tmp/Rtmpn04LOV/s/data/welfare/COL_2012.qs2 eb2b88f7ce7cda5a #> 4  /tmp/Rtmpn04LOV/s/data/welfare/MEX_2010.qs2 092be2dac254bbbf #> 5  /tmp/Rtmpn04LOV/s/data/welfare/MEX_2015.qs2 2573a0bf69f6d327 #> 6  /tmp/Rtmpn04LOV/s/data/welfare/PRY_2011.qs2 56f2ff0112ad66c3 #> 7  /tmp/Rtmpn04LOV/s/data/welfare/PRY_2014.qs2 fe16a5a5f834b248 #> 8         /tmp/Rtmpn04LOV/s/data/macro/cpi.qs2 d75a3607799c9d92 #> 9         /tmp/Rtmpn04LOV/s/data/macro/gdp.qs2 8edd083eb0d3b03d #> 10 /tmp/Rtmpn04LOV/s/data/macro/population.qs2 215eeb990b946d57 # Remove the temporary root used for vignette examples. Only run in a local # interactive session when you are sure you no longer need the temporary files. if (exists(\"root_dir\") && fs::dir_exists(root_dir)) {   # fs::dir_delete() permanently removes the directory tree.   fs::dir_delete(root_dir) }"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"minimal-project-scaffold-temp","dir":"Articles","previous_headings":"","what":"Minimal project scaffold (temp)","title":"Version Retention, Pruning, and Table Metadata","text":"’ll create artifacts multiple versions demonstrate pruning: Inspect store & catalog:","code":"root <- fs::path(tempdir(), \"stamp-retention-example\") if (fs::dir_exists(root)) {   fs::dir_delete(root) } st_init(root) ## ✔ stamp initialized ##   root: /tmp/Rtmp4c6yJw/stamp-retention-example ##   state: /tmp/Rtmp4c6yJw/stamp-retention-example/.stamp pA <- fs::path(root, \"A.qs\") pB <- fs::path(root, \"B.qs\") pC <- fs::path(root, \"C.qs\")  xA1 <- data.frame(a = 1:3) xA2 <- data.frame(a = 2:4) xA3 <- data.frame(a = 3:5)  xB1 <- data.frame(b = letters[1:3]) xB2 <- data.frame(b = letters[2:4])  xC1 <- data.frame(c = 10:12)  # Keep retention OFF initially so we can create multiple versions st_opts(retain_versions = Inf) ## ✔ stamp options updated ##   retain_versions = \"Inf\" st_save(xA1, pA, code = function(z) z) ## ✔ Saved [qs] → /tmp/Rtmp4c6yJw/stamp-retention-example/A.qs @ version ##   74934fa0589274b9 st_save(xA2, pA, code = function(z) z) ## ✔ Saved [qs] → /tmp/Rtmp4c6yJw/stamp-retention-example/A.qs @ version ##   a10a7d82d7cab448 st_save(xA3, pA, code = function(z) z) ## ✔ Saved [qs] → /tmp/Rtmp4c6yJw/stamp-retention-example/A.qs @ version ##   15d05c5b283db5f5 st_save(xB1, pB, code = function(z) z) ## ✔ Saved [qs] → /tmp/Rtmp4c6yJw/stamp-retention-example/B.qs @ version ##   da7a6fb36d4a50d9 st_save(xB2, pB, code = function(z) z) ## ✔ Saved [qs] → /tmp/Rtmp4c6yJw/stamp-retention-example/B.qs @ version ##   ce82388a990e0010 st_save(xC1, pC, code = function(z) z) ## ✔ Saved [qs] → /tmp/Rtmp4c6yJw/stamp-retention-example/C.qs @ version ##   89252abb406b02bb vroot <- stamp:::.st_versions_root() fs::dir_tree(vroot, recurse = FALSE, all = TRUE) ## /tmp/Rtmp4c6yJw/stamp-retention-example/.stamp/versions ## ├── A.qs ## ├── B.qs ## └── C.qs st_versions(pA) st_versions(pB) st_versions(pC)"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"ad-hoc-pruning-explicit-runs","dir":"Articles","previous_headings":"","what":"Ad-hoc pruning (explicit runs)","title":"Version Retention, Pruning, and Table Metadata","text":"Use want full control (e.g., pre-release cleanup, occasional housekeeping, don’t wire auto-retention st_save()).","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"keep-the-n-latest-for-a-specific-artifact","dir":"Articles","previous_headings":"Ad-hoc pruning (explicit runs)","what":"Keep the n latest for a specific artifact","title":"Version Retention, Pruning, and Table Metadata","text":"Practical tip: always run dry_run = TRUE preview inspect repA calling dry_run = FALSE. returned table indicates snapshots removed allows store plan CI logs audit.","code":"# Dry run (safe preview) st_prune_versions(path = pA, policy = 2, dry_run = TRUE) ## ✔ DRY RUN: 1 version would be pruned across 1 artifact. ##   Estimated space reclaimed: ~137 bytes # Apply pruning repA <- st_prune_versions(path = pA, policy = 2, dry_run = FALSE) repA ##         artifact_id                                artifact_path ##              <char>                                       <char> ## 1: 902f9a4c3415f246 /tmp/Rtmp4c6yJw/stamp-retention-example/A.qs ##          version_id                  created_at size_bytes ##              <char>                      <char>      <num> ## 1: 74934fa0589274b9 2026-01-12T22:56:04.250272Z        137 nrow(st_versions(pA)) # <= 2; latest always protected ## [1] 2"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"keep-by-recency-window-across-the-entire-catalog","dir":"Articles","previous_headings":"Ad-hoc pruning (explicit runs)","what":"Keep by recency window across the entire catalog","title":"Version Retention, Pruning, and Table Metadata","text":"","code":"# Keep anything from the last 14 days; preview first st_prune_versions(policy = list(days = 14), dry_run = TRUE) ## ✔ DRY RUN: 1 version would be pruned across 1 artifact. ##   Estimated space reclaimed: ~137 bytes # Apply repAll <- st_prune_versions(policy = list(days = 14)) ## ✔ DRY RUN: 1 version would be pruned across 1 artifact. ##   Estimated space reclaimed: ~137 bytes head(repAll) ##         artifact_id                                artifact_path ##              <char>                                       <char> ## 1: 902f9a4c3415f246 /tmp/Rtmp4c6yJw/stamp-retention-example/A.qs ##          version_id                  created_at size_bytes ##              <char>                      <char>      <num> ## 1: a10a7d82d7cab448 2026-01-12T22:56:04.310627Z        137"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"combine-count-recency-union-semantics","dir":"Articles","previous_headings":"Ad-hoc pruning (explicit runs)","what":"Combine count + recency (union semantics)","title":"Version Retention, Pruning, and Table Metadata","text":"report returns data frame artifact_path, version_id, created_at, action (keep/delete). Use dry_run = TRUE log/approve plan destructive actions (recommended shared infra/CI). Edge cases & guarantees Latest version always protected (even falls outside policy window). Time windows computed version’s created_at catalog. Pruning idempotent: re-running policy won’t remove policy satisfied.","code":"# Keep last 2 versions OR any version created within 7 days st_prune_versions(policy = list(n = 2, days = 7)) ## ✔ Retention policy matched zero versions; nothing to prune."},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"automatic-pruning-on-every-st_save","dir":"Articles","previous_headings":"","what":"Automatic pruning (on every st_save())","title":"Version Retention, Pruning, and Table Metadata","text":"call internal .st_apply_retention() end st_save(), can choose global policy stop thinking : enable automatic pruning via st_opts(retain_versions = <policy>), .st_apply_retention() invoked st_save() prune according policy just-written artifact. keeps versions directory compact without extra housekeeping steps. cautious enabling aggressive retention (small n short days) shared collaborative projects: set dry_run = TRUE CI approval step destructive pruning. Disable auto-pruning: set project-wide behavior, set options(stamp.retain_versions = ...) project .Rprofile. runtime, st_opts(retain_versions = ...) takes precedence.","code":"# Keep only the latest 2 versions per artifact going forward st_opts(retain_versions = 2) ## ✔ stamp options updated ##   retain_versions = \"2\" # New save writes + immediate prune xA4 <- data.frame(a = 4:6) st_save(xA4, pA, code = function(z) z) ## ✔ Saved [qs] → /tmp/Rtmp4c6yJw/stamp-retention-example/A.qs @ version ##   02539f280f8f9b86 nrow(st_versions(pA)) # <= 2 ## [1] 2 st_opts(retain_versions = Inf) # keep all versions ## ✔ stamp options updated ##   retain_versions = \"Inf\""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"primary-key-metadata-load-time-checks","dir":"Articles","previous_headings":"","what":"Primary-key metadata & load-time checks","title":"Version Retention, Pruning, and Table Metadata","text":"Milestone 4 adds PK metadata table carries identity. improves join safety, reproducibility, downstream tooling (e.g., merge validation).","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"record-pk-at-save-time-recommended","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Record PK at save time (recommended)","title":"Version Retention, Pruning, and Table Metadata","text":"Effects Validates PK columns exist unique (unless disable uniqueness). Persists pk artifact sidecar. Attaches attr(x, \"stamp_pk\") memory subsequent st_load().","code":"pop <- data.frame(   country = c(\"PER\", \"PER\", \"COL\"),   year = c(2023, 2024, 2023),   reporting_level = c(\"national\", \"urban\", \"national\"),   pop = c(34e6, 12e6, 52e6) )  p_pop <- fs::path(root, \"inputs/population.qs\")  # Validates uniqueness by default and writes PK to sidecar # Note: `st_save(..., pk = ...)` validates the keys against the provided data # and persists the `pk` element into the artifact's sidecar (stmeta/). st_save(pop, p_pop, pk = c(\"country\", \"year\", \"reporting_level\")) ## ✔ Saved [qs] → /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/population.qs @ ##   version f76b938fa538128e"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"inspect-repair-pk-later","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Inspect / repair PK later","title":"Version Retention, Pruning, and Table Metadata","text":"","code":"st_inspect_pk(p_pop) # read PK from sidecar ## [1] \"country\"         \"year\"            \"reporting_level\" # If an older artifact lacks PK or you need to repair metadata, use: st_add_pk(p_pop, keys = c(\"country\", \"year\", \"reporting_level\")) ## ✔ stamp options updated ##   require_pk_on_load = \"FALSE\" ## ✔ Loaded [qs] ← /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/population.qs ## ✔ Recorded primary key for ##   /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/population.qs --> country, ##   year, reporting_level ## ✔ stamp options updated ##   require_pk_on_load = \"FALSE\""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"load-time-behavior-options","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Load-time behavior & options","title":"Version Retention, Pruning, and Table Metadata","text":"Missing PK policy:","code":"obj <- st_load(p_pop) ## ✔ Loaded [qs] ← ## /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/population.qs attr(obj, \"stamp_pk\") # keys attached on load ## $keys ## [1] \"country\"         \"year\"            \"reporting_level\" st_opts(\"require_pk_on_load\", .get = TRUE) # default FALSE ## [1] FALSE st_opts(\"warn_missing_pk_on_load\", .get = TRUE) # default TRUE ## [1] TRUE # CI: make PK presence a hard requirement st_opts(require_pk_on_load = TRUE, warn_missing_pk_on_load = FALSE) ## ✔ stamp options updated ##   require_pk_on_load = \"TRUE\", warn_missing_pk_on_load = \"FALSE\""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"why-pks-matter-joins-merges","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Why PKs matter (joins & merges)","title":"Version Retention, Pruning, and Table Metadata","text":"","code":"pop <- data.frame(   country = c(\"PER\", \"MEX\"),   year = c(2023, 2022),   pop = c(34.5, 126.7) ) pop <- st_with_pk(pop, c(\"country\", \"year\"))  gdp <- data.frame(   country = c(\"PER\", \"MEX\"),   year = c(2023, 2022),   gdp = c(0.27, 1.26) ) gdp <- st_with_pk(gdp, c(\"country\", \"year\"))  merged <- merge(pop, gdp, by = c(\"country\", \"year\")) attr(merged, \"stamp_pk\") <- list(keys = c(\"country\", \"year\")) # preserve grain merged ##   country year   pop  gdp ## 1     MEX 2022 126.7 1.26 ## 2     PER 2023  34.5 0.27"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"catalog-corruption-safety","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Catalog corruption & safety","title":"Version Retention, Pruning, and Table Metadata","text":"rare occasions catalog file can become unreadable (disk issues, manual edit, process crash). package conservative: .st_catalog_read() error catalog parsed. can recover removing corrupted catalog file (lives <root>/<state_dir>/catalog.qs2) re-running st_save(); catalog recreated remaining snapshot directories. Always back catalog.qs2 (.stamp/versions/) running destructive operations production. Example recovery steps (manual): Move corrupted catalog: mv <state>/catalog.qs2 <state>/catalog.qs2.bak Re-run st_save() representative artifact recreate catalog. steps safe pruning catalog operations never touch live artifact files — committed snapshots catalog. Tips Include identifier columns PK (country, year, reporting_level, …). Measures part PK. Prefer recording PKs write time. Post-hoc repairs supported easier forget.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"sidecar-metadata-quick-reference","dir":"Articles","previous_headings":"","what":"Sidecar metadata (quick reference)","title":"Version Retention, Pruning, and Table Metadata","text":"Every artifact JSON sidecar sibling stmeta/ : Core: format, created_at, size_bytes Integrity: content_hash, code_hash, optional file_hash Lineage: parents, code_label Tabular: pk, optional domain Inspect: Integrity checks load (enabled via st_opts(verify_on_load = TRUE)): Warn mismatched content_hash (object changed). Warn mismatched file_hash (file bytes changed), recorded.","code":"side <- st_read_sidecar(p_pop) names(side) ##  [1] \"path\"         \"format\"       \"created_at\"   \"size_bytes\"   \"content_hash\" ##  [6] \"code_hash\"    \"file_hash\"    \"code_label\"   \"parents\"      \"attrs\"        ## [11] \"pk\" side$pk ## $keys ## [1] \"country\"         \"year\"            \"reporting_level\""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"partitioned-datasets-hive-style","dir":"Articles","previous_headings":"","what":"Partitioned datasets (Hive-style)","title":"Version Retention, Pruning, and Table Metadata","text":"need one file per key combo (e.g., per country/year), use partition helpers. Layout:","code":"<base>/<k1>=<v1>/<k2>=<v2>/part.<ext>"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"create-partitions-save-parts","dir":"Articles","previous_headings":"Partitioned datasets (Hive-style)","what":"Create partitions & save parts","title":"Version Retention, Pruning, and Table Metadata","text":"st_save_part() uses st_save() hood writes sidecars local stmeta/ directory inside partition.","code":"base <- fs::path(root, \"inputs\", \"country_year\")  # Paths (order of keys doesn't matter; normalized internally) p_per_2023 <- st_part_path(   base,   key = list(country = \"PER\", year = 2023),   format = \"qs2\" ) p_mex_2022 <- st_part_path(base, key = list(country = \"MEX\", year = 2022))  per_tbl <- data.frame(country = \"PER\", year = 2023, pop = 34.5) mex_tbl <- data.frame(country = \"MEX\", year = 2022, pop = 126.7)  # Save; PK recorded in each partition's sidecar st_save_part(   per_tbl,   base,   key = list(country = \"PER\", year = 2023),   pk = c(\"country\", \"year\") ) ## ✔ Saved [qs2] → ##   /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 ##   @ version 69be2eca9cac0677 st_save_part(   mex_tbl,   base,   key = list(country = \"MEX\", year = 2022),   pk = c(\"country\", \"year\") ) ## ✔ Saved [qs2] → ##   /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=MEX/year=2022/part.qs2 ##   @ version 70b114775706ef77"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"discover-load","dir":"Articles","previous_headings":"Partitioned datasets (Hive-style)","what":"Discover & load","title":"Version Retention, Pruning, and Table Metadata","text":"Notes partition artifact data.frame, st_load_parts() returns one-row table .object list-column still appends key columns. Folder keys (e.g., country=PER/year=2023) agree partition table’s PK columns.","code":"# List artifacts (sidecars under stmeta/ are ignored) st_list_parts(base) ##                                                                                         path ## 1 /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=MEX/year=2022/part.qs2 ## 2 /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 ##   country year ## 1     MEX 2022 ## 2     PER 2023 st_list_parts(base, filter = list(country = \"PER\")) ##                                                                                         path ## 1 /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 ##   country year ## 1     PER 2023 # Bind rows (adds key columns as ordinary columns) all_parts <- st_load_parts(base, as = \"rbind\") ## ✔ Loaded [qs2] ← ##   /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=MEX/year=2022/part.qs2 ## ✔ Loaded [qs2] ← ##   /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 all_parts ##   country year   pop ## 1     MEX 2022 126.7 ## 2     PER 2023  34.5 # data.table option (if installed) if (requireNamespace(\"data.table\", quietly = TRUE)) {   dt <- st_load_parts(base, as = \"dt\")   dt[] } ## ✔ Loaded [qs2] ← ##   /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=MEX/year=2022/part.qs2 ## ✔ Loaded [qs2] ← ##   /tmp/Rtmp4c6yJw/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 ##    country   year   pop ##     <char> <char> <num> ## 1:     MEX   2022 126.7 ## 2:     PER   2023  34.5"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"recommendations-recipes","dir":"Articles","previous_headings":"","what":"Recommendations & Recipes","title":"Version Retention, Pruning, and Table Metadata","text":"Safety first: always dry_run = TRUE large catalogs; store plan auditability. Auto vs. manual: prefer auto retention day--day saves; add manual prune step release housekeeping jobs. Project defaults: set options(stamp.retain_versions = ...) .Rprofile; override runtime st_opts(). CI: enforce require_pk_on_load = TRUE run st_prune_versions(..., dry_run = TRUE) produce log destructive steps. Time windows: retention windows based created_at recorded version creation; keep machine clocks sane shared hosts.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"faq","dir":"Articles","previous_headings":"","what":"FAQ","title":"Version Retention, Pruning, and Table Metadata","text":"pruning ever delete latest version? . latest version per artifact always protected. ’s union semantics list(n, days)? version kept among n recent created_at falls within days window. PKs stored? artifact’s sidecar JSON sibling stmeta/. st_load() re-attaches attr(x, \"stamp_pk\"). partition helpers change retention works? . partition artifact versioned/pruned independently, inheriting retention policies.","code":""},{"path":"https://randrescastaneda.github.io/stamp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"R.Andres Castaneda. Author, maintainer. Diana C. Garcia Rojas. Author.","code":""},{"path":"https://randrescastaneda.github.io/stamp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Castaneda R, Garcia Rojas D (2026). stamp: Reproducible Artifact Store Sidecars, Versions, Partitions. R package version 0.0.6, https://randrescastaneda.github.io/stamp/.","code":"@Manual{,   title = {stamp: Reproducible Artifact Store with Sidecars, Versions, and Partitions},   author = {R.Andres Castaneda and Diana C. {Garcia Rojas}},   year = {2026},   note = {R package version 0.0.6},   url = {https://randrescastaneda.github.io/stamp/}, }"},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"stamp","dir":"","previous_headings":"","what":"stamp","title":"stamp","text":"Lightweight versioned artifact store R sidecar metadata, pruning policies, Hive-style partitions.","code":""},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"stamp","text":"can install development version stamp GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"randrescastaneda/stamp\")"},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"quickstart","dir":"","previous_headings":"","what":"Quickstart","title":"stamp","text":"","code":"library(stamp) root <- tempdir() st_init(root) #> ✔ stamp initialized #>   root: C:/Users/wb535623/AppData/Local/Temp/5/Rtmps9BVCS #>   state: C:/Users/wb535623/AppData/Local/Temp/5/Rtmps9BVCS/.stamp  p <- fs::path(root, \"demo.qs\") x <- data.frame(id = 1:3, val = letters[1:3])  st_save(x, p, pk = \"id\", code = function(z) z) #> ✔ Saved [qs] → 'C:/Users/wb535623/AppData/Local/Temp/5/Rtmps9BVCS/demo.qs' @ #>   version 9f17a32f99df9990 y <- st_load(p) #> ✔ Loaded [qs] ← 'C:/Users/wb535623/AppData/Local/Temp/5/Rtmps9BVCS/demo.qs' vrs <- st_versions(p) head(vrs) #>          version_id      artifact_id     content_hash        code_hash #>              <char>           <char>           <char>           <char> #> 1: 9f17a32f99df9990 526fcbc6552f1098 cdbe771e53841cf7 488e8fa49c740261 #>    size_bytes                  created_at sidecar_format #>         <num>                      <char>         <char> #> 1:        170 2025-12-22T10:40:28.932216Z           json  # Retention st_opts(retain_versions = 2) #> ✔ stamp options updated #>   retain_versions = \"2\" st_save(transform(x, val = toupper(val)), p, code = function(z) z) #> ✔ Retention policy matched zero versions; nothing to prune. #> ✔ Saved [qs] → 'C:/Users/wb535623/AppData/Local/Temp/5/Rtmps9BVCS/demo.qs' @ #>   version 68b91238470c74fc vrs <- st_versions(p) head(vrs) #>          version_id      artifact_id     content_hash        code_hash #>              <char>           <char>           <char>           <char> #> 1: 68b91238470c74fc 526fcbc6552f1098 d2b54b7e265bb11f 488e8fa49c740261 #> 2: 9f17a32f99df9990 526fcbc6552f1098 cdbe771e53841cf7 488e8fa49c740261 #>    size_bytes                  created_at sidecar_format #>         <num>                      <char>         <char> #> 1:        149 2025-12-22T10:40:29.104312Z           json #> 2:        170 2025-12-22T10:40:28.932216Z           json  # Partitions base <- fs::path(root, \"inputs/country_year\") st_save_part(   data.frame(country = \"PER\", year = 2023, pop = 34.5),   base,   key = list(country = \"PER\", year = 2023),   pk = c(\"country\", \"year\") ) #> ✔ Retention policy matched zero versions; nothing to prune. #> ✔ Saved [qs2] → #>   'C:/Users/wb535623/AppData/Local/Temp/5/Rtmps9BVCS/inputs/country_year/country=PER/year=2023/part.qs2' #>   @ version 2201f3bf291ca2f2 st_list_parts(base) #>                                                                                                   path #> 1 C:/Users/wb535623/AppData/Local/Temp/5/Rtmps9BVCS/inputs/country_year/country=PER/year=2023/part.qs2 #>   country year #> 1     PER 2023 st_load_parts(base, as = \"rbind\") #> ✔ Loaded [qs2] ← #>   'C:/Users/wb535623/AppData/Local/Temp/5/Rtmps9BVCS/inputs/country_year/country=PER/year=2023/part.qs2' #>   country year  pop #> 1     PER 2023 34.5"},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"file-formats","dir":"","previous_headings":"","what":"File Formats","title":"stamp","text":"stamp supports multiple serialization formats. two binary formats distinct implementations: Important: .qs .qs2 different formats require respective packages. automatic fallback . attempt save/load .qs2 file without qs2 installed, stamp abort clear error message.","code":""},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"installing-format-packages","dir":"","previous_headings":"File Formats","what":"Installing Format Packages","title":"stamp","text":"","code":"# For qs2 format support install.packages(\"qs2\")  # For legacy qs format support install.packages(\"qs\")  # For fst format support install.packages(\"fst\")"},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"format-selection","dir":"","previous_headings":"File Formats","what":"Format Selection","title":"stamp","text":"stamp infers format file extension default: can also specify format explicitly: stamp? Sidecars: hashes, provenance, PKs. Retention: keep latest N /recent days. Partitions: Hive-style directories, easy bind & filter. See vignettes retention + partition details.","code":"# Uses qs2 format (requires {qs2}) st_save(data, \"output.qs2\")  # Uses qs format (requires {qs}) st_save(data, \"output.qs\")  # Uses RDS (base R, always available) st_save(data, \"output.rds\") st_save(data, \"output\", format = \"qs2\")"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_artifact_id.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute artifact identifier (internal) — .st_artifact_id","title":"Compute artifact identifier (internal) — .st_artifact_id","text":"Derive artifact identifier path using stable SipHash normalized path. identifier used group versions belonging logical artifact.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_artifact_id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute artifact identifier (internal) — .st_artifact_id","text":"","code":".st_artifact_id(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_artifact_id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute artifact identifier (internal) — .st_artifact_id","text":"path Character path artifact.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_artifact_id.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute artifact identifier (internal) — .st_artifact_id","text":"Character scalar identifier.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_empty.html","id":null,"dir":"Reference","previous_headings":"","what":"Empty catalog template (internal) — .st_catalog_empty","title":"Empty catalog template (internal) — .st_catalog_empty","text":"Create empty catalog structure used catalog file exists disk. structure contains artifacts versions tables use data.table available, otherwise base data.frame.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_empty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empty catalog template (internal) — .st_catalog_empty","text":"","code":".st_catalog_empty()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_empty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Empty catalog template (internal) — .st_catalog_empty","text":"list elements artifacts versions (data.frame data.table).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_latest_version_row.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","title":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","text":"Return latest version record (single-row data.frame data.table) artifact identified path. artifact version exists, NULL returned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_latest_version_row.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","text":"","code":".st_catalog_latest_version_row(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_latest_version_row.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","text":"path Path artifact.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_latest_version_row.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","text":"single-row data.frame/data.table version metadata, NULL.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Catalog file path (internal) — .st_catalog_path","title":"Catalog file path (internal) — .st_catalog_path","text":"Return path -disk catalog file package state directory: /<state_dir>/catalog.qs2","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Catalog file path (internal) — .st_catalog_path","text":"","code":".st_catalog_path()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Catalog file path (internal) — .st_catalog_path","text":"Character scalar path catalog file.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_read.html","id":null,"dir":"Reference","previous_headings":"","what":"Read catalog from disk (internal) — .st_catalog_read","title":"Read catalog from disk (internal) — .st_catalog_read","text":"Read persisted catalog -disk catalog file. file exist, empty catalog template returned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_read.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read catalog from disk (internal) — .st_catalog_read","text":"","code":".st_catalog_read()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_read.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read catalog from disk (internal) — .st_catalog_read","text":"list elements artifacts versions.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_record_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Record a new version in the catalog (internal) — .st_catalog_record_version","title":"Record a new version in the catalog (internal) — .st_catalog_record_version","text":"Record new version catalog (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_record_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Record a new version in the catalog (internal) — .st_catalog_record_version","text":"","code":".st_catalog_record_version(   artifact_path,   format,   size_bytes,   content_hash,   code_hash,   created_at,   sidecar_format )"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_record_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Record a new version in the catalog (internal) — .st_catalog_record_version","text":"artifact_path Character path artifact file. format Character format name (e.g. \"rds\", \"qs2\"). size_bytes Numeric size artifact bytes. content_hash Character content hash artifact. code_hash Character code hash (available). created_at Character ISO8601 timestamp creation. sidecar_format Character sidecar format present (\"json\", \"qs2\", \"\", \"none\").","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_record_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Record a new version in the catalog (internal) — .st_catalog_record_version","text":"Character version id (SipHash artifact id, hashes, timestamp).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_write.html","id":null,"dir":"Reference","previous_headings":"","what":"Write catalog to disk (internal) — .st_catalog_write","title":"Write catalog to disk (internal) — .st_catalog_write","text":"Persist catalog list disk using QS2-backed format. write performed atomically writing temporary file directory moving place.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_write.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write catalog to disk (internal) — .st_catalog_write","text":"","code":".st_catalog_write(cat)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_write.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write catalog to disk (internal) — .st_catalog_write","text":"cat Catalog list persist (artifacts versions).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_write.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write catalog to disk (internal) — .st_catalog_write","text":"Invisible path catalog file.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_children_once.html","id":null,"dir":"Reference","previous_headings":"","what":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","title":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","text":"Internal helper finds immediate children list path parent committed parents.json snapshots. Returned columns: child_path, child_version, parent_path, parent_version.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_children_once.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","text":"","code":".st_children_once(path, version_id = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_children_once.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","text":"path Character path parent artifact. version_id Optional version id match; provided, children listing exact parent version returned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_children_once.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","text":"data.frame matching children (may empty).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_delete_version_dir_safe.html","id":null,"dir":"Reference","previous_headings":"","what":"Safely delete a version directory (internal) — .st_delete_version_dir_safe","title":"Safely delete a version directory (internal) — .st_delete_version_dir_safe","text":"Safely delete version directory (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_delete_version_dir_safe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Safely delete a version directory (internal) — .st_delete_version_dir_safe","text":"","code":".st_delete_version_dir_safe(vdir)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_dir_create.html","id":null,"dir":"Reference","previous_headings":"","what":"Ensure directory exists (idempotent) — .st_dir_create","title":"Ensure directory exists (idempotent) — .st_dir_create","text":"Create path already exist. Intermediate directories created needed.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_dir_create.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ensure directory exists (idempotent) — .st_dir_create","text":"","code":".st_dir_create(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_dir_create.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ensure directory exists (idempotent) — .st_dir_create","text":"path Character scalar path directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_dir_create.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ensure directory exists (idempotent) — .st_dir_create","text":"Invisibly returns NULL.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_norm_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize a path for use as an identifier (internal) — .st_norm_path","title":"Normalize a path for use as an identifier (internal) — .st_norm_path","text":"Convert path absolute, canonical character representation suitable deterministic hashing use identifier.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_norm_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize a path for use as an identifier (internal) — .st_norm_path","text":"","code":".st_norm_path(p)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_norm_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize a path for use as an identifier (internal) — .st_norm_path","text":"p Character path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_norm_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize a path for use as an identifier (internal) — .st_norm_path","text":"Character scalar absolute path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_now_utc.html","id":null,"dir":"Reference","previous_headings":"","what":"Current time as UTC ISO-8601 (Z) string with microsecond precision — .st_now_utc","title":"Current time as UTC ISO-8601 (Z) string with microsecond precision — .st_now_utc","text":"Current time UTC ISO-8601 (Z) string microsecond precision","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_now_utc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Current time as UTC ISO-8601 (Z) string with microsecond precision — .st_now_utc","text":"","code":".st_now_utc()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_now_utc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Current time as UTC ISO-8601 (Z) string with microsecond precision — .st_now_utc","text":"Character scalar like \"2025-10-30T15:42:07.123456Z\"","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parents_normalize.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize parents structure (internal) — .st_parents_normalize","title":"Normalize parents structure (internal) — .st_parents_normalize","text":"Ensure parents object canonical shape: list lists containing path version_id. Accepts data.frames, singleton lists, list--lists.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parents_normalize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize parents structure (internal) — .st_parents_normalize","text":"","code":".st_parents_normalize(parents)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parents_normalize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize parents structure (internal) — .st_parents_normalize","text":"parents Object representing parents (data.frame, list, etc.)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parents_normalize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize parents structure (internal) — .st_parents_normalize","text":"list parent descriptors (list path version_id).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parse_utc_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse UTC timestamp strings (internal) — .st_parse_utc_times","title":"Parse UTC timestamp strings (internal) — .st_parse_utc_times","text":"Parse UTC timestamp strings (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parse_utc_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse UTC timestamp strings (internal) — .st_parse_utc_times","text":"","code":".st_parse_utc_times(chr)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_policy_keep_ids.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute version IDs to keep under a retention policy (internal) — .st_policy_keep_ids","title":"Compute version IDs to keep under a retention policy (internal) — .st_policy_keep_ids","text":"Compute version IDs keep retention policy (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_policy_keep_ids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute version IDs to keep under a retention policy (internal) — .st_policy_keep_ids","text":"","code":".st_policy_keep_ids(vtab, pol)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_policy_keep_ids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute version IDs to keep under a retention policy (internal) — .st_policy_keep_ids","text":"vtab data.frame versions sorted newest → oldest pol normalized policy .st_normalize_policy()","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_resolve_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Resolve version specification to a concrete version_id (internal) — .st_resolve_version","title":"Resolve version specification to a concrete version_id (internal) — .st_resolve_version","text":"Resolve version specification concrete version_id (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_resolve_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Resolve version specification to a concrete version_id (internal) — .st_resolve_version","text":"","code":".st_resolve_version(path, version = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_resolve_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Resolve version specification to a concrete version_id (internal) — .st_resolve_version","text":"path artifact path version NULL (latest), integer (relative), character (specific version ID), \"select\"/\"pick\"/\"choose\" show interactive menu","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_resolve_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Resolve version specification to a concrete version_id (internal) — .st_resolve_version","text":"character version_id NA_character_","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_root_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Project root directory recorded by st_init() (internal) — .st_root_dir","title":"Project root directory recorded by st_init() (internal) — .st_root_dir","text":"Return absolute project root directory previously recorded st_init(). set, defaults current working directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_root_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Project root directory recorded by st_init() (internal) — .st_root_dir","text":"","code":".st_root_dir()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_root_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Project root directory recorded by st_init() (internal) — .st_root_dir","text":"Character scalar absolute path project root.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_sidecar_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Sidecar metadata path helper (internal) — .st_sidecar_path","title":"Sidecar metadata path helper (internal) — .st_sidecar_path","text":"Build path sidecar metadata file path. Sidecars live sibling directory named stmeta next file's directory. returned filename original basename .stmeta.<ext> suffix ext typically \"json\" \"qs2\".","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_sidecar_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sidecar metadata path helper (internal) — .st_sidecar_path","text":"","code":".st_sidecar_path(path, ext = c(\"json\", \"qs2\"))"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_sidecar_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sidecar metadata path helper (internal) — .st_sidecar_path","text":"path Character scalar path main data file. ext Character scalar extension sidecar (e.g. \"json\" \"qs2\").","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_sidecar_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sidecar metadata path helper (internal) — .st_sidecar_path","text":"Character scalar computed sidecar path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_state_dir_abs.html","id":null,"dir":"Reference","previous_headings":"","what":"Absolute state directory path (internal) — .st_state_dir_abs","title":"Absolute state directory path (internal) — .st_state_dir_abs","text":"Compute absolute path package state directory. constructed /<state_dir> root st_init() state_dir option stored package state.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_state_dir_abs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Absolute state directory path (internal) — .st_state_dir_abs","text":"","code":".st_state_dir_abs()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_state_dir_abs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Absolute state directory path (internal) — .st_state_dir_abs","text":"Character scalar absolute path state directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_commit_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","title":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","text":"Copy artifact file, sidecars, write parents snapshot version directory given version_id.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_commit_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","text":"","code":".st_version_commit_files(artifact_path, version_id, parents = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_commit_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","text":"artifact_path Path artifact file disk. version_id Version identifier snapshot. parents Optional list parent descriptors write parents.json.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_commit_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","text":"Invisibly returns version directory path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Version directory for an artifact (internal) — .st_version_dir","title":"Version directory for an artifact (internal) — .st_version_dir","text":"Compute version directory path artifact_path version_id /<state_dir>/versions. store snapshots relative artifact path root; artifact outside root, fall back collision-free identifier based artifact's unique ID.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Version directory for an artifact (internal) — .st_version_dir","text":"","code":".st_version_dir(artifact_path, version_id)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Version directory for an artifact (internal) — .st_version_dir","text":"artifact_path Path artifact file. version_id Version identifier (character).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Version directory for an artifact (internal) — .st_version_dir","text":"Character scalar path version directory, NA version_id NA/empty.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_read_parents.html","id":null,"dir":"Reference","previous_headings":"","what":"Read parents metadata for a version (internal) — .st_version_read_parents","title":"Read parents metadata for a version (internal) — .st_version_read_parents","text":"Read return parents metadata stored parents.json inside given version_dir. parents file exists empty list returned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_read_parents.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read parents metadata for a version (internal) — .st_version_read_parents","text":"","code":".st_version_read_parents(version_dir)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_read_parents.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read parents metadata for a version (internal) — .st_version_read_parents","text":"version_dir Path version directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_read_parents.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read parents metadata for a version (internal) — .st_version_read_parents","text":"List parent descriptors, empty list.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_write_parents.html","id":null,"dir":"Reference","previous_headings":"","what":"Write parents metadata for a version (internal) — .st_version_write_parents","title":"Write parents metadata for a version (internal) — .st_version_write_parents","text":"Persist list parent descriptors version JSON inside version directory. function performs atomic write avoid partial files disk.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_write_parents.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write parents metadata for a version (internal) — .st_version_write_parents","text":"","code":".st_version_write_parents(version_dir, parents)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_write_parents.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write parents metadata for a version (internal) — .st_version_write_parents","text":"version_dir Path version directory parents.json written. parents List parent descriptors (list path version_id).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_write_parents.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write parents metadata for a version (internal) — .st_version_write_parents","text":"Invisibly NULL.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_versions_root.html","id":null,"dir":"Reference","previous_headings":"","what":"Versions root directory (internal) — .st_versions_root","title":"Versions root directory (internal) — .st_versions_root","text":"Return versions root directory package state directory (.e. /<state_dir>/versions). directory created already exist.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_versions_root.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Versions root directory (internal) — .st_versions_root","text":"","code":".st_versions_root()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_versions_root.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Versions root directory (internal) — .st_versions_root","text":"Character scalar path versions root directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_add_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","title":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","text":"Update artifact sidecar path include primary-key metadata (pk element). artifact file rewritten. default function validates provided keys current -disk artifact (optionally checks uniqueness). Use validate = FALSE skip validation perform pure metadata update.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_add_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","text":"","code":"st_add_pk(path, keys, validate = TRUE, check_unique = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_add_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","text":"path Path artifact file whose sidecar updated. keys Character vector column names set primary key. validate Logical; TRUE validate keys -disk data. check_unique Logical; TRUE assert keys uniquely identify rows -disk data (validate = TRUE).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_add_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","text":"Invisibly returns character vector keys recorded.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_builders.html","id":null,"dir":"Reference","previous_headings":"","what":"List registered builders — st_builders","title":"List registered builders — st_builders","text":"List registered builders","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_builders.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List registered builders — st_builders","text":"","code":"st_builders()"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_builders.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List registered builders — st_builders","text":"data.frame columns: path, name","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed.html","id":null,"dir":"Reference","previous_headings":"","what":"Check whether an artifact would change if saved now — st_changed","title":"Check whether an artifact would change if saved now — st_changed","text":"Compares current object/code/file latest saved metadata (sidecar) reports change detected.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check whether an artifact would change if saved now — st_changed","text":"","code":"st_changed(   path,   x = NULL,   code = NULL,   mode = c(\"any\", \"content\", \"code\", \"file\") )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check whether an artifact would change if saved now — st_changed","text":"path Artifact path disk. x Current -memory object (content comparison). code Optional function/expression/character (code comparison). mode changes check: \"content\", \"code\", \"file\", \"\".","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check whether an artifact would change if saved now — st_changed","text":"list: list(changed = , reason = , detail = )","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed_reason.html","id":null,"dir":"Reference","previous_headings":"","what":"Explain why an artifact would change — st_changed_reason","title":"Explain why an artifact would change — st_changed_reason","text":"Explain artifact change","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed_reason.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Explain why an artifact would change — st_changed_reason","text":"","code":"st_changed_reason(   path,   x = NULL,   code = NULL,   mode = c(\"any\", \"content\", \"code\", \"file\") )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed_reason.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Explain why an artifact would change — st_changed_reason","text":"path Artifact path disk. x Current -memory object (content comparison). code Optional function/expression/character (code comparison). mode changes check: \"content\", \"code\", \"file\", \"\".","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed_reason.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Explain why an artifact would change — st_changed_reason","text":"Character scalar: \"no_change\", \"missing_artifact\", \"missing_meta\", e.g. \"content+code\"","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_children.html","id":null,"dir":"Reference","previous_headings":"","what":"List children (reverse lineage) of an artifact — st_children","title":"List children (reverse lineage) of an artifact — st_children","text":"Finds artifacts depend path (.e., record parents.json snapshots). version_id given, matches specific parent version; otherwise, parent version path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_children.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List children (reverse lineage) of an artifact — st_children","text":"","code":"st_children(path, version_id = NULL, depth = 1L)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_children.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List children (reverse lineage) of an artifact — st_children","text":"path Character path parent artifact. version_id Optional version id path match. Default: . depth Integer depth >= 1. Use Inf recurse fully.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_children.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List children (reverse lineage) of an artifact — st_children","text":"data.frame columns: level, child_path, child_version, parent_path, parent_version.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_clear_builders.html","id":null,"dir":"Reference","previous_headings":"","what":"Clear all builders (or only those for a given path) — st_clear_builders","title":"Clear all builders (or only those for a given path) — st_clear_builders","text":"Clear builders (given path)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_clear_builders.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clear all builders (or only those for a given path) — st_clear_builders","text":"","code":"st_clear_builders(path = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_clear_builders.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clear all builders (or only those for a given path) — st_clear_builders","text":"path Optional character path; provided, builders path removed.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","title":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","text":"Convenience helper subset data.frame set named values. filters argument named list mapping column names allowed values (vector). strict = TRUE, unknown filter columns raise error.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","text":"","code":"st_filter(df, filters = list(), strict = TRUE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","text":"df data.frame filter. filters Named list filtering values, e.g. list(country = \"PER\"). strict Logical; TRUE unknown filter columns cause error.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_filter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","text":"subsetted data.frame (columns df).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_formats.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect available formats — st_formats","title":"Inspect available formats — st_formats","text":"Return sorted character vector names formats currently registered internal registry.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_formats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect available formats — st_formats","text":"","code":"st_formats()"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_formats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect available formats — st_formats","text":"Character vector format names.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_formats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inspect available formats — st_formats","text":"","code":"st_formats() #> [1] \"csv\"     \"fst\"     \"json\"    \"parquet\" \"qs\"      \"qs2\"     \"rds\""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_get_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","title":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","text":"Extract primary-key column names either -memory data.frame (via stamp_pk attribute) sidecar/meta list (previously recorded pk element). Returns empty character vector none found.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_get_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","text":"","code":"st_get_pk(x_or_meta)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_get_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","text":"x_or_meta Either data.frame (attribute stamp_pk) sidecar/meta list returned st_read_sidecar().","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_get_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","text":"Character vector primary-key column names (may length 0).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":null,"dir":"Reference","previous_headings":"","what":"Stable SipHash-1-3 of code — st_hash_code","title":"Stable SipHash-1-3 of code — st_hash_code","text":"Computes stable hash R code (functions, expressions, character vectors). functions, includes formals (arguments) body. Whitespace lightly normalized reduce spurious differences. means code changes alter number spaces strings (e.g. \" b\" vs \"b\") produce identical hashes.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stable SipHash-1-3 of code — st_hash_code","text":"","code":"st_hash_code(code)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stable SipHash-1-3 of code — st_hash_code","text":"code function, expression (language object), character vector","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stable SipHash-1-3 of code — st_hash_code","text":"Lowercase hex string (16 hex characters) siphash13().","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"normalization","dir":"Reference","previous_headings":"","what":"Normalization","title":"Stable SipHash-1-3 of code — st_hash_code","text":"code undergoes light normalization hashing: Multiple spaces/tabs collapsed single space Line endings normalized \\n reduces false positives formatting changes preserving code structure","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"what-gets-hashed","dir":"Reference","previous_headings":"","what":"What Gets Hashed","title":"Stable SipHash-1-3 of code — st_hash_code","text":"Functions: formals (argument list) + body (code) Expressions/language: deparsed code Character vectors: concatenated newlines","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stable SipHash-1-3 of code — st_hash_code","text":"","code":"if (FALSE) { # \\dontrun{ # Hash a function st_hash_code(function(x) x + 1)  # Hash an expression st_hash_code(quote(x + 1))  # Hash character code st_hash_code(\"x <- 1\\ny <- 2\") } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":null,"dir":"Reference","previous_headings":"","what":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"Computes hash file's contents reading file raw bytes hashing via secretbase::siphash13(). faster reading file R first secretbase can stream file directly.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"","code":"st_hash_file(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"path Character path file","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"Lowercase hex string (16 hex characters) siphash13().","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"use-cases","dir":"Reference","previous_headings":"","what":"Use Cases","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"Detecting artifact file modified disk Verifying file integrity across copies Checking file needs re-saved","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"hashes file's raw bytes, R representation. save R object saveRDS(), file hash change even object content (due timestamps, compression variation, etc.). Use st_hash_obj() content-based hashing R objects.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"","code":"if (FALSE) { # \\dontrun{ # Hash a file st_hash_file(\"data.csv\") } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Stable SipHash-1-3 of an R object — st_hash_obj","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"Computes stable hash R object serializing base::serialize(version = 3) hashing resulting bytes via secretbase::siphash13(). hash stable across R sessions (given R version object structure) suitable change detection.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"","code":"st_hash_obj(x)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"x R object (data.frame, data.table, list, vector, etc.)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"Lowercase hex string (16 hex characters) siphash13().","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"attribute-normalization","dir":"Reference","previous_headings":"","what":"Attribute Normalization","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"hashing, function normalizes order object attributes ensure consistent hashes even operations (like collapse::rowbind() + collapse::funique()) leave attributes different orders. normalization reorders attributes canonical form: Priority attributes: names, row.names, class, .internal.selfref attributes: alphabetically sorted ensures logically identical objects produce identical hashes regardless attribute creation history.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"why-this-matters","dir":"Reference","previous_headings":"","what":"Why This Matters","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"Without normalization, two data.frames identical() can produce different hashes internal attributes different orders. breaks change detection stamp, causing false positives objects incorrectly flagged changed.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"performance","dir":"Reference","previous_headings":"","what":"Performance","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"small medium objects: negligible overhead large objects: creates shallow copy (data referenced, duplicated) normalization cost typically < 1% total hashing time","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"","code":"if (FALSE) { # \\dontrun{ # Two ways to create the \"same\" data dt_a <- data.table(x = 1:5) dt_b <- data.table(x = 1:5) |> collapse::rowbind(data.table(x = 1:5)) |> collapse::funique()  # They're identical in content identical(dt_a, dt_b)  # TRUE  # And now they hash the same too! st_hash_obj(dt_a) == st_hash_obj(dt_b)  # TRUE } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","title":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","text":"Inspect artifact's current status (sidecar + catalog + snapshot location)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","text":"","code":"st_info(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","text":"path Artifact path","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","text":"named list fields: sidecar: sidecar list (NULL) catalog: list(latest_version_id, n_versions) snapshot_dir: absolute path latest version dir (NA) parents: list(...) parsed latest version's parents.json ()","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize stamp project structure — st_init","title":"Initialize stamp project structure — st_init","text":"Initialize stamp project structure","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize stamp project structure — st_init","text":"","code":"st_init(root = \".\", state_dir = \".stamp\")"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize stamp project structure — st_init","text":"root project root (default \".\") state_dir directory name internal state (default \".stamp\")","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize stamp project structure — st_init","text":"(invisibly) absolute state dir","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_inspect_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","title":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","text":"Read sidecar path return recorded primary-key column names. sidecar pk information present, returns character(0).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_inspect_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","text":"","code":"st_inspect_pk(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_inspect_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","text":"path Path artifact file.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_inspect_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","text":"Character vector primary-key column names (may length 0).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_is_stale.html","id":null,"dir":"Reference","previous_headings":"","what":"Is a child artifact stale because its parents advanced? — st_is_stale","title":"Is a child artifact stale because its parents advanced? — st_is_stale","text":"Inspect committed parents.json latest snapshot path determine whether parent now different latest version id.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_is_stale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Is a child artifact stale because its parents advanced? — st_is_stale","text":"","code":"st_is_stale(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_is_stale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Is a child artifact stale because its parents advanced? — st_is_stale","text":"path Character path artifact inspect.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_is_stale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Is a child artifact stale because its parents advanced? — st_is_stale","text":"Logical scalar. TRUE parent advanced, otherwise FALSE.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_latest.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the latest version_id for an artifact path — st_latest","title":"Get the latest version_id for an artifact path — st_latest","text":"Get latest version_id artifact path","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_latest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the latest version_id for an artifact path — st_latest","text":"","code":"st_latest(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_latest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the latest version_id for an artifact path — st_latest","text":"path file directory path","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_lineage.html","id":null,"dir":"Reference","previous_headings":"","what":"Show immediate or recursive parents for an artifact — st_lineage","title":"Show immediate or recursive parents for an artifact — st_lineage","text":"Show immediate recursive parents artifact","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_lineage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show immediate or recursive parents for an artifact — st_lineage","text":"","code":"st_lineage(path, depth = 1L)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_lineage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show immediate or recursive parents for an artifact — st_lineage","text":"path Artifact path (child) depth Integer depth >= 1. Use Inf walk recursively.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_lineage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show immediate or recursive parents for an artifact — st_lineage","text":"data.frame columns: level, child_path, child_version, parent_path, parent_version","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":null,"dir":"Reference","previous_headings":"","what":"List available partitions under a base directory — st_list_parts","title":"List available partitions under a base directory — st_list_parts","text":"List available partitions base directory","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List available partitions under a base directory — st_list_parts","text":"","code":"st_list_parts(base, filter = NULL, recursive = TRUE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List available partitions under a base directory — st_list_parts","text":"base Base dir filter Partition filter. Supports three formats: Named list exact matching: list(country = \"USA\", year = 2020) Formula expression: ~ year > 2010 ~ country == \"COL\" & year >= 2012 NULL filtering (default) recursive Logical; search subdirs (default TRUE)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List available partitions under a base directory — st_list_parts","text":"data.frame columns: path plus one column per partition key","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List available partitions under a base directory — st_list_parts","text":"","code":"if (FALSE) { # \\dontrun{ # List all partitions st_list_parts(\"data/parts\")  # Exact match (backward compatible) st_list_parts(\"data/parts\", filter = list(country = \"USA\"))  # Expression-based (flexible) st_list_parts(\"data/parts\", filter = ~ year > 2010) st_list_parts(\"data/parts\", filter = ~ country == \"COL\" & year >= 2012) } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":null,"dir":"Reference","previous_headings":"","what":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"Load object disk (format auto-detected; optional integrity checks)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"","code":"st_load(file, format = NULL, version = NULL, ...)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"file path st_path format optional format override version integer quoted directive. Retrieve specific version artifact. See details. ... forwarded format reader","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"loaded object","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"version argument allows load specific versions: NULL (default): loads recent version available. Negative integer (e.g., -1) zero (0): loads number versions recent version. , 0, loads current version, equivalent NULL. -1, load version right current one, -2 loads two versions , . Positive numbers: Error. Character: treated specific version ID (e.g., \"20250801T162739Z-d86e8\"). \"select\", \"pick\", \"choose\": displays interactive menu select available versions (interactive R sessions).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage: load latest version data <- st_load(\"data/mydata.rds\")  # Load previous version old_data <- st_load(\"data/mydata.rds\", version = -1)  # Load specific version by ID vid <- st_versions(\"data/mydata.rds\")$version_id[3] specific <- st_load(\"data/mydata.rds\", version = vid)  # Interactive menu (in interactive sessions only) selected <- st_load(\"data/mydata.rds\", version = \"select\") # or use \"pick\" or \"choose\" selected <- st_load(\"data/mydata.rds\", version = \"pick\") } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":null,"dir":"Reference","previous_headings":"","what":"Load and row-bind partitioned data — st_load_parts","title":"Load and row-bind partitioned data — st_load_parts","text":"Load row-bind partitioned data","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load and row-bind partitioned data — st_load_parts","text":"","code":"st_load_parts(base, filter = NULL, columns = NULL, as = c(\"rbind\", \"dt\"))"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load and row-bind partitioned data — st_load_parts","text":"base Base dir filter Partition filter. Supports three formats: Named list exact matching: list(country = \"USA\", year = 2020) Formula expression: ~ year > 2010 ~ country == \"COL\" & year >= 2012 NULL filtering (default) columns Character vector column names load (optional). parquet/fst formats, uses native column selection (fast, low memory). formats (qs/rds/csv), loads full object subsets (warning). Data frame binding mode: \"rbind\" (base) \"dt\" (data.table)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load and row-bind partitioned data — st_load_parts","text":"Data frame unioned columns extra columns key fields","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load and row-bind partitioned data — st_load_parts","text":"","code":"if (FALSE) { # \\dontrun{ # Load all partitions st_load_parts(\"data/parts\")  # Filter with exact match st_load_parts(\"data/parts\", filter = list(country = \"USA\"))  # Filter with expression st_load_parts(\"data/parts\", filter = ~ year > 2010)  # Combine filter + column selection st_load_parts(\"data/parts\", filter = ~ year > 2010, columns = c(\"value\", \"metric\")) } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Load a specific version of an artifact — st_load_version","title":"Load a specific version of an artifact — st_load_version","text":"Load previously committed snapshot artifact identified path version_id. artifact file requested version read version snapshot directory using format-specific read handler registered package. useful inspecting restoring historical versions artifacts.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load a specific version of an artifact — st_load_version","text":"","code":"st_load_version(path, version_id, ...)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load a specific version of an artifact — st_load_version","text":"path Character path artifact (value used st_save/st_load). version_id Character version identifier (returned st_save present catalog). ... Additional arguments forwarded format's read function (e.g. read options).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load a specific version of an artifact — st_load_version","text":"object produced format-specific read handler (typically R object loaded disk).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load a specific version of an artifact — st_load_version","text":"function abort requested version snapshot exist registered format handler artifact's format.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load a specific version of an artifact — st_load_version","text":"","code":"if (FALSE) { # \\dontrun{ # load a historical version of a dataset old <- st_load_version(\"data/cleaned.rds\", \"20250101T000000Z-abcdef01\") } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_normalize_attrs.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize attributes for consistent hashing — st_normalize_attrs","title":"Normalize attributes for consistent hashing — st_normalize_attrs","text":"Normalizes order object attributes canonical form creating new object attributes correct order. necessary R allow reordering attributes -place.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_normalize_attrs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize attributes for consistent hashing — st_normalize_attrs","text":"","code":"st_normalize_attrs(x)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_normalize_attrs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize attributes for consistent hashing — st_normalize_attrs","text":"x data.frame, data.table, list, object.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_normalize_attrs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize attributes for consistent hashing — st_normalize_attrs","text":"new object data attributes canonical order. class preserved.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_normalize_attrs.html","id":"problem","dir":"Reference","previous_headings":"","what":"Problem","title":"Normalize attributes for consistent hashing — st_normalize_attrs","text":"Operations like collapse::rowbind() + collapse::funique() can leave attributes different orders even content identical. Since serialize() includes attribute order, causes different byte streams thus different hashes logically identical objects.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_normalize_attrs.html","id":"solution","dir":"Reference","previous_headings":"","what":"Solution","title":"Normalize attributes for consistent hashing — st_normalize_attrs","text":"function reorders attributes canonical order: Priority attributes: names, row.names, class, .internal.selfref Additional attributes: alphabetically sorted","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_normalize_attrs.html","id":"implementation-strategy","dir":"Reference","previous_headings":"","what":"Implementation Strategy","title":"Normalize attributes for consistent hashing — st_normalize_attrs","text":"function creates new object attributes canonical order. shallow copy - actual data (columns, elements) referenced, copied, making efficient even large objects. data.table objects: Warning need sanitation object using st_sanitize_for_hash regular data.frames: Rebuilds column list canonical attribute order Shallow copy (column data referenced, copied) Preserves data.frame class lists objects: Uses unclass() + attribute replacement Shallow copy possible","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_normalize_attrs.html","id":"performance","dir":"Reference","previous_headings":"","what":"Performance","title":"Normalize attributes for consistent hashing — st_normalize_attrs","text":"Shallow copy strategy: data referenced, duplicated Fast path: returns unchanged already canonical order Negligible overhead use cases (< 1% hashing time)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":null,"dir":"Reference","previous_headings":"","what":"Get or set package options — st_opts","title":"Get or set package options — st_opts","text":"Setter: st_opts(meta_format = \"\", versioning = \"timestamp\") Getter: st_opts(.get = TRUE) returns named list options Single getter: st_opts(\"meta_format\", .get = TRUE) returns one value","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get or set package options — st_opts","text":"","code":"st_opts(..., .get = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get or set package options — st_opts","text":"... Named pairs setting options; single character key .get = TRUE. .get Logical. TRUE, performs read instead write.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get or set package options — st_opts","text":"setters, invisible(NULL). getters, requested value(s).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get or set package options — st_opts","text":"Valid keys (defined .stamp_default_opts R/aaa.R): meta_format, versioning, force_on_code_change, retain_versions, code_hash, store_file_hash, verify_on_load, default_format, verbose, timezone, timeformat, usetz, require_pk_on_load, warn_missing_pk_on_load. single authoritative source truth, see .stamp_default_opts R/aaa.R; changes object determine set supported keys.","code":""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_get.html","id":null,"dir":"Reference","previous_headings":"","what":"Convenience getter (optional sugar) — st_opts_get","title":"Convenience getter (optional sugar) — st_opts_get","text":"Convenience getter (optional sugar)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_get.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convenience getter (optional sugar) — st_opts_get","text":"","code":"st_opts_get(key = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_get.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convenience getter (optional sugar) — st_opts_get","text":"key Option name NULL ","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_get.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convenience getter (optional sugar) — st_opts_get","text":"Value list values","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_reset.html","id":null,"dir":"Reference","previous_headings":"","what":"Reset all options to package defaults — st_opts_reset","title":"Reset all options to package defaults — st_opts_reset","text":"Reset options package defaults","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_reset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reset all options to package defaults — st_opts_reset","text":"","code":"st_opts_reset()"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_reset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reset all options to package defaults — st_opts_reset","text":"invisible(NULL)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_part_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Build a concrete partition path under a base directory — st_part_path","title":"Build a concrete partition path under a base directory — st_part_path","text":"Build concrete partition path base directory","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_part_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build a concrete partition path under a base directory — st_part_path","text":"","code":"st_part_path(base, key, file = NULL, format = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_part_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build a concrete partition path under a base directory — st_part_path","text":"base Character base directory (e.g., \"data/users\") key Named list scalar values, e.g. list(country=\"US\", year=2025) file Optional filename (default \"part.\") format Optional format (qs2|rds|csv|fst|json); default = stamp option","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_part_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build a concrete partition path under a base directory — st_part_path","text":"Character file path partition artifact","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Declare a path (with optional format & partition hint) — st_path","title":"Declare a path (with optional format & partition hint) — st_path","text":"Declare path (optional format & partition hint)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Declare a path (with optional format & partition hint) — st_path","text":"","code":"st_path(path, format = NULL, partition_key = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Declare a path (with optional format & partition hint) — st_path","text":"path file directory path format optional explicit format (\"qs2\",\"rds\",\"csv\",\"fst\",\"json\") partition_key optional partition key (used M2)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Declare a path (with optional format & partition hint) — st_path","text":"list class 'st_path'","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize a primary-key specification — st_pk","title":"Normalize a primary-key specification — st_pk","text":"Normalize validate primary-key (pk) specification. canonical representation list element keys containing character vector column names. x (data.frame) provided validate = TRUE function check columns exist (optionally uniquely identify rows).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize a primary-key specification — st_pk","text":"","code":"st_pk(x = NULL, keys, validate = TRUE, check_unique = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize a primary-key specification — st_pk","text":"x Optional data.frame validate keys . NULL, keys vector normalized. keys Character vector column names comprising primary key. validate Logical; TRUE validate columns exist (uniqueness check_unique TRUE). check_unique Logical; TRUE assert keys uniquely identify rows x (checked x provided).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize a primary-key specification — st_pk","text":"list element keys containing canonical character vector.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_plan_rebuild.html","id":null,"dir":"Reference","previous_headings":"","what":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","title":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","text":"Returns set stale descendants targets. Two modes: \"propagate\" (default): treat target \"change\", breadth-first schedule children whose parents intersect set nodes marked \"change\". Newly scheduled nodes also marked \"change\" children considered next level. \"strict\": include nodes already stale parents' current latest versions (propagation).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_plan_rebuild.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","text":"","code":"st_plan_rebuild(   targets,   depth = Inf,   include_targets = FALSE,   mode = c(\"propagate\", \"strict\") )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_plan_rebuild.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","text":"targets Character vector artifact paths. depth Integer depth >= 1, Inf. include_targets Logical; TRUE target stale, include level 0. mode \"propagate\" (default) \"strict\".","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_plan_rebuild.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","text":"data.frame columns: level, path, reason, latest_version_before","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":null,"dir":"Reference","previous_headings":"","what":"Prune stored versions according to a retention policy — st_prune_versions","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"Prune stored versions according retention policy","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"","code":"st_prune_versions(path = NULL, policy = Inf, dry_run = TRUE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"path Optional character vector artifact paths restrict pruning. NULL (default), applies policy artifacts catalog. policy One : Inf (keep everything) numeric scalar n (keep n recent per artifact) list(n = <int>, days = <num>) (keep recent n /newer days; union two conditions) dry_run logical; TRUE, report pruned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"Invisibly, data.frame pruned (-prune) versions columns: artifact_path, version_id, created_at, size_bytes.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"Retention policy semantics policy = Inf — keep versions (pruning). policy = <numeric> — interpreted “keep n recent versions per artifact.” example, policy = 2 keeps latest two prunes older ones. policy = list(...) — combined policy multiple conditions UNIONed (kept condition keeps ): n: keep latest n per artifact. days: keep versions whose created_at within last days days. keep_latest / min_keep (internal fields flows) ensure least floor versions preserved; typical use covered n + days. Grouping & order. Pruning decisions made per artifact, sorting artifact’s versions created_at (newest → oldest). “latest n” condition applied order. Dry runs vs destructive mode. dry_run = TRUE, function reports pruned (estimates reclaimed space). dry_run = FALSE, deletes snapshot directories <state_dir>/versions/... updates catalog accordingly: removes rows versions table, adjusts artifact’s n_versions latest_version_id (newest remaining version), drops artifact row none remain. Scope. can restrict pruning specific artifacts supplying paths via path argument. default (path = NULL), pruning considers artifacts recorded catalog. provide one artifact paths, versions associated artifacts considered pruning. Integration writes. set default policy via st_opts(retain_versions = <policy>), internal helpers may apply pruning right st_save() just-written artifact (keep-default). Safety notes. Pruning never touches live artifact files (.qs, etc.) — stored version snapshots catalog entries. Use dry_run = TRUE first verify removed.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"","code":"# \\donttest{ # Minimal setup: temp project with three artifacts and multiple versions st_opts_reset() st_opts(versioning = \"content\", meta_format = \"json\") #> ✔ stamp options updated #>   versioning = \"content\", meta_format = \"json\"  root <- tempdir() st_init(root) #> ✔ stamp initialized #>   root: /tmp/Rtmpczt1H8 #>   state: /tmp/Rtmpczt1H8/.stamp  # A, B, C pA <- fs::path(root, \"A.qs\"); xA <- data.frame(a = 1:3) pB <- fs::path(root, \"B.qs\"); pC <- fs::path(root, \"C.qs\")  # First versions st_save(xA, pA, code = function(z) z) #> ✔ Saved [qs] → /tmp/Rtmpczt1H8/A.qs @ version bc30e375adf86c24 st_save(transform(xA, b = a * 2), pB, code = function(z) z,         parents = list(list(path = pA, version_id = st_latest(pA)))) #> ✔ Saved [qs] → /tmp/Rtmpczt1H8/B.qs @ version ab96c0889e6c6d05 st_save(transform(st_load(pB), c = b + 1L), pC, code = function(z) z,         parents = list(list(path = pB, version_id = st_latest(pB)))) #> Warning: No primary key recorded for /tmp/Rtmpczt1H8/B.qs. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [qs] ← /tmp/Rtmpczt1H8/B.qs #> ✔ Saved [qs] → /tmp/Rtmpczt1H8/C.qs @ version 15e953dcc9fa8b67  # Create a couple of extra versions for A to have data to prune st_save(transform(xA, a = a + 10L), pA, code = function(z) z) #> ✔ Saved [qs] → /tmp/Rtmpczt1H8/A.qs @ version 51392f01c9f245cd st_save(transform(xA, a = a + 20L), pA, code = function(z) z) #> ✔ Saved [qs] → /tmp/Rtmpczt1H8/A.qs @ version f8a349a542c2b69b  # Inspect versions for A st_versions(pA) #>          version_id      artifact_id     content_hash        code_hash #>              <char>           <char>           <char>           <char> #> 1: f8a349a542c2b69b 46b7080097228ad0 c087655f18c88851 488e8fa49c740261 #> 2: 51392f01c9f245cd 46b7080097228ad0 d16c91dcc04b28d9 488e8fa49c740261 #> 3: bc30e375adf86c24 46b7080097228ad0 1811ba4b2bd2a26a 488e8fa49c740261 #>    size_bytes                  created_at sidecar_format #>         <num>                      <char>         <char> #> 1:        137 2026-01-12T22:55:19.387669Z           json #> 2:        137 2026-01-12T22:55:19.352962Z           json #> 3:        137 2026-01-12T22:55:19.173267Z           json  # 1) Keep everything (no-op) st_prune_versions(policy = Inf, dry_run = TRUE) #> ✔ Retention policy is Inf: no pruning performed.  # 2) Keep only the latest 1 per artifact (dry run) st_prune_versions(policy = 1, dry_run = TRUE) #> ✔ DRY RUN: 2 versions would be pruned across 1 artifact. #>   Estimated space reclaimed: ~274 bytes  # 3) Combined policy: #    - keep the latest 2 per artifact #    - and also keep any versions newer than 7 days (union of both) st_prune_versions(policy = list(n = 2, days = 7), dry_run = TRUE) #> ✔ DRY RUN: 1 version would be pruned across 1 artifact. #>   Estimated space reclaimed: ~137 bytes  # 4) Restrict pruning to a single artifact path st_prune_versions(path = pA, policy = 1, dry_run = TRUE) #> ✔ DRY RUN: 2 versions would be pruned across 1 artifact. #>   Estimated space reclaimed: ~274 bytes  # 5) Apply pruning (destructive): keep latest 1 everywhere #    (Uncomment to run for real) # st_prune_versions(policy = 1, dry_run = FALSE)  # Optional: set a default retention policy and have st_save() apply it # after each write via .st_apply_retention() (internal helper). # For example, keep last 2 versions going forward: st_opts(retain_versions = 2) #> ✔ stamp options updated #>   retain_versions = \"2\" # Next saves will write a new version and then prune older ones for that artifact. # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_read_sidecar.html","id":null,"dir":"Reference","previous_headings":"","what":"Read sidecar metadata (internal) — st_read_sidecar","title":"Read sidecar metadata (internal) — st_read_sidecar","text":"Read sidecar metadata path exists, returning NULL sidecar file present. Preference order JSON first, QS2.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_read_sidecar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read sidecar metadata (internal) — st_read_sidecar","text":"","code":"st_read_sidecar(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_read_sidecar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read sidecar metadata (internal) — st_read_sidecar","text":"path Character path data file whose sidecar read.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_read_sidecar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read sidecar metadata (internal) — st_read_sidecar","text":"list (parsed JSON / qs object) NULL found.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_rebuild.html","id":null,"dir":"Reference","previous_headings":"","what":"Rebuild artifacts from a plan (level order) — st_rebuild","title":"Rebuild artifacts from a plan (level order) — st_rebuild","text":"Rebuild artifacts plan (level order)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_rebuild.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rebuild artifacts from a plan (level order) — st_rebuild","text":"","code":"st_rebuild(plan, rebuild_fun = NULL, dry_run = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_rebuild.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rebuild artifacts from a plan (level order) — st_rebuild","text":"plan data.frame st_plan_rebuild(...) columns: level, path, reason, latest_version_before. rebuild_fun Optional function called : rebuild_fun(path, parents) -> list(x=..., format=?, metadata=?, code=?, code_label=?). omitted (NULL), st_rebuild() look registered builder path (st_register_builder()). dry_run TRUE, write anything; just report happen.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_rebuild.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rebuild artifacts from a plan (level order) — st_rebuild","text":"Invisibly, data.frame build results (status, version_id, msg).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_builder.html","id":null,"dir":"Reference","previous_headings":"","what":"Register a builder for an artifact path — st_register_builder","title":"Register a builder for an artifact path — st_register_builder","text":"\"builder\" knows (re)create artifact. called st_rebuild() fun(path, parents) must return list:","code":"list(     x = <object to save>,           # required     format = NULL,                  # optional (\"qs2\", \"rds\", ...)     metadata = list(),              # optional, merged into sidecar     code = NULL,                    # optional (function/expr/character)     code_label = NULL               # optional (short description)   )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_builder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Register a builder for an artifact path — st_register_builder","text":"","code":"st_register_builder(path, fun, name = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_builder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Register a builder for an artifact path — st_register_builder","text":"path Character path builder produces (exact match). fun Function signature function(path, parents). name Optional label can register multiple builders per path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_builder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Register a builder for an artifact path — st_register_builder","text":"Invisibly TRUE.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":null,"dir":"Reference","previous_headings":"","what":"Register or override a format handler — st_register_format","title":"Register or override a format handler — st_register_format","text":"Public function allows users register new format handler override existing one. Handlers must functions expected signatures documented .","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Register or override a format handler — st_register_format","text":"","code":"st_register_format(name, read, write, extensions = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Register or override a format handler — st_register_format","text":"name Character scalar: format name (e.g. \"qs2\", \"rds\"). read Function function(path, ...) returning R object. write Function function(object, path, ...) writes object path. extensions Optional character vector file extensions (e.g. c(\"qs\",\"qs2\")) map format; case-insensitive; without dots.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Register or override a format handler — st_register_format","text":"Invisibly returns TRUE success.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Register or override a format handler — st_register_format","text":"","code":"st_register_format(   \"txt\",   read  = function(p, ...) readLines(p, ...),   write = function(x, p, ...) writeLines(x, p, ...),   extensions = \"txt\" ) #> ✔ Registered format txt #>   extensions: .txt"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_sanitize_for_hash.html","id":null,"dir":"Reference","previous_headings":"","what":"Sanitize object prior to hashing — st_sanitize_for_hash","title":"Sanitize object prior to hashing — st_sanitize_for_hash","text":"tabular data want hashing depend data/frame content, volatile data.table internals (e.g. .internal.selfref) differing row name representations. Strategy: x data.table: coerce plain data.frame (drops DT internals). x data.frame (including coerced DT): enforce deterministic row.names via .set_row_names(NROW(x)). Record original class st_original_format loader can restore .","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_sanitize_for_hash.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sanitize object prior to hashing — st_sanitize_for_hash","text":"","code":"st_sanitize_for_hash(x)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_sanitize_for_hash.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sanitize object prior to hashing — st_sanitize_for_hash","text":"Non-tabular objects returned unchanged (attribute normalization handles subsequently). NOTE: returned object shallow copy; column data duplicated.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save.html","id":null,"dir":"Reference","previous_headings":"","what":"Save an R object to disk with metadata & versioning (atomic move) — st_save","title":"Save an R object to disk with metadata & versioning (atomic move) — st_save","text":"Save R object disk metadata & versioning (atomic move)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save an R object to disk with metadata & versioning (atomic move) — st_save","text":"","code":"st_save(   x,   file,   format = NULL,   metadata = list(),   code = NULL,   parents = NULL,   code_label = NULL,   pk = NULL,   domain = NULL,   unique = TRUE,   ... )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save an R object to disk with metadata & versioning (atomic move) — st_save","text":"x object save file destination path (character st_path) format optional format override (\"qs2\" | \"rds\" | \"csv\" | \"fst\" | \"json\") metadata named list extra metadata (merged sidecar) code Optional function/expression/character whose hash stored code_hash. parents Optional list parent descriptors: list(list(path = \"\", version_id = \"\"), ...). code_label Optional short label/description producing code (humans). pk optional character vector primary-key columns (tables) domain optional character scalar vector label(s) dataset unique logical; enforce uniqueness pk save time (default TRUE) ... forwarded format writer","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save an R object to disk with metadata & versioning (atomic move) — st_save","text":"invisibly, list path, metadata, version_id (skipped=TRUE)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save_part.html","id":null,"dir":"Reference","previous_headings":"","what":"Save a single partition (uses st_save under the hood) — st_save_part","title":"Save a single partition (uses st_save under the hood) — st_save_part","text":"Save single partition (uses st_save hood)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save_part.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save a single partition (uses st_save under the hood) — st_save_part","text":"","code":"st_save_part(   x,   base,   key,   code = NULL,   parents = NULL,   code_label = NULL,   format = NULL,   ... )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save_part.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save a single partition (uses st_save under the hood) — st_save_part","text":"x Object save base Base dir partitions key Named list scalar values (e.g., list(country=\"US\", year=2025)) code, parents, code_label, format, ... Passed st_save()","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save_part.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save a single partition (uses st_save under the hood) — st_save_part","text":"invisibly, list(path=..., version_id=...)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_should_save.html","id":null,"dir":"Reference","previous_headings":"","what":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","title":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","text":"Decide save proceed given current st_opts() Uses versioning policy code-change rule.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_should_save.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","text":"","code":"st_should_save(path, x = NULL, code = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_should_save.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","text":"path Artifact path disk. x Current -memory object (content comparison). code Optional function/expression/character (code comparison).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_should_save.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","text":"list(save = , reason = , latest_version_id = )","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_versions.html","id":null,"dir":"Reference","previous_headings":"","what":"List versions for an artifact path — st_versions","title":"List versions for an artifact path — st_versions","text":"Return table recorded versions artifact identified path catalog. data.table available result data.table; otherwise base data.frame returned. table contains one row per recorded version columns described . Rows ordered created_at descending.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_versions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List versions for an artifact path — st_versions","text":"","code":"st_versions(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_versions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List versions for an artifact path — st_versions","text":"path file directory path","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_versions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List versions for an artifact path — st_versions","text":"data.frame data.table columns: version_id Character version identifier. artifact_id Character artifact identifier (hashed). content_hash Character content hash version (may NA). code_hash Character code hash version (may NA). size_bytes Numeric size stored artifact bytes. created_at Character ISO8601 timestamp version recorded. sidecar_format Character sidecar format present: \"json\", \"qs2\", \"\", \"none\". empty table returned versions exist given path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_with_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","title":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","text":"Attach primary-key metadata data.frame setting attribute stamp_pk normalized pk list returned st_pk(). modify -disk sidecars; -memory convenience.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_with_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","text":"","code":"st_with_pk(x, keys)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_with_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","text":"x Data.frame annotate. keys Character vector column names making primary key.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_with_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","text":"input data.frame attribute stamp_pk set.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_write_parts.html","id":null,"dir":"Reference","previous_headings":"","what":"Auto-partition and save a dataset (Hive-style) — st_write_parts","title":"Auto-partition and save a dataset (Hive-style) — st_write_parts","text":"Splits data.frame/data.table partition columns saves partition separate file using Hive-style directory structure. Eliminates manual looping splitting logic.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_write_parts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auto-partition and save a dataset (Hive-style) — st_write_parts","text":"","code":"st_write_parts(   x,   base,   partitioning,   code = NULL,   parents = NULL,   code_label = NULL,   format = NULL,   pk = NULL,   domain = NULL,   unique = TRUE,   .progress = NULL,   ... )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_write_parts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auto-partition and save a dataset (Hive-style) — st_write_parts","text":"x Data.frame data.table partition save base Base directory partitions (e.g., \"data/welfare_parts\") partitioning Character vector column names partition (e.g., c(\"country\", \"year\", \"reporting_level\")) code, parents, code_label, format, ... Passed st_save() partition pk Optional primary key columns (passed st_save()) domain Optional domain label(s) (passed st_save()) unique Logical; enforce PK uniqueness save time (default TRUE) .progress Logical; show progress bar partitions (default TRUE >10 parts)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_write_parts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auto-partition and save a dataset (Hive-style) — st_write_parts","text":"Invisibly, data.frame columns: partition_key: list-column key values path: file path version_id: version identifier n_rows: number rows partition","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_write_parts.html","id":"performance","dir":"Reference","previous_headings":"","what":"Performance","title":"Auto-partition and save a dataset (Hive-style) — st_write_parts","text":"large datasets many partitions, function uses data.table's split efficiency available. Progress reporting can disabled .progress = FALSE.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_write_parts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auto-partition and save a dataset (Hive-style) — st_write_parts","text":"","code":"if (FALSE) { # \\dontrun{ # Create sample data welfare <- data.frame(   country = rep(c(\"USA\", \"CAN\"), each = 100),   year = rep(2020:2021, each = 50),   reporting_level = sample(c(\"national\", \"urban\"), 200, replace = TRUE),   value = rnorm(200) )  # Auto-partition and save st_write_parts(   welfare,   base = \"data/welfare_parts\",   partitioning = c(\"country\", \"year\", \"reporting_level\"),   code_label = \"welfare_partition\" )  # Result: files saved to: #   data/welfare_parts/country=USA/year=2020/reporting_level=national/part.qs2 #   data/welfare_parts/country=USA/year=2020/reporting_level=urban/part.qs2 #   ... etc } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/stamp-format-helpers.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal format handlers for stamp — stamp-format-helpers","title":"Internal format handlers for stamp — stamp-format-helpers","text":"Write x path using qs2 APIs. Errors .pkg qs2 package installed required entrypoints unavailable. Read object path using qs2 APIs. Errors .pkg qs2 package installed required entrypoints unavailable.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/stamp-format-helpers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal format handlers for stamp — stamp-format-helpers","text":"","code":".st_write_qs2(x, path, ...)  .st_read_qs2(path, ...)"},{"path":"https://randrescastaneda.github.io/stamp/reference/stamp-format-helpers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal format handlers for stamp — stamp-format-helpers","text":"x R object save. path Destination file path. ... Additional arguments passed underlying writer/reader.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/stamp-format-helpers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal format handlers for stamp — stamp-format-helpers","text":"Invisibly returns underlying writer returns. R object read path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/stamp-package.html","id":null,"dir":"Reference","previous_headings":"","what":"stamp: Reproducible Artifact Store with Sidecars, Versions, and Partitions — stamp-package","title":"stamp: Reproducible Artifact Store with Sidecars, Versions, and Partitions — stamp-package","text":"Stamp saves R objects sidecar metadata (hashes, provenance, PKs), keeps version history, prunes old versions, supports Hive-style partitions.","code":""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/reference/stamp-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"stamp: Reproducible Artifact Store with Sidecars, Versions, and Partitions — stamp-package","text":"Maintainer: R.Andres Castaneda acastanedaa@worldbank.org (ORCID) Authors: Diana C. Garcia Rojas dgarciarojas@worldbank.org (ORCID)","code":""},{"path":[]},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"format-handling-qs-vs-qs2-0-0-6","dir":"Changelog","previous_headings":"Breaking Changes","what":"Format Handling: qs vs qs2","title":"stamp 0.0.6","text":".qs files use qs package (qs::qread / qs::qsave) .qs2 files use qs2 package (qs2::qs_read / qs2::qs_save) automatic fallback qs2 qs qs2 installed Operations requiring missing package abort clear error message Install qs2 explicitly need .qs2 format support Tests require qs2 now skip gracefully package unavailable","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"extension-mapping-0-0-6","dir":"Changelog","previous_headings":"Breaking Changes","what":"Extension Mapping","title":"stamp 0.0.6","text":"Centralized extension--format mapping .st_extmap_defaults table Added maintainer helpers: st_extmap_defaults() st_extmap_report() Extension mapping now explicit documented easier maintenance","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"internal-changes-0-0-6","dir":"Changelog","previous_headings":"","what":"Internal Changes","title":"stamp 0.0.6","text":"Removed qs2→qs fallback logic format registry /O functions Format handlers .st_formats_env now independently check required packages Improved error messages format-specific packages missing","code":""},{"path":[]},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"version-loading-0-0-5","dir":"Changelog","previous_headings":"Major Features","what":"Version Loading","title":"stamp 0.0.5","text":"version = NULL 0 loads latest version (default behavior) version = -1, -2, ... loads relative versions (previous, two back, etc.) version = \"version_id\" loads specific version ID version = \"select\", \"pick\", \"choose\" shows interactive menu console Interactive version selection menu displays timestamps, file sizes, version IDs New internal function .st_resolve_version() handles version resolution logic","code":""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"timestamp-precision-0-0-5","dir":"Changelog","previous_headings":"Bug Fixes & Improvements","what":"Timestamp Precision","title":"stamp 0.0.5","text":"Resolves ordering issues multiple versions saved within second Format: \"2025-10-30T15:42:07.123456Z\" (backward compatible old format) Ensures reliable version ordering rapid-fire save scenarios (e.g., automated pipelines) Updated .st_now_utc() use microsecond precision Updated .st_version_id() handle fractional seconds timestamps Interactive menu timestamp parser handles old (seconds) new (microseconds) formats","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"data-loading-0-0-5","dir":"Changelog","previous_headings":"Bug Fixes & Improvements","what":"Data Loading","title":"stamp 0.0.5","text":"st_load_version() now properly cleans loaded data, removing internal attributes (st_original_format, stamp_sanitized) restoring data.table class appropriate Consistent cleanup behavior st_load() st_load_version()","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"documentation-0-0-5","dir":"Changelog","previous_headings":"","what":"Documentation","title":"stamp 0.0.5","text":"Added vignette section demonstrating version loading workflows Examples showing interactive version selection relative version indexing Updated documentation st_load() comprehensive @param version details","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"stamp-005-1","dir":"Changelog","previous_headings":"","what":"stamp 0.0.5","title":"stamp 0.0.5","text":"add ability load specific versions via st_load(version=...) improve timestamp precision microseconds avoid ordering issues versioning update st_load_version() clean loaded data properly","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"stamp-004","dir":"Changelog","previous_headings":"","what":"stamp 0.0.4","title":"stamp 0.0.4","text":"add normalization attributes Sanitize data.tables consistent hashing improve logic st_hash_obj() Avoid redundancies make efficient use st_hash_obj()","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"stamp-003","dir":"Changelog","previous_headings":"","what":"stamp 0.0.3","title":"stamp 0.0.3","text":"standardize helpers use data.table Add get started vignette Add builders plan vignette","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"stamp-002","dir":"Changelog","previous_headings":"","what":"stamp 0.0.2","title":"stamp 0.0.2","text":"first version share","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"stamp-001","dir":"Changelog","previous_headings":"","what":"stamp 0.0.1","title":"stamp 0.0.1","text":"first stable version without testing vignettes Initial CRAN submission.","code":""}]

[{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"key-concepts","dir":"Articles","previous_headings":"","what":"Key concepts","title":"Builders, Plans, and Rebuilds","text":"Builder: function registered st_register_builder(path, builder_fn). Signature: function(path, parents). must return list least: x: object save code: producing function(s) used compute x (used compute code_hash) optional code_label: short tag used sidecars Plan: result st_plan_rebuild() inspects recorded parents, code_hash values artifact presence. describes actions required bring targets --date. Rebuild: executing plan st_rebuild(plan). st_rebuild() calls registered builders st_save() produced artifact, recording new versions sidecars.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"minimal-example-single-target","dir":"Articles","previous_headings":"","what":"Minimal example (single-target)","title":"Builders, Plans, and Rebuilds","text":"","code":"# Suppose we have a summary target path summary_path <- \"outputs/welfare_summary.qs2\"  # Register a simple builder that loads parents and returns x+code st_register_builder(summary_path, function(path, parents) {   # Load welfare parents (illustrative — adapt to your parents layout)   welfare_paths <- vapply(     parents,     function(p) grepl(\"welfare\", p$path),     logical(1)   )   welfare_list <- lapply(parents[welfare_paths], function(p) st_load(p$path))    # Load macros (shared parents)   cpi_tbl <- st_load(\"data/macro/cpi.qs2\")   gdp_tbl <- st_load(\"data/macro/gdp.qs2\")   pop_tbl <- st_load(\"data/macro/population.qs2\")    # call a pure worker that accepts pre-loaded inputs   out <- bar(welfare_list, cpi_tbl, gdp_tbl, pop_tbl)    list(     x = out,     code = list(bar = bar),     code_label = \"aggregate_welfare\"   ) })  # Inspect plan (strict mode is conservative) plan <- st_plan_rebuild(   targets = summary_path,   include_targets = TRUE,   mode = \"strict\" ) plan  # Run only if you're ready # st_rebuild(plan)"},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"multi-function-code-metadata","dir":"Articles","previous_headings":"","what":"Multi-function code metadata","title":"Builders, Plans, and Rebuilds","text":"target depends multiple functions (e.g. bar() calls helpers h1() h2()), include explicitly code st_save() computes combined hash changes helper changes: ensures st_is_stale() plan computation detect code changes across whole chain.","code":"# Good: include all contributing functions st_save(   x,   summary_path,   pk = c(\"country\", \"year\"),   parents = parents,   code = list(bar = bar, h1 = h1, h2 = h2) )"},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"partitioned-targets-and-partial-rebuilds","dir":"Articles","previous_headings":"","what":"Partitioned targets and partial rebuilds","title":"Builders, Plans, and Rebuilds","text":"Builders can produce partitioned outputs can register many builders — one per partition — enable targeted re-computation. Two patterns: Parent-driven builders: builder receives parents loads parents needs. simple parents explicit named sidecar. Directory-driven builders: builder identifies partition key path argument computes output key (see vignettes/stamp.Rmd end--end example). Example: register partitioned builder per-key summaries (illustrative): macro like CPI changes COL 2012, st_plan_rebuild() mark partitioned targets stale st_rebuild() execute registered builders required.","code":"summary_parts_dir <- \"outputs/summary_parts\"  st_register_builder(   fs::path(     summary_parts_dir,     \"country=COL/year=2012/reporting_level=urban/out.qs2\"   ),   function(path, parents) {     # parse key from path or use parents to find the matching welfare partition     key <- list(country = \"COL\", year = 2012L, reporting_level = \"urban\")      # load only matching partition + macros     w <- st_load(st_part_path(\"data/welfare_parts\", key))     cpi <- st_load(\"data/macro/cpi.qs2\")[       country == key$country &         year == key$year &         reporting_level == key$reporting_level     ]     gdp <- st_load(\"data/macro/gdp.qs2\")[       country == key$country & year == key$year     ]      out <- bar(       list(w),       cpi,       gdp,       st_load(\"data/macro/population.qs2\")[         country == key$country &           year == key$year &           reporting_level == key$reporting_level       ]     )      list(x = out, code = list(bar = bar), code_label = \"partition_summary\")   } )"},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"modes-strict-vs-relaxed","dir":"Articles","previous_headings":"","what":"Modes: strict vs relaxed","title":"Builders, Plans, and Rebuilds","text":"mode = \"strict\" treats missing parents mismatched code hashes conservatively — prefer correctness. mode = \"relaxed\" may skip checks avoid unnecessary recomputation noisy environments; use caution.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"tips-best-practices","dir":"Articles","previous_headings":"","what":"Tips & best practices","title":"Builders, Plans, and Rebuilds","text":"Prefer pure worker functions accept inputs arguments. makes testing registration easier. Register builders use parents argument; avoid global state possible. Include helper functions code metadata relevant change invalidates dependent artifacts. Keep builders deterministic side-effect free (don’t write inside builder; instead return x let st_rebuild() call st_save()).","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"try-it-locally","dir":"Articles","previous_headings":"","what":"Try it locally","title":"Builders, Plans, and Rebuilds","text":"try examples interactively, set eval = TRUE setup chunk run examples inside interactive R session. Use short root_dir avoid Windows PATH length issues.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/builders-plans.html","id":"appendix-example-plan-interpretation","dir":"Articles","previous_headings":"","what":"Appendix: example plan interpretation","title":"Builders, Plans, and Rebuilds","text":"plan list--lists; entry includes target (path), reason (parent_changed, code_changed, missing) builder info. Inspect plan filter reorder actions calling st_rebuild(). Example (pseudo-inspection):","code":"plan <- st_plan_rebuild(targets = summary_path, include_targets = TRUE) # Show targets that are stale Filter(function(x) x$reason != \"uptodate\", plan)"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"recommended-options","dir":"Articles","previous_headings":"","what":"Recommended options","title":"Hashing, Change Detection and Versions","text":"","code":"st_opts_reset() st_opts(   versioning = \"content\", # skip write when content unchanged   code_hash = TRUE, # store code hash when 'code=' is provided to st_save()   store_file_hash = TRUE, # compute & store file hash after write   verify_on_load = TRUE, # verify content on load (warn on mismatch)   meta_format = \"both\" # write JSON + QS2 sidecars ) ## ✔ stamp options updated ##   versioning = \"content\", code_hash = \"TRUE\", store_file_hash = \"TRUE\", ##   verify_on_load = \"TRUE\", meta_format = \"both\""},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"save-with-hashes-and-skip-if-content-identical","dir":"Articles","previous_headings":"","what":"Save with hashes (and skip if content identical)","title":"Hashing, Change Detection and Versions","text":"snippet stamp serializes x deterministic way computes content hash. content hash (provided) code hash match stored metadata, new version created versioning = \"content\". Note: first write always create artifact sidecar(s). see first write skipped, check path passed st_save() exactly matches subsequent calls. change content (change code), new version recorded: Policy: design, changing code= pass st_save() creates new version even x identical. makes code provenance explicit. short practical pattern: Pass transformation code st_save(..., code = <function expression>) stamp can record code hash. Use st_changed() st_should_save() cheaply decide whether run expensive computations calling st_save().","code":"root <- tempdir() st_init(root) ## ✔ stamp initialized ##   root: /tmp/Rtmpgh9PrU ##   state: /tmp/Rtmpgh9PrU/.stamp p <- fs::path(root, \"demo.qs\") x <- data.frame(a = 1:3)  # First write: creates artifact + sidecars + catalog entry st_save(x, p, code = function(z) z) ## ✔ Saved [qs2] → /tmp/Rtmpgh9PrU/demo.qs @ ## version 6917955e8dae065f # Second write, same content & same code: skipped (no new version) st_save(x, p, code = function(z) z) ## ✔ Skip save (reason: no_change_policy) for ## /tmp/Rtmpgh9PrU/demo.qs nrow(st_versions(p)) # should be 1 ## [1] 1 x2 <- transform(x, a = a + 1L) st_save(x2, p, code = function(z) z) ## ✔ Saved [qs2] → /tmp/Rtmpgh9PrU/demo.qs @ ## version 5099588aa66d7dcd nrow(st_versions(p)) # now 2 ## [1] 2 st_latest(p) # latest version id (string) ## [1] \"5099588aa66d7dcd\""},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"inspect-sidecars-metadata","dir":"Articles","previous_headings":"","what":"Inspect sidecars & metadata","title":"Hashing, Change Detection and Versions","text":"Explanation: content_hash stable hash R object written (via st_hash_obj()). code_hash recorded provide code= st_save() (via st_hash_code()). file_hash computed file write (store_file_hash = TRUE) can used detect external file tampering. content_hash comes st_hash_obj(x) code_hash comes st_hash_code(code) supplied code= file_hash optional (post-write) used verify load","code":"meta <- st_read_sidecar(p) meta[c(   \"format\",   \"created_at\",   \"size_bytes\",   \"content_hash\",   \"code_hash\",   \"file_hash\" )] ## $format ## [1] \"qs2\" ##  ## $created_at ## [1] \"2025-11-12T22:22:03Z\" ##  ## $size_bytes ## [1] 154 ##  ## $content_hash ## [1] \"f05f2ec030741db5\" ##  ## $code_hash ## [1] \"488e8fa49c740261\" ##  ## $file_hash ## [1] \"2b7d70aa0270eaec\""},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"change-detection-without-writing","dir":"Articles","previous_headings":"","what":"Change detection (without writing)","title":"Hashing, Change Detection and Versions","text":"Use expensive work, decide whether recompute. call st_changed() st_changed_reason() avoid performing file writes. helpers ideal guards inside functions compute expensive results necessary: Example pattern inside pipeline function:","code":"x_same <- x2 x_new <- transform(x2, a = a + 10L)  st_changed(p, x = x_same, code = function(z) z) ## $changed ## [1] FALSE ##  ## $reason ## [1] \"no_change\" ##  ## $details ## $details$content_changed ## [1] FALSE ##  ## $details$code_changed ## [1] FALSE ##  ## $details$file_changed ## [1] FALSE st_changed_reason(p, x = x_same, code = function(z) z) # \"no_change\" ## [1] \"no_change\" st_changed(p, x = x_new, code = function(z) z) ## $changed ## [1] TRUE ##  ## $reason ## [1] \"content\" ##  ## $details ## $details$content_changed ## [1] TRUE ##  ## $details$code_changed ## [1] FALSE ##  ## $details$file_changed ## [1] FALSE st_changed_reason(p, x = x_new, code = function(z) z) # \"content\" ## [1] \"content\" st_should_save(p, x = x_same, code = function(z) z) # recommends skip ## $save ## [1] FALSE ##  ## $reason ## [1] \"no_change_policy\" st_should_save(p, x = x_new, code = function(z) z) # recommends save ## $save ## [1] TRUE ##  ## $reason ## [1] \"content\" if (st_should_save(p, x = out, code = my_transform)$save) {   st_save(out, p, code = my_transform) } else {   message(\"Skipping write; content and code unchanged\") }"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"loading-specific-versions","dir":"Articles","previous_headings":"","what":"Loading specific versions","title":"Hashing, Change Detection and Versions","text":"st_versions() returns table version metadata. row includes version_id, created_at, snapshot sidecar fields available commit time. Use st_load_version() restore artifact version.","code":"vids <- st_versions(p) head(vids) ##          version_id      artifact_id     content_hash        code_hash ##              <char>           <char>           <char>           <char> ## 1: 6917955e8dae065f 82a59d6c6c68ec0b d73e0bf1cb9d8dc5 488e8fa49c740261 ## 2: 5099588aa66d7dcd 82a59d6c6c68ec0b f05f2ec030741db5 488e8fa49c740261 ##    size_bytes           created_at sidecar_format ##         <num>               <char>         <char> ## 1:        201 2025-11-12T22:22:03Z           both ## 2:        154 2025-11-12T22:22:03Z           both vid_latest <- st_latest(p) obj_latest <- st_load_version(p, vid_latest) ## ✔ Loaded ← /tmp/Rtmpgh9PrU/demo.qs @ ## 5099588aa66d7dcd [qs2] # Load an older version by id if (nrow(vids) > 1L) {   vid_old <- vids$version_id[[nrow(vids)]]   obj_old <- st_load_version(p, vid_old) } ## ✔ Loaded ← /tmp/Rtmpgh9PrU/demo.qs @ ## 5099588aa66d7dcd [qs2]"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"where-are-versions-stored","dir":"Articles","previous_headings":"Loading specific versions","what":"Where are versions stored?","title":"Hashing, Change Detection and Versions","text":"Snapshots live .stamp/versions/<relative-path>/<version_id>/. snapshot dir contains: artifact — copy saved file sidecar.json /sidecar.qs2 — depending meta_format Additionally snapshot may include parents.json file capturing committed lineage artifacts; created stamp records explicit parents commit. Sidecar metadata (stmeta/) primary local source used decide whether write, snapshots long-term committed record.","code":"p <- fs::path(root, \"demo.qs\") x <- data.frame(a = 1:5)  # Write once to create a version snapshot st_save(x, p, code = function(z) z) ## ✔ Saved [qs2] → /tmp/Rtmpgh9PrU/demo.qs @ ## version cf5bd75dfad34fa7 # Now list the versions tree vroot <- stamp:::.st_versions_root() fs::dir_tree(vroot, recurse = TRUE, all = TRUE) ## /tmp/Rtmpgh9PrU/.stamp/versions ## └── demo.qs ##     ├── 5099588aa66d7dcd ##     │   ├── artifact ##     │   ├── sidecar.json ##     │   └── sidecar.qs2 ##     ├── 6917955e8dae065f ##     │   ├── artifact ##     │   ├── sidecar.json ##     │   └── sidecar.qs2 ##     └── cf5bd75dfad34fa7 ##         ├── artifact ##         ├── sidecar.json ##         └── sidecar.qs2"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"integrity-checks-on-load-optional","dir":"Articles","previous_headings":"","what":"Integrity checks on load (optional)","title":"Hashing, Change Detection and Versions","text":"verify_on_load = TRUE content_hash exists sidecar, st_load() recomputes object’s hash warns differs (indicating file changed outside stamp). verify_on_load = TRUE, st_load() recomputes st_hash_obj() compares content_hash recorded sidecar snapshot. mismatch usually means file modified outside stamp re-saving recommended.","code":"invisible(st_load(p)) # triggers optional verify; warns on mismatch ## Warning: No primary key recorded for /tmp/Rtmpgh9PrU/demo.qs. ## ℹ You can add one with `st_add_pk()`. ## ✔ Loaded [qs2] ← /tmp/Rtmpgh9PrU/demo.qs"},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"troubleshooting","dir":"Articles","previous_headings":"","what":"Troubleshooting","title":"Hashing, Change Detection and Versions","text":"Q: first st_save() skipped st_versions(p) 0. : first write never skipped. Ensure ’re using current st_should_save() returns save = TRUE artifact missing sidecar missing. Q: st_changed_reason() says \"missing_meta\". : artifact exists sidecar removed unreadable. Call st_save(x, p, code = ...) ; re-materialize metadata record version. Q: Changing code= didn’t create new version. : design, code change create new version. Confirm st_opts(\"code_hash\", .get = TRUE) TRUE passed code= consistently (e.g., function literal, different object pointers identical functions rare cases). Q: CSV round-trips aren’t byte-identical. : data.table::fread/fwrite may coerce types (e.g., integers vs doubles). Compare relaxed checks coerce types comparison. Q: see warning load hash mismatch. : verify_on_load = TRUE, stamp recomputes object hash warns differs sidecar’s content_hash. indicates file modified outside stamp sidecar stale. Re-save repair. Q: qs2 isn’t installed. : qs2 preferred. unavailable, stamp falls back qs read/write \"qs2\" handler. Install qs2 best performance. Q: Sidecars appearing. : Check st_opts(\"meta_format\", .get = TRUE) — set \"json\", \"qs2\", \"\". Sidecars written stmeta/ next artifact. Q: Versions aren’t expect. : Version snapshots live .stamp/versions/<relative-path>/<version_id>/. Use code snippet explore tree.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/hashing-and-versions.html","id":"tips-conventions","dir":"Articles","previous_headings":"","what":"Tips & conventions","title":"Hashing, Change Detection and Versions","text":"Keep versioning = \"content\" reproducible artifacts; use \"timestamp\" want new version every save; \"\" skip versioning entirely. Use st_changed() / st_should_save() gate expensive computation inside functions. Sidecars: prefer meta_format = \"json\" readability, \"qs2\" compactness, \"\" redundancy. reading / next steps: See lineage-rebuilds vignette committed parents sidecar parents interact st_rebuild(). Consider recording code= critical data transformations provenance preserved even object content identical.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"setup-a-tiny-graph-a-ba-cb","dir":"Articles","previous_headings":"","what":"Setup a tiny graph A → B(A) → C(B)","title":"Lineage and Rebuilds","text":"Note: saves artifact sidecar (stmeta/) snapshots .stamp/versions/. Committed parents vs sidecar example short interactive example shows difference committed parents (stored inside version snapshot) light-weight sidecar parents next artifact file. deliberately remove committed snapshot B simulate case sidecar remains; st_lineage() still return immediate parents (level 1) reading sidecar, recursive walking beyond level 1 uses snapshot-backed parents.","code":"st_opts_reset() st_opts(   versioning = \"content\",   code_hash = TRUE,   store_file_hash = TRUE,   verify_on_load = TRUE,   meta_format = \"both\" ) ## ✔ stamp options updated ##   versioning = \"content\", code_hash = \"TRUE\", store_file_hash = \"TRUE\", ##   verify_on_load = \"TRUE\", meta_format = \"both\" root <- tempdir() st_init(root) ## ✔ stamp initialized ##   root: /tmp/RtmpQVDDDC ##   state: /tmp/RtmpQVDDDC/.stamp # A pA <- fs::path(root, \"A.qs\") xA <- data.frame(a = 1:3) st_save(xA, pA, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpQVDDDC/A.qs @ version ## 0280e9cf3b3146e8 # B depends on A pB <- fs::path(root, \"B.qs\") xB <- transform(xA, b = a * 2) st_save(   xB,   pB,   code = function(z) z,   parents = list(list(path = pA, version_id = st_latest(pA))) ) ## ✔ Saved [qs2] → /tmp/RtmpQVDDDC/B.qs @ version ## 710efde41363cadc # C depends on B pC <- fs::path(root, \"C.qs\") xC <- transform(xB, c = b + 1L) st_save(   xC,   pC,   code = function(z) z,   parents = list(list(path = pB, version_id = st_latest(pB))) ) ## ✔ Saved [qs2] → /tmp/RtmpQVDDDC/C.qs @ version ## 33e42b072a1a3094 # Remove committed snapshot for B to simulate a no-snapshot state vdir_b <- stamp:::.st_version_dir(pB, st_latest(pB)) if (fs::dir_exists(vdir_b)) {   fs::dir_delete(vdir_b) }  # Now st_info will show snapshot_dir = NA but sidecar present st_info(pB) ## $sidecar ## $sidecar$path ## [1] \"/tmp/RtmpQVDDDC/B.qs\" ##  ## $sidecar$format ## [1] \"qs2\" ##  ## $sidecar$created_at ## [1] \"2025-11-12T22:22:06Z\" ##  ## $sidecar$size_bytes ## [1] 216 ##  ## $sidecar$content_hash ## [1] \"57992c880141b360\" ##  ## $sidecar$code_hash ## [1] \"488e8fa49c740261\" ##  ## $sidecar$file_hash ## [1] \"3de32a31f5476755\" ##  ## $sidecar$code_label ## NULL ##  ## $sidecar$parents ##                   path       version_id ## 1 /tmp/RtmpQVDDDC/A.qs 0280e9cf3b3146e8 ##  ## $sidecar$attrs ## list() ##  ##  ## $catalog ## $catalog$latest_version_id ## [1] \"710efde41363cadc\" ##  ## $catalog$n_versions ## [1] 1 ##  ##  ## $snapshot_dir ## [1] NA ##  ## $parents ##                   path       version_id ## 1 /tmp/RtmpQVDDDC/A.qs 0280e9cf3b3146e8 # st_lineage will fall back to the sidecar for immediate parents (level 1) st_lineage(pB, depth = 1) ##   level           child_path    child_version          parent_path ## 1     1 /tmp/RtmpQVDDDC/B.qs 710efde41363cadc /tmp/RtmpQVDDDC/A.qs ##     parent_version ## 1 0280e9cf3b3146e8 # But recursive lineage (depth > 1) will only follow snapshot-backed parents # (no recursive walk available once snapshots are missing) st_lineage(pB, depth = 2) ##   level           child_path    child_version          parent_path ## 1     1 /tmp/RtmpQVDDDC/B.qs 710efde41363cadc /tmp/RtmpQVDDDC/A.qs ##     parent_version ## 1 0280e9cf3b3146e8"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"inspect-lineage","dir":"Articles","previous_headings":"","what":"Inspect lineage","title":"Lineage and Rebuilds","text":"","code":"# Immediate children of A (depth 1) st_children(pA, depth = 1) ## [1] level          child_path     child_version  parent_path    parent_version ## <0 rows> (or 0-length row.names) # Full lineage (parents of an artifact) st_lineage(pC, depth = Inf) ##   level           child_path    child_version          parent_path ## 1     1 /tmp/RtmpQVDDDC/C.qs 33e42b072a1a3094 /tmp/RtmpQVDDDC/B.qs ##     parent_version ## 1 710efde41363cadc"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"make-a-change-upstream-detect-staleness","dir":"Articles","previous_headings":"","what":"Make a change upstream & detect staleness","title":"Lineage and Rebuilds","text":"","code":"# Change A → new version xA2 <- transform(xA, a = a + 10L) st_save(xA2, pA, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpQVDDDC/A.qs @ version ## e69d7daffba2164c # Strict staleness st_is_stale(pB) # TRUE (B's recorded A version is now old) ## [1] FALSE st_is_stale(pC) # FALSE (C points to B, which hasn't changed yet) ## [1] FALSE"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"plan-rebuilds","dir":"Articles","previous_headings":"","what":"Plan rebuilds","title":"Lineage and Rebuilds","text":"Two strategies: strict: items whose recorded parent IDs differ parents’ current latest. propagate: assume targets change plan descendants BFS layers.","code":"# Strict: only B right now plan_strict <- st_plan_rebuild(pA, depth = Inf, mode = \"strict\") plan_strict ## [1] level                 path                  reason                ## [4] latest_version_before ## <0 rows> (or 0-length row.names) # Propagate: includes B (level 1) and C (level 2) plan <- st_plan_rebuild(pA, depth = Inf, mode = \"propagate\") plan ## [1] level                 path                  reason                ## [4] latest_version_before ## <0 rows> (or 0-length row.names)"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"register-builders-and-rebuild-in-level-order","dir":"Articles","previous_headings":"","what":"Register builders and rebuild in level order","title":"Lineage and Rebuilds","text":"Builders tiny functions produce artifact parents. receive (path, parents) return list least x = <object>. rebuilding B, C becomes strictly stale B changes later. can re-plan B keep propagating:","code":"# Clear any previous registry st_clear_builders() ## ✔ Cleared all registered builders # Register a builder for B: rebuild from A's committed version st_register_builder(pB, function(path, parents) {   # parents is list(list(path=..., version_id=...))   A <- st_load_version(parents[[1]]$path, parents[[1]]$version_id)   list(     x = transform(A, b = a * 2),     code = function(z) z,     code_label = \"B <- A * 2\"   ) }) ## ✔ Registered builder for /tmp/RtmpQVDDDC/B.qs ## (default) # Register a builder for C: rebuild from B's committed version st_register_builder(pC, function(path, parents) {   B <- st_load_version(parents[[1]]$path, parents[[1]]$version_id)   list(     x = transform(B, c = b + 1L),     code = function(z) z,     code_label = \"C <- B + 1\"   ) }) ## ✔ Registered builder for /tmp/RtmpQVDDDC/C.qs ## (default) # Dry run first (uses registered builders found by st_rebuild when rebuild_fun is NULL) st_rebuild(plan, dry_run = TRUE) ## ✔ Nothing to rebuild (empty plan). # Now actually rebuild (will use registered builders) res <- st_rebuild(plan, dry_run = FALSE) ## ✔ Nothing to rebuild (empty plan). res ## [1] level                 path                  reason                ## [4] latest_version_before status                version_id            ## [7] msg                   ## <0 rows> (or 0-length row.names) st_is_stale(pB) ## [1] FALSE st_is_stale(pC) ## [1] FALSE st_plan_rebuild(pB, depth = Inf, mode = \"propagate\") ##   level                 path           reason latest_version_before ## 1     1 /tmp/RtmpQVDDDC/C.qs upstream_changed      33e42b072a1a3094"},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"inspect-snapshots-on-disk","dir":"Articles","previous_headings":"","what":"Inspect snapshots on disk","title":"Lineage and Rebuilds","text":"Tip: st_info(path) summarizes sidecar, catalog status, latest snapshot dir, plus parsed parents.json committed snapshot (present).","code":"vroot <- stamp:::.st_versions_root() fs::dir_tree(vroot, recurse = TRUE, all = TRUE) ## /tmp/RtmpQVDDDC/.stamp/versions ## ├── A.qs ## │   ├── 0280e9cf3b3146e8 ## │   │   ├── artifact ## │   │   ├── sidecar.json ## │   │   └── sidecar.qs2 ## │   └── e69d7daffba2164c ## │       ├── artifact ## │       ├── sidecar.json ## │       └── sidecar.qs2 ## ├── B.qs ## └── C.qs ##     └── 33e42b072a1a3094 ##         ├── artifact ##         ├── parents.json ##         ├── sidecar.json ##         └── sidecar.qs2 st_info(pC) ## $sidecar ## $sidecar$path ## [1] \"/tmp/RtmpQVDDDC/C.qs\" ##  ## $sidecar$format ## [1] \"qs2\" ##  ## $sidecar$created_at ## [1] \"2025-11-12T22:22:06Z\" ##  ## $sidecar$size_bytes ## [1] 229 ##  ## $sidecar$content_hash ## [1] \"502fb8918e46e3de\" ##  ## $sidecar$code_hash ## [1] \"488e8fa49c740261\" ##  ## $sidecar$file_hash ## [1] \"385e81fdcbfab7ed\" ##  ## $sidecar$code_label ## NULL ##  ## $sidecar$parents ##                   path       version_id ## 1 /tmp/RtmpQVDDDC/B.qs 710efde41363cadc ##  ## $sidecar$attrs ## list() ##  ##  ## $catalog ## $catalog$latest_version_id ## [1] \"33e42b072a1a3094\" ##  ## $catalog$n_versions ## [1] 1 ##  ##  ## $snapshot_dir ## /tmp/RtmpQVDDDC/.stamp/versions/C.qs/33e42b072a1a3094 ##  ## $parents ## $parents[[1]] ## $parents[[1]]$path ## [1] \"/tmp/RtmpQVDDDC/B.qs\" ##  ## $parents[[1]]$version_id ## [1] \"710efde41363cadc\""},{"path":"https://randrescastaneda.github.io/stamp/articles/lineage-rebuilds.html","id":"takeaways","dir":"Articles","previous_headings":"Inspect snapshots on disk","what":"Takeaways","title":"Lineage and Rebuilds","text":"Use strict staleness detect objective mismatches. Use propagate planning build full downstream schedule. Keep builders small, pure, deterministic; make rebuilds trivial.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"initialize-a-project","dir":"Articles","previous_headings":"","what":"1. Initialize a project","title":"Setup and Basics","text":"st_init() prepares small internal state directory (default .stamp/) hold temporary files, logs, sidecars, version snapshots. Use temporary directory vignette examples saves snapshots isolated. Notes - Default state dir: .stamp/ (can override via st_init(state_dir = \"_stamp\")).","code":"# Use a private temp dir so the vignette is reproducible locally tdir <- fs::path_temp(\"stamp-vignette\") fs::dir_create(tdir) st_init(tdir) ## ✔ stamp initialized ##   root: /tmp/Rtmpq9ve47/stamp-vignette ##   state: /tmp/Rtmpq9ve47/stamp-vignette/.stamp # Inspect created structure fs::path(tdir, \".stamp\") |>   fs::dir_tree(recurse = TRUE, all = TRUE) ## /tmp/Rtmpq9ve47/stamp-vignette/.stamp ## ├── logs ## └── temp"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"options-st_opts","dir":"Articles","previous_headings":"","what":"2. Options (st_opts())","title":"Setup and Basics","text":"Global behavior controlled via st_opts(). Typical options use: meta_format: sidecars written. Allowed: \"json\", \"qs2\", \"\". default_format: format use none inferred path. versioning: controls whether saves create version snapshots (\"content\" vs \"timestamp\" vs `“”). Example: Use versioning control version snapshot recorded. default \"content\" mode records new version content/code changed; \"timestamp\" forces version every save (useful audit trails).","code":"# show defaults st_opts(.get = TRUE) ## $force_on_code_change ## [1] TRUE ##  ## $retain_versions ## [1] Inf ##  ## $versioning ## [1] \"content\" ##  ## $meta_format ## [1] \"json\" ##  ## $usetz ## [1] FALSE ##  ## $timeformat ## [1] \"%Y%m%d%H%M%S\" ##  ## $code_hash ## [1] TRUE ##  ## $default_format ## [1] \"qs2\" ##  ## $verify_on_load ## [1] FALSE ##  ## $store_file_hash ## [1] FALSE ##  ## $verbose ## [1] TRUE ##  ## $timezone ## [1] \"UTC\" ##  ## $require_pk_on_load ## [1] FALSE ##  ## $warn_missing_pk_on_load ## [1] TRUE # write both JSON and QS2 sidecars st_opts(meta_format = \"both\") ## ✔ stamp options updated ##   meta_format = \"both\" st_opts(\"meta_format\", .get = TRUE) ## [1] \"both\""},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"paths-and-format-registry","dir":"Articles","previous_headings":"","what":"3. Paths and format registry","title":"Setup and Basics","text":"st_path() wraps path string optionally carries explicit format hint. Format inference also maps known extensions (via internal registry). can extend registry st_register_format() add new format (e.g. Parquet). registry also map file extensions provide .","code":"p1 <- st_path(\"data/iris.qs2\") p2 <- st_path(\"data/mtcars.fst\", format = \"fst\") p1 ## <st_path> data/iris.qs2 [format=qs2] st_formats()  # built-in handlers: qs2, rds, csv, fst, json ## [1] \"csv\"  \"fst\"  \"json\" \"qs2\"  \"rds\""},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"save-load-atomic-with-sidecar-metadata","dir":"Articles","previous_headings":"","what":"4. Save & load (atomic, with sidecar metadata)","title":"Setup and Basics","text":"Use st_save() st_load() robust writes. st_save() performs atomic write (temp file move), writes sidecar metadata, — depending versioning — records version snapshot. st_save() accepts additional arguments useful provenance: code: function/expression whose hash recorded (via st_hash_code). parents: optional list parent descriptors (list(list(path=…, version_id=…), …)) record provenance. code_label: short human label producing code.","code":"x <- data.frame(a = 1:3, b = letters[1:3]) outdir <- fs::path_temp(\"stamp-output\") fs::dir_create(outdir)  res <- st_save(x, fs::path(outdir, \"example.qs2\"), metadata = list(description = \"toy\")) ## ✔ Saved [qs2] → /tmp/Rtmpq9ve47/stamp-output/example.qs2 @ version ##   03de66c05366d2ca res$path ## /tmp/Rtmpq9ve47/stamp-output/example.qs2 # load back (format auto-detected) y <- st_load(res$path) ## Warning: No primary key recorded for /tmp/Rtmpq9ve47/stamp-output/example.qs2. ## ℹ You can add one with `st_add_pk()`. ## ✔ Loaded [qs2] ← ## /tmp/Rtmpq9ve47/stamp-output/example.qs2 identical(x, y) ## [1] TRUE"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"sidecars-quick-metadata","dir":"Articles","previous_headings":"","what":"5. Sidecars (quick metadata)","title":"Setup and Basics","text":"Sidecars live stmeta/ sibling directory next artifact contain metadata path, format, created_at (UTC), size_bytes, content_hash, code_hash, code_label, parents (quick view). sidecar intended quick inspection storing metadata even version snapshot may recorded (e.g., versioning = \"content\" nothing changed). reproducible lineage rebuilds, st_save() writes snapshot .stamp/versions/ includes committed copies artifact parents.json.","code":"sc <- st_read_sidecar(res$path) str(sc) ## List of 11 ##  $ path        : chr \"/tmp/Rtmpq9ve47/stamp-output/example.qs2\" ##  $ format      : chr \"qs2\" ##  $ created_at  : chr \"2025-11-12T22:22:09Z\" ##  $ size_bytes  : int 214 ##  $ content_hash: chr \"6017305813f9d38e\" ##  $ code_hash   : NULL ##  $ file_hash   : NULL ##  $ code_label  : NULL ##  $ parents     : list() ##  $ attrs       : list() ##  $ description : chr \"toy\""},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"versions-lineage-and-inspection","dir":"Articles","previous_headings":"","what":"6. Versions, lineage, and inspection","title":"Setup and Basics","text":"package maintains simple catalog versions. Useful functions: st_versions(path) — list recorded versions artifact. st_latest(path) — get latest version id. st_load_version(path, version_id) — load specific recorded version. st_info(path) — quick inspection: returns current sidecar, catalog info, snapshot dir (present), parents (snapshot sidecar fallback). st_lineage(path, depth=1) — walk immediate recursive parents. Example demonstrates parents lineage (parents passed st_save): Notes behavior - sidecar always contains parents quick inspection. However, default versioning = \"content\" mode new committed snapshot (parents.json) created content code changed. vignette code deliberately saves upstream derived artifacts snapshot recorded.","code":"# upstream artifact in_path <- fs::path(outdir, \"upstream.qs\") st_save(data.frame(id=1:3), in_path) ## ✔ Saved [qs2] → /tmp/Rtmpq9ve47/stamp-output/upstream.qs @ version ##   fa1fa96b691e26f0 in_vid <- st_latest(in_path)  # derived artifact recording parent info out_path <- fs::path(outdir, \"derived.qs\") parents <- list(list(path = in_path, version_id = in_vid)) st_save(data.frame(id=1:3, v=10), out_path, parents = parents, code_label = \"multiply\") ## ✔ Saved [qs2] → /tmp/Rtmpq9ve47/stamp-output/derived.qs @ version ##   d02ce5b8ee49d1de st_info(out_path)$sidecar ## $path ## [1] \"/tmp/Rtmpq9ve47/stamp-output/derived.qs\" ##  ## $format ## [1] \"qs2\" ##  ## $created_at ## [1] \"2025-11-12T22:22:09Z\" ##  ## $size_bytes ## [1] 217 ##  ## $content_hash ## [1] \"4aa2ce534a41856b\" ##  ## $code_hash ## NULL ##  ## $file_hash ## NULL ##  ## $code_label ## [1] \"multiply\" ##  ## $parents ##                                       path       version_id ## 1 /tmp/Rtmpq9ve47/stamp-output/upstream.qs fa1fa96b691e26f0 ##  ## $attrs ## list() st_lineage(out_path, depth = 1) ##   level                              child_path    child_version ## 1     1 /tmp/Rtmpq9ve47/stamp-output/derived.qs d02ce5b8ee49d1de ##                                parent_path   parent_version ## 1 /tmp/Rtmpq9ve47/stamp-output/upstream.qs fa1fa96b691e26f0"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"primary-key-helpers-optional","dir":"Articles","previous_headings":"","what":"7. Primary-key helpers (optional)","title":"Setup and Basics","text":"can record primary-key (pk) artifact sidecar make easier identify rows later. Helpers: st_pk() — normalize/validate pk spec. st_add_pk(path, keys) — record pk artifact sidecar (optionally validate -disk content). st_inspect_pk(path) — read pk sidecar. st_with_pk(df, keys) st_get_pk() — -memory helpers. Example:","code":"st_add_pk(out_path, keys = c(\"id\")) ## ✔ stamp options updated ##   require_pk_on_load = \"FALSE\" ## Warning: No primary key recorded for /tmp/Rtmpq9ve47/stamp-output/derived.qs. ## ℹ You can add one with `st_add_pk()`. ## ✔ Loaded [qs2] ← /tmp/Rtmpq9ve47/stamp-output/derived.qs ## ✔ Recorded primary key for /tmp/Rtmpq9ve47/stamp-output/derived.qs --> id ## ✔ stamp options updated ##   require_pk_on_load = \"FALSE\" st_inspect_pk(out_path) ## [1] \"id\" # load and filter by pk using st_filter df <- st_load(out_path) ## ✔ Loaded [qs2] ← ## /tmp/Rtmpq9ve47/stamp-output/derived.qs st_filter(df, list(id = 1)) ##   id  v ## 1  1 10"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"retention-pruning","dir":"Articles","previous_headings":"","what":"8. Retention / pruning","title":"Setup and Basics","text":"control disk usage, st_prune_versions() prunes older version snapshots according retention policy. simplest call applies default project policy; can also pass policy use dry_run = TRUE preview.","code":"# dry-run to preview deletions for this artifact st_prune_versions(path = out_path, policy = 5, dry_run = TRUE)  # apply retention (non-dry) st_prune_versions(path = out_path, policy = list(n = 5, days = 30), dry_run = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/articles/setup-and-basics.html","id":"tips-and-conventions","dir":"Articles","previous_headings":"","what":"9. Tips and conventions","title":"Setup and Basics","text":"Prefer qs2 artifact storage speed/space, use JSON sidecars readability development. Use st_path() want explicit format hints code. Use st_info() st_lineage() inspect provenance; use st_versions() st_load_version() access historical snapshots. ’d like, can similarly update vignettes vignettes/ reflect current implementation add small unit-test-like examples.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"the-problem","dir":"Articles","previous_headings":"","what":"The Problem","title":"Stamp","text":"multiple input files produced different processes. want read, process, save derived artifacts capturing. Let’s simulate data folder structure:","code":"if (requireNamespace(\"pkgload\", quietly = TRUE)) {   pkgload::load_all(\".\") } else {   library(stamp) } #> ℹ Loading stamp library(data.table) set.seed(123)  # Create an isolated temporary root so all writes occur outside the package tree. # Use a short name to avoid long path issues on Windows (PATH_MAX = 260). root_dir <- fs::path_temp(\"s\") |>   fs::dir_create() old_wd <- setwd(root_dir) on.exit(setwd(old_wd), add = TRUE)  # Initialize stamp under this temp root st_init(root = root_dir) #> ✔ stamp initialized #>   root: /tmp/RtmpIaoNw2/s #>   state: /tmp/RtmpIaoNw2/s/.stamp  # Define subdirectories (they will be created as needed) welfare_dir <- fs::path(root_dir, \"data\", \"welfare\") macro_dir <- fs::path(root_dir, \"data\", \"macro\") population_dir <- macro_dir outputs_dir <- fs::path(root_dir, \"outputs\") |>   fs::dir_create() welfare_parts_dir <- fs::path(root_dir, \"data\", \"welfare_parts\") summary_parts_dir <- fs::path(root_dir, \"outputs\", \"summary_parts\")  fs::dir_create(c(welfare_dir, macro_dir, welfare_parts_dir, summary_parts_dir))  # Helper: list only data files with known extensions to avoid locks/sidecars data_files <- function(dir) {   f <- fs::dir_ls(dir, type = \"file\")   ext <- tolower(fs::path_ext(f))   allowed <- c(\"qs2\", \"qs\", \"rds\", \"csv\", \"fst\", \"json\")   f[ext %in% allowed] }"},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"harmonizing-economic-indicators-with-versioning-lineage","dir":"Articles","previous_headings":"The Solution","what":"Harmonizing Economic Indicators with Versioning & Lineage","title":"Stamp","text":"walk realistic data engineering scenario: several country/year micro datasets macro indicators must combined standardized output table. want: Consistent saving, versioning, timestamp metadata input artifact. Explicit primary keys (PK) recorded disk. derived summary table saved full lineage (parents listed). Demonstrating single input change propagates using st_is_stale(), st_plan_rebuild(), st_rebuild(). Adding new data (ARG 2015) observing minimal recomputation. Producing output using partitioned artifacts partial re-runs. Countries/years welfare (micro) data: COL2010, COL2012, MEX2010, MEX2015, PRY2011, PRY2014. Reporting levels: COL MEX: urban rural. PRY: national. Macro data (CPI, GDP, population) exist COL, MEX, PRY, BRA, ARG (2010–2015). CPI & population three reporting levels (national, urban, rural) every country-year.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"simulate-and-save-input-micro-data","dir":"Articles","previous_headings":"The Solution","what":"1. Simulate and Save Input Micro Data","title":"Stamp","text":"’ll create small synthetic micro datasets columns: country, year, reporting_level, hh_id, welfare, weight. call st_save() assigns version id (content differs) writes sidecar metadata including PK. Inspect one artifact:","code":"fs::dir_create(welfare_dir)  welfare_specs <- data.frame(   country = c(\"COL\", \"COL\", \"MEX\", \"MEX\", \"PRY\", \"PRY\"),   year = c(2010, 2012, 2010, 2015, 2011, 2014),   stringsAsFactors = FALSE )  mk_reporting <- function(cty) {   if (cty %in% c(\"COL\", \"MEX\")) c(\"urban\", \"rural\") else c(\"national\") }  simulate_welfare <- function(country, year) {   rl <- mk_reporting(country)   # 200 households per reporting level   dt_list <- lapply(rl, function(rlev) {     n <- 200L     data.table(       country = country,       year = year,       reporting_level = rlev,       hh_id = sprintf(\"%s_%s_%s_%03d\", country, year, rlev, seq_len(n)),       welfare = round(         rlnorm(n, meanlog = log(1000 + year) - 7, sdlog = 0.5),         2       ),       weight = runif(n, 0.5, 2)     )   })   rbindlist(dt_list) }  welfare_paths <- list() for (i in seq_len(nrow(welfare_specs))) {   row <- welfare_specs[i, ]   dt <- simulate_welfare(row$country, row$year)   fn <- fs::path(welfare_dir, sprintf(\"%s_%d.qs2\", row$country, row$year))   # Primary key columns include household id for uniqueness   st_save(     dt,     fn,     pk = c(\"country\", \"year\", \"reporting_level\", \"hh_id\"),     domain = \"welfare\"   )   welfare_paths[[length(welfare_paths) + 1]] <- fn } #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 @ version #>   7b77750f575ad522 #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 @ version #>   9a439df9a3a329dd #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 @ version #>   4b1ce9899efd10a3 #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 @ version #>   4aeb106e3c11f695 #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 @ version #>   f2911a8c8fe1bfc1 #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 @ version #>   de6f77e839f2f05b unlist(welfare_paths) #> [1] \"/tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2\" #> [2] \"/tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2\" #> [3] \"/tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2\" #> [4] \"/tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2\" #> [5] \"/tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2\" #> [6] \"/tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2\" st_info(fs::path(welfare_dir, \"COL_2010.qs2\")) #> $sidecar #> $sidecar$path #> [1] \"/tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2\" #>  #> $sidecar$format #> [1] \"qs2\" #>  #> $sidecar$created_at #> [1] \"2025-11-12T22:22:12Z\" #>  #> $sidecar$size_bytes #> [1] 4789 #>  #> $sidecar$content_hash #> [1] \"8d9d553d9d21b090\" #>  #> $sidecar$code_hash #> NULL #>  #> $sidecar$file_hash #> NULL #>  #> $sidecar$code_label #> NULL #>  #> $sidecar$parents #> list() #>  #> $sidecar$attrs #> list() #>  #> $sidecar$pk #> $sidecar$pk$keys #> [1] \"country\"         \"year\"            \"reporting_level\" \"hh_id\"           #>  #>  #> $sidecar$domain #> [1] \"welfare\" #>  #>  #> $catalog #> $catalog$latest_version_id #> [1] \"7b77750f575ad522\" #>  #> $catalog$n_versions #> [1] 1 #>  #>  #> $snapshot_dir #> /tmp/RtmpIaoNw2/s/.stamp/versions/data/welfare/COL_2010.qs2/7b77750f575ad522 #>  #> $parents #> list()"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"simulate-and-save-macro-data-cpi-gdp-population","dir":"Articles","previous_headings":"The Solution","what":"2. Simulate and Save Macro Data (CPI, GDP, Population)","title":"Stamp","text":"CPI & population reporting-level granular; GDP country-year . Version listing CPI:","code":"fs::dir_create(macro_dir)  years <- 2010:2015 countries_macro <- c(\"COL\", \"MEX\", \"PRY\", \"BRA\", \"ARG\") levels_all <- c(\"national\", \"urban\", \"rural\")  simulate_cpi <- function() {   out <- CJ(     country = countries_macro,     year = years,     reporting_level = levels_all   )   out[, cpi := round(runif(.N, 80, 140), 2)]   out }  simulate_population <- function() {   out <- CJ(     country = countries_macro,     year = years,     reporting_level = levels_all   )   out[, population := round(runif(.N, 5e5, 20e6))]   out }  simulate_gdp <- function() {   out <- CJ(country = countries_macro, year = years)   out[, gdp := round(runif(.N, 1e9, 5e11))]   out }  cpi <- simulate_cpi() pop <- simulate_population() gdp <- simulate_gdp()  st_save(   cpi,   fs::path(macro_dir, \"cpi.qs2\"),   pk = c(\"country\", \"year\", \"reporting_level\"),   domain = \"macro\" ) #> ✔ Saved [qs2] → #> /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 @ version 08fef20049342e5c st_save(   pop,   fs::path(macro_dir, \"population.qs2\"),   pk = c(\"country\", \"year\", \"reporting_level\"),   domain = \"macro\" ) #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/data/macro/population.qs2 @ version #>   2614f122435218b7 st_save(   gdp,   fs::path(macro_dir, \"gdp.qs2\"),   pk = c(\"country\", \"year\"),   domain = \"macro\" ) #> ✔ Saved [qs2] → #> /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 @ version 4755dee2ded81ede st_versions(fs::path(macro_dir, \"cpi.qs2\"))"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"aggregation-function-foo-and-output-table","dir":"Articles","previous_headings":"The Solution","what":"3. Aggregation Function foo() and Output Table","title":"Stamp","text":"compute per (country, year, reporting_level) welfare statistics merge CPI, GDP, population. demonstrate loading inputs inside function self-containment. Save summary lineage: parents include welfare micro datasets plus CPI/GDP/population. Note: make provenance explicit, pass producing function code= st_save() records function hash. demonstrate patterns: foo() loads data, bar() accepts pre-loaded objects saved code = bar. Handling multiple function dependencies output depends one function (example foo() calls f1() f2()), can provide combined code metadata st_save() captures producing functions. st_save() accepts object code; best practice pass short list functions involved, e.g. code = list(foo = foo, helper1 = f1, helper2 = f2). package hashes code records code_hash sidecar downstream st_is_stale() can detect changes contributor. Example pattern:","code":"foo <- function() {   # Load all welfare micro artifacts (only recognized data files)   welfare_files <- data_files(welfare_dir)   wf <- rbindlist(lapply(welfare_files, st_load))    stats <- wf[,     .(       welfare_mean = weighted.mean(welfare, weight),       welfare_median = as.numeric(stats::median(welfare)),       welfare_sd = stats::sd(welfare),       welfare_n = .N     ),     by = .(country, year, reporting_level)   ]    cpi <- st_load(fs::path(macro_dir, \"cpi.qs2\"))   gdp <- st_load(fs::path(macro_dir, \"gdp.qs2\"))   pop <- st_load(fs::path(macro_dir, \"population.qs2\"))    # Merge; CPI & population contain rows not present in welfare; keep welfare rows only   out <- merge(     stats,     cpi,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(     out,     pop,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(out, gdp, by = c(\"country\", \"year\"), all.x = TRUE)   setcolorder(     out,     c(       \"country\",       \"year\",       \"reporting_level\",       \"welfare_mean\",       \"welfare_median\",       \"welfare_sd\",       \"welfare_n\",       \"cpi\",       \"gdp\",       \"population\"     )   )   out }  summary_table <- foo() #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/population.qs2 head(summary_table) #> Key: <country, year> #>    country  year reporting_level welfare_mean welfare_median welfare_sd #>     <char> <int>          <char>        <num>          <num>      <num> #> 1:     COL  2010           rural     3.188479          2.895   1.604006 #> 2:     COL  2010           urban     3.065242          2.665   1.681036 #> 3:     COL  2012           rural     3.196254          2.820   1.872963 #> 4:     COL  2012           urban     3.079524          2.750   1.627238 #> 5:     MEX  2010           rural     3.247370          2.775   1.696690 #> 6:     MEX  2010           urban     3.006862          2.710   1.606477 #>    welfare_n    cpi          gdp population #>        <int>  <num>        <num>      <num> #> 1:       200  92.71 449669674645   10746038 #> 2:       200  99.10 449669674645    5152778 #> 3:       200  93.11  55701684731    7761159 #> 4:       200 111.42  55701684731   15249755 #> 5:       200  93.68 384563952393    5367608 #> 6:       200 125.54 384563952393   12591517 parent_paths <- c(   data_files(welfare_dir),   fs::path(macro_dir, \"cpi.qs2\"),   fs::path(macro_dir, \"gdp.qs2\"),   fs::path(macro_dir, \"population.qs2\") ) parents <- lapply(parent_paths, function(p) {   list(path = p, version_id = st_latest(p)) })  out_summary_path <- fs::path(outputs_dir, \"welfare_summary.qs2\") st_save(   summary_table,   out_summary_path,   pk = c(\"country\", \"year\", \"reporting_level\"),   parents = parents,   domain = \"summary\" ) #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 @ version #>   ab7ca1b8bbd7cfe5 st_lineage(out_summary_path, depth = 1) #>   level                                    child_path    child_version #> 1     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #> 2     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #> 3     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #> 4     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #> 5     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #> 6     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #> 7     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #> 8     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #> 9     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 ab7ca1b8bbd7cfe5 #>                                   parent_path   parent_version #> 1 /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 7b77750f575ad522 #> 2 /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 9a439df9a3a329dd #> 3 /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 4b1ce9899efd10a3 #> 4 /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 4aeb106e3c11f695 #> 5 /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 f2911a8c8fe1bfc1 #> 6 /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 de6f77e839f2f05b #> 7        /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 08fef20049342e5c #> 8        /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 4755dee2ded81ede #> 9 /tmp/RtmpIaoNw2/s/data/macro/population.qs2 2614f122435218b7 # Variant that accepts loaded objects (preferred for testability and clarity) bar <- function(welfare_list, cpi_tbl, gdp_tbl, pop_tbl) {   wf <- data.table::rbindlist(welfare_list)   stats <- wf[,     .(       welfare_mean = weighted.mean(welfare, weight),       welfare_median = as.numeric(stats::median(welfare)),       welfare_sd = stats::sd(welfare),       welfare_n = .N     ),     by = .(country, year, reporting_level)   ]    out <- merge(     stats,     cpi_tbl,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(     out,     pop_tbl,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(out, gdp_tbl, by = c(\"country\", \"year\"), all.x = TRUE)   setcolorder(     out,     c(       \"country\",       \"year\",       \"reporting_level\",       \"welfare_mean\",       \"welfare_median\",       \"welfare_sd\",       \"welfare_n\",       \"cpi\",       \"gdp\",       \"population\"     )   )   out }  # Example: load inputs outside the worker and call bar() welfare_files <- data_files(welfare_dir) welfare_list <- lapply(welfare_files, st_load) #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 cpi_tbl <- st_load(fs::path(macro_dir, \"cpi.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 gdp_tbl <- st_load(fs::path(macro_dir, \"gdp.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 pop_tbl <- st_load(fs::path(macro_dir, \"population.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/RtmpIaoNw2/s/data/macro/population.qs2  summary_table2 <- bar(welfare_list, cpi_tbl, gdp_tbl, pop_tbl) st_save(   summary_table2,   out_summary_path,   pk = c(\"country\", \"year\", \"reporting_level\"),   parents = parents,   code = bar, # addition the function as parent so st_save() can track it   domain = \"summary\" ) #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 @ version #>   609259970505c2d3 st_lineage(out_summary_path, depth = 1) #>   level                                    child_path    child_version #> 1     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #> 2     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #> 3     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #> 4     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #> 5     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #> 6     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #> 7     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #> 8     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #> 9     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 609259970505c2d3 #>                                   parent_path   parent_version #> 1 /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 7b77750f575ad522 #> 2 /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 9a439df9a3a329dd #> 3 /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 4b1ce9899efd10a3 #> 4 /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 4aeb106e3c11f695 #> 5 /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 f2911a8c8fe1bfc1 #> 6 /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 de6f77e839f2f05b #> 7        /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 08fef20049342e5c #> 8        /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 4755dee2ded81ede #> 9 /tmp/RtmpIaoNw2/s/data/macro/population.qs2 2614f122435218b7 # Provide multiple functions to st_save so code_hash changes if any of them change # st_save(x, path, code = list(foo = foo, helper1 = f1, helper2 = f2))"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"modify-cpi-col-2012-new-version-staleness","dir":"Articles","previous_headings":"The Solution","what":"4. Modify CPI (COL 2012) → New Version & Staleness","title":"Stamp","text":"change CPI COL 2012 (reporting levels) illustrate new version stale downstream artifact.","code":"cpi2 <- st_load(fs::path(macro_dir, \"cpi.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 cpi2[country == \"COL\" & year == 2012, cpi := cpi * 1.05] # 5% adjustment st_save(cpi2, fs::path(macro_dir, \"cpi.qs2\")) # new version recorded #> ✔ Saved [qs2] → #> /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 @ version 350f2d40e7d43ca4 st_versions(fs::path(macro_dir, \"cpi.qs2\"))[1:3] #>          version_id      artifact_id     content_hash code_hash size_bytes #>              <char>           <char>           <char>    <char>      <num> #> 1: 350f2d40e7d43ca4 a55467ea33c92a19 ebe973771e7bc85a      <NA>        885 #> 2: 08fef20049342e5c a55467ea33c92a19 bc4f56e02d372e73      <NA>        869 #> 3:             <NA>             <NA>             <NA>      <NA>         NA #>              created_at sidecar_format #>                  <char>         <char> #> 1: 2025-11-12T22:22:14Z           json #> 2: 2025-11-12T22:22:13Z           json #> 3:                 <NA>           <NA> st_is_stale(out_summary_path) # should be TRUE #> [1] TRUE"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"builders-plans-and-rebuilds-concepts-and-how-we-use-them-here","dir":"Articles","previous_headings":"The Solution","what":"Builders, plans and rebuilds — concepts and how we use them here","title":"Stamp","text":"short glossary explanation concepts used examples : Artifact: saved object disk (one path managed stamp). Sidecar: metadata file beside artifact (PKs, parents, code hash, domain, timestamps). Version: immutable snapshot; new version id recorded st_save() detects changed content. Parent: pointer (path + version_id) upstream artifact used produce downstream artifact. Lineage: directed graph linking artifacts via parent relationships; inspect st_lineage(). Builder: function registered st_register_builder(path, builder_fn) knows produce one artifact. Returns least x (object save) code (function(s) used) code changes trigger staleness. Plan: result st_plan_rebuild() describing targets stale (parents changed, code changed, artifact missing) thus need rebuilding. Rebuild: executing plan via st_rebuild(plan); runs builders, saves artifacts, updates sidecars/versions. General idea - Register builders reproducible targets. Builders deterministic return object save (save directly inside builder). - Use st_plan_rebuild() compute needs rebuilt (inspects recorded parents code hashes). - Inspect plan, call st_rebuild() execute builders record new versions. vignette implements ideas - register builder out_summary_path (see st_register_builder() call ). builder returns list(x = foo(), code = foo, code_label = \"aggregate_welfare\"). - st_plan_rebuild() compares current parent version ids code hash foo sidecar recorded; parent code changed plan mark target stale. - st_rebuild(plan) calls registered builder, st_save() persistently records new artifact sidecar (including new code_hash parent pointers). - flow gives lightweight, auditable, incremental pipeline: change upstream artifact function plan tell rebuild. Practical tips small example - Builders prefer use parents argument passed (avoids global state makes builders easier test). - target depends multiple functions, pass code st_save() records combined code hash: code = list(foo = foo, helper = f1). Example builder loads parents explicitly returns multiple functions code: Inspect plan running : Run plan execute builders record new versions: example shows recommended pattern: load parents, call pure worker (like bar()), return x code. ensures st_rebuild() can uniformly save artifacts, record lineage, compute code_hash changes future incremental rebuilds. Plan & rebuild using registered builder summary artifact.","code":"# Example: register a builder that uses the provided `parents` list and avoids global loads st_register_builder(out_summary_path, function(path, parents) {   # parents is a list of lists: each element has $path and $version_id   # Filter parent paths to identify welfare partitions vs macros, then load them   welfare_parent_paths <- vapply(     parents,     function(p) grepl(\"welfare\", p$path),     logical(1)   )   welfare_list <- lapply(parents[welfare_parent_paths], function(p) {     st_load(p$path)   })    cpi_tbl <- st_load(fs::path(macro_dir, \"cpi.qs2\"))   gdp_tbl <- st_load(fs::path(macro_dir, \"gdp.qs2\"))   pop_tbl <- st_load(fs::path(macro_dir, \"population.qs2\"))    # Produce the output using a helper function (bar) that accepts pre-loaded inputs   out <- bar(welfare_list, cpi_tbl, gdp_tbl, pop_tbl)    # Return the produced object plus code metadata (capture both producer and helpers)   list(     x = out,     code = list(bar = bar), # include helpers as needed     code_label = \"aggregate_welfare_partitioned\"   ) }) #> ✔ Registered builder for /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 #>   (default) plan <- st_plan_rebuild(   targets = out_summary_path,   include_targets = TRUE,   mode = \"strict\" ) print(plan) #>   level                                          path         reason #> 1     0 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 parent_changed #>   latest_version_before #> 1      609259970505c2d3 st_rebuild(plan) #> ✔ Rebuild level 0: 1 artifact #>   • /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 (parent_changed) #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/population.qs2 #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 @ version #>   500a2d76d0245c42 #> OK @ version 500a2d76d0245c42 #> ✔ Rebuild summary #>   built 1 st_register_builder(out_summary_path, function(path, parents) {   list(x = foo(), code = foo, code_label = \"aggregate_welfare\") }) #> ✔ Registered builder for /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 #>   (default)  plan <- st_plan_rebuild(   targets = out_summary_path,   include_targets = TRUE,   mode = \"strict\" ) plan #> [1] level                 path                  reason                #> [4] latest_version_before #> <0 rows> (or 0-length row.names) st_rebuild(plan) #> ✔ Nothing to rebuild (empty plan). st_lineage(out_summary_path, depth = 1) #>   level                                    child_path    child_version #> 1     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #> 2     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #> 3     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #> 4     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #> 5     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #> 6     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #> 7     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #> 8     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #> 9     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 500a2d76d0245c42 #>                                   parent_path   parent_version #> 1 /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 7b77750f575ad522 #> 2 /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 9a439df9a3a329dd #> 3 /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 4b1ce9899efd10a3 #> 4 /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 4aeb106e3c11f695 #> 5 /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 f2911a8c8fe1bfc1 #> 6 /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 de6f77e839f2f05b #> 7        /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 350f2d40e7d43ca4 #> 8        /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 4755dee2ded81ede #> 9 /tmp/RtmpIaoNw2/s/data/macro/population.qs2 2614f122435218b7"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"add-new-data-arg-2015-welfare","dir":"Articles","previous_headings":"The Solution","what":"5. Add New Data (ARG 2015 Welfare)","title":"Stamp","text":"introduce new welfare dataset (ARG 2015) appears macro tables already. summary rows ARG 2015 newly added.","code":"dt_arg_2015 <- simulate_welfare(\"ARG\", 2015) st_save(   dt_arg_2015,   fs::path(welfare_dir, \"ARG_2015.qs2\"),   pk = c(\"country\", \"year\", \"reporting_level\", \"hh_id\"),   domain = \"welfare\" ) #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/data/welfare/ARG_2015.qs2 @ version #>   e610c03e6677c3f0  parents2 <- lapply(   c(     data_files(welfare_dir),     fs::path(macro_dir, \"cpi.qs2\"),     fs::path(macro_dir, \"gdp.qs2\"),     fs::path(macro_dir, \"population.qs2\")   ),   function(p) list(path = p, version_id = st_latest(p)) ) st_save(   foo(),   out_summary_path,   pk = c(\"country\", \"year\", \"reporting_level\"),   parents = parents2,   domain = \"summary\" ) #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/ARG_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 #> ✔ Loaded [qs2] ← /tmp/RtmpIaoNw2/s/data/macro/population.qs2 #> ✔ Saved [qs2] → /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 @ version #>   71315005960aa306 head(st_load(out_summary_path)) #> ✔ Loaded [qs2] ← #> /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 #> Key: <country, year> #>    country  year reporting_level welfare_mean welfare_median welfare_sd #>     <char> <int>          <char>        <num>          <num>      <num> #> 1:     ARG  2015        national     3.100148          2.510   1.700340 #> 2:     COL  2010           rural     3.188479          2.895   1.604006 #> 3:     COL  2010           urban     3.065242          2.665   1.681036 #> 4:     COL  2012           rural     3.196254          2.820   1.872963 #> 5:     COL  2012           urban     3.079524          2.750   1.627238 #> 6:     MEX  2010           rural     3.247370          2.775   1.696690 #>    welfare_n      cpi          gdp population #>        <int>    <num>        <num>      <num> #> 1:       200 120.4800 250154797653    8785981 #> 2:       200  92.7100 449669674645   10746038 #> 3:       200  99.1000 449669674645    5152778 #> 4:       200  97.7655  55701684731    7761159 #> 5:       200 116.9910  55701684731   15249755 #> 6:       200  93.6800 384563952393    5367608"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"partitioned-workflow-for-partial-re-execution","dir":"Articles","previous_headings":"The Solution","what":"6. Partitioned Workflow for Partial Re-execution","title":"Stamp","text":"Instead storing one large welfare micro file per country-year, can store partitions per (country, year, reporting_level) using st_save_part() recompute affected partitions input changes. Define partitioned builder writing one output partition per (country, year, reporting_level) summary row. output partition depends : corresponding welfare partition + CPI + GDP + population (three macro artifacts shared parents).","code":"fs::dir_create(welfare_parts_dir)  # Write partitioned welfare (one partition per country/year/reporting_level) for (i in seq_len(nrow(welfare_specs))) {   row <- welfare_specs[i, ]   dt <- simulate_welfare(row$country, row$year) # new simulated (independent from earlier saves)   # split by reporting_level   for (rl in unique(dt$reporting_level)) {     part_dt <- dt[reporting_level == rl]     st_save_part(       part_dt,       base = welfare_parts_dir,       key = list(country = row$country, year = row$year, reporting_level = rl),       code_label = \"welfare_partition\",       pk = c(\"country\", \"year\", \"reporting_level\", \"hh_id\")     )   } } #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=COL/reporting_level=urban/year=2010/part.qs2 #>   @ version 4f7a23a13178a390 #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=COL/reporting_level=rural/year=2010/part.qs2 #>   @ version b6b667f458477a4c #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=COL/reporting_level=urban/year=2012/part.qs2 #>   @ version 518f873032b0b121 #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=COL/reporting_level=rural/year=2012/part.qs2 #>   @ version 0c263632955a8c18 #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=MEX/reporting_level=urban/year=2010/part.qs2 #>   @ version 6958b476015ec33a #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=MEX/reporting_level=rural/year=2010/part.qs2 #>   @ version 208decf6888c16f5 #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=MEX/reporting_level=urban/year=2015/part.qs2 #>   @ version fbe1ef0fc930d67d #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=MEX/reporting_level=rural/year=2015/part.qs2 #>   @ version 0d097453527218aa #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=PRY/reporting_level=national/year=2011/part.qs2 #>   @ version 660f69dd9efde5b6 #> ✔ Saved [qs2] → #>   /tmp/RtmpIaoNw2/s/data/welfare_parts/country=PRY/reporting_level=national/year=2014/part.qs2 #>   @ version e9c47b0c76b6c89e st_list_parts(welfare_parts_dir)[1:6, ] #>                                                                                        path #> 1 /tmp/RtmpIaoNw2/s/data/welfare_parts/country=COL/reporting_level=rural/year=2010/part.qs2 #> 2 /tmp/RtmpIaoNw2/s/data/welfare_parts/country=COL/reporting_level=rural/year=2012/part.qs2 #> 3 /tmp/RtmpIaoNw2/s/data/welfare_parts/country=COL/reporting_level=urban/year=2010/part.qs2 #> 4 /tmp/RtmpIaoNw2/s/data/welfare_parts/country=COL/reporting_level=urban/year=2012/part.qs2 #> 5 /tmp/RtmpIaoNw2/s/data/welfare_parts/country=MEX/reporting_level=rural/year=2010/part.qs2 #> 6 /tmp/RtmpIaoNw2/s/data/welfare_parts/country=MEX/reporting_level=rural/year=2015/part.qs2 #>   country reporting_level year #> 1     COL           rural 2010 #> 2     COL           rural 2012 #> 3     COL           urban 2010 #> 4     COL           urban 2012 #> 5     MEX           rural 2010 #> 6     MEX           rural 2015 fs::dir_create(summary_parts_dir)  partition_keys <- st_list_parts(welfare_parts_dir)  build_partition_summary <- function(path, parents) {   # path is the final destination for this partition artifact   # Extract key by parsing path (we stored key in directory names)   rel <- fs::path_rel(path, start = summary_parts_dir)   segs <- strsplit(dirname(rel), .Platform$file.sep)[[1]]   segs <- segs[nzchar(segs)]   # Extract only segments that follow the key=value pattern and ignore others   kv_pairs <- lapply(segs, function(s) {     m <- regmatches(s, regexec(\"^([^=]+)=(.*)$\", s))[[1]]     if (length(m) == 3L) list(k = m[2], v = m[3]) else NULL   })   kv_pairs <- Filter(Negate(is.null), kv_pairs)   if (!length(kv_pairs)) {     key <- list()   } else {     key <- setNames(       lapply(kv_pairs, function(x) x$v),       vapply(kv_pairs, function(x) x$k, character(1))     )   }    # Load welfare partition matching key   w_path <- st_part_path(welfare_parts_dir, key, format = NULL)   w <- st_load(w_path)    stats <- w[,     .(       welfare_mean = weighted.mean(welfare, weight),       welfare_median = as.numeric(median(welfare)),       welfare_sd = sd(welfare),       welfare_n = .N     ),     by = .(country, year, reporting_level)   ]    # Load macro (shared) and subset to key   cpi <- st_load(fs::path(macro_dir, \"cpi.qs2\"))[     country == key$country &       year == as.integer(key$year) &       reporting_level == key$reporting_level   ]   pop <- st_load(fs::path(macro_dir, \"population.qs2\"))[     country == key$country &       year == as.integer(key$year) &       reporting_level == key$reporting_level   ]   gdp <- st_load(fs::path(macro_dir, \"gdp.qs2\"))[     country == key$country & year == as.integer(key$year)   ]    out <- merge(     stats,     cpi,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(     out,     pop,     by = c(\"country\", \"year\", \"reporting_level\"),     all.x = TRUE   )   out <- merge(out, gdp, by = c(\"country\", \"year\"), all.x = TRUE)   list(     x = out,     code = build_partition_summary,     code_label = \"partition_summary\"   ) } # List a few partitioned summary partitions st_list_parts(summary_parts_dir)[1:6, ] #> [1] NA NA NA NA NA NA"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"partial-re-execution-after-cpi-change","dir":"Articles","previous_headings":"The Solution > 6. Partitioned Workflow for Partial Re-execution","what":"Partial Re-execution After CPI Change","title":"Stamp","text":"CPI changes COL 2012, want rebuild partitions COL 2012 across reporting levels. Rebuild stale partitions (manually filtered): COL 2012 partitions recomputed, avoiding unnecessary work countries/years.","code":"# Modify CPI again (COL 2012) to trigger staleness cpi3 <- st_load(fs::path(macro_dir, \"cpi.qs2\")) #> ✔ Loaded [qs2] ← #> /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 cpi3[country == \"COL\" & year == 2012, cpi := cpi * 1.02] st_save(cpi3, fs::path(macro_dir, \"cpi.qs2\")) #> ✔ Saved [qs2] → #> /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 @ version 1be3b70d499cc68e  # Detect which partition outputs are stale (simple check: those whose parent CPI version differs) summary_parts <- st_list_parts(summary_parts_dir) stale_idx <- vapply(summary_parts$path, st_is_stale, logical(1)) summary_parts[stale_idx, ] #> character(0) stale_paths <- summary_parts$path[stale_idx] for (p in stale_paths) {   # reconstruct key from path to identify its welfare partition parent   rel <- fs::path_rel(p, start = summary_parts_dir)   segs <- strsplit(dirname(rel), .Platform$file.sep)[[1]]   kv <- lapply(segs, function(s) strsplit(s, \"=\")[[1]])   key <- setNames(lapply(kv, function(x) x[2]), lapply(kv, function(x) x[1]))   parents <- list(     list(       path = st_part_path(welfare_parts_dir, key),       version_id = st_latest(st_part_path(welfare_parts_dir, key))     ),     list(       path = fs::path(macro_dir, \"cpi.qs2\"),       version_id = st_latest(fs::path(macro_dir, \"cpi.qs2\"))     ),     list(       path = fs::path(macro_dir, \"gdp.qs2\"),       version_id = st_latest(fs::path(macro_dir, \"gdp.qs2\"))     ),     list(       path = fs::path(macro_dir, \"population.qs2\"),       version_id = st_latest(fs::path(macro_dir, \"population.qs2\"))     )   )   b <- build_partition_summary(p, parents)   st_save(     b$x,     p,     parents = parents,     pk = c(\"country\", \"year\", \"reporting_level\"),     code = b$code,     code_label = b$code_label   ) }"},{"path":"https://randrescastaneda.github.io/stamp/articles/stamp.html","id":"summary","dir":"Articles","previous_headings":"The Solution","what":"7. Summary","title":"Stamp","text":"demonstrated: Saving multiple artifacts PK metadata automatic versioning. Building derived summary explicit lineage rebuilding upstream change. Adding new data (ARG 2015) incorporating minimal friction. partitioned strategy enabling targeted re-execution changed inputs. Explore lineage :","code":"st_lineage(out_summary_path, depth = 2)[1:10, ] #>    level                                    child_path    child_version #> 1      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 2      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 3      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 4      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 5      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 6      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 7      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 8      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 9      1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #> 10     1 /tmp/RtmpIaoNw2/s/outputs/welfare_summary.qs2 71315005960aa306 #>                                    parent_path   parent_version #> 1  /tmp/RtmpIaoNw2/s/data/welfare/ARG_2015.qs2 e610c03e6677c3f0 #> 2  /tmp/RtmpIaoNw2/s/data/welfare/COL_2010.qs2 7b77750f575ad522 #> 3  /tmp/RtmpIaoNw2/s/data/welfare/COL_2012.qs2 9a439df9a3a329dd #> 4  /tmp/RtmpIaoNw2/s/data/welfare/MEX_2010.qs2 4b1ce9899efd10a3 #> 5  /tmp/RtmpIaoNw2/s/data/welfare/MEX_2015.qs2 4aeb106e3c11f695 #> 6  /tmp/RtmpIaoNw2/s/data/welfare/PRY_2011.qs2 f2911a8c8fe1bfc1 #> 7  /tmp/RtmpIaoNw2/s/data/welfare/PRY_2014.qs2 de6f77e839f2f05b #> 8         /tmp/RtmpIaoNw2/s/data/macro/cpi.qs2 350f2d40e7d43ca4 #> 9         /tmp/RtmpIaoNw2/s/data/macro/gdp.qs2 4755dee2ded81ede #> 10 /tmp/RtmpIaoNw2/s/data/macro/population.qs2 2614f122435218b7"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"minimal-project-scaffold-temp","dir":"Articles","previous_headings":"","what":"Minimal project scaffold (temp)","title":"Version Retention, Pruning, and Table Metadata","text":"’ll create artifacts multiple versions demonstrate pruning: Inspect store & catalog:","code":"root <- fs::path(tempdir(), \"stamp-retention-example\") if (fs::dir_exists(root)) {   fs::dir_delete(root) } st_init(root) ## ✔ stamp initialized ##   root: /tmp/RtmpuH54hC/stamp-retention-example ##   state: /tmp/RtmpuH54hC/stamp-retention-example/.stamp pA <- fs::path(root, \"A.qs\") pB <- fs::path(root, \"B.qs\") pC <- fs::path(root, \"C.qs\")  xA1 <- data.frame(a = 1:3) xA2 <- data.frame(a = 2:4) xA3 <- data.frame(a = 3:5)  xB1 <- data.frame(b = letters[1:3]) xB2 <- data.frame(b = letters[2:4])  xC1 <- data.frame(c = 10:12)  # Keep retention OFF initially so we can create multiple versions st_opts(retain_versions = Inf) ## ✔ stamp options updated ##   retain_versions = \"Inf\" st_save(xA1, pA, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpuH54hC/stamp-retention-example/A.qs @ version ##   6d194690680efab7 st_save(xA2, pA, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpuH54hC/stamp-retention-example/A.qs @ version ##   0c08f8fbaa734a29 st_save(xA3, pA, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpuH54hC/stamp-retention-example/A.qs @ version ##   031f121f17fee32c st_save(xB1, pB, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpuH54hC/stamp-retention-example/B.qs @ version ##   5380d2242dc121f7 st_save(xB2, pB, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpuH54hC/stamp-retention-example/B.qs @ version ##   09c4c081db441999 st_save(xC1, pC, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpuH54hC/stamp-retention-example/C.qs @ version ##   fe86f35790b5fab5 vroot <- stamp:::.st_versions_root() fs::dir_tree(vroot, recurse = FALSE, all = TRUE) ## /tmp/RtmpuH54hC/stamp-retention-example/.stamp/versions ## ├── A.qs ## ├── B.qs ## └── C.qs st_versions(pA) st_versions(pB) st_versions(pC)"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"ad-hoc-pruning-explicit-runs","dir":"Articles","previous_headings":"","what":"Ad-hoc pruning (explicit runs)","title":"Version Retention, Pruning, and Table Metadata","text":"Use want full control (e.g., pre-release cleanup, occasional housekeeping, don’t wire auto-retention st_save()).","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"keep-the-n-latest-for-a-specific-artifact","dir":"Articles","previous_headings":"Ad-hoc pruning (explicit runs)","what":"Keep the n latest for a specific artifact","title":"Version Retention, Pruning, and Table Metadata","text":"Practical tip: always run dry_run = TRUE preview inspect repA calling dry_run = FALSE. returned table indicates snapshots removed allows store plan CI logs audit.","code":"# Dry run (safe preview) st_prune_versions(path = pA, policy = 2, dry_run = TRUE) ## ✔ DRY RUN: 1 version would be pruned across 1 artifact. ##   Estimated space reclaimed: ~200 bytes # Apply pruning repA <- st_prune_versions(path = pA, policy = 2, dry_run = FALSE) repA ##         artifact_id                                artifact_path ##              <char>                                       <char> ## 1: 6cf5825c27babc65 /tmp/RtmpuH54hC/stamp-retention-example/A.qs ##          version_id           created_at size_bytes ##              <char>               <char>      <num> ## 1: 031f121f17fee32c 2025-11-12T22:22:20Z        200 nrow(st_versions(pA)) # <= 2; latest always protected ## [1] 2"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"keep-by-recency-window-across-the-entire-catalog","dir":"Articles","previous_headings":"Ad-hoc pruning (explicit runs)","what":"Keep by recency window across the entire catalog","title":"Version Retention, Pruning, and Table Metadata","text":"","code":"# Keep anything from the last 14 days; preview first st_prune_versions(policy = list(days = 14), dry_run = TRUE) ## ✔ Retention policy matched zero versions; nothing to prune. # Apply repAll <- st_prune_versions(policy = list(days = 14)) ## ✔ Retention policy matched zero versions; nothing to prune. head(repAll) ## Empty data.table (0 rows and 5 cols): artifact_id,artifact_path,version_id,created_at,size_bytes"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"combine-count-recency-union-semantics","dir":"Articles","previous_headings":"Ad-hoc pruning (explicit runs)","what":"Combine count + recency (union semantics)","title":"Version Retention, Pruning, and Table Metadata","text":"report returns data frame artifact_path, version_id, created_at, action (keep/delete). Use dry_run = TRUE log/approve plan destructive actions (recommended shared infra/CI). Edge cases & guarantees Latest version always protected (even falls outside policy window). Time windows computed version’s created_at catalog. Pruning idempotent: re-running policy won’t remove policy satisfied.","code":"# Keep last 2 versions OR any version created within 7 days st_prune_versions(policy = list(n = 2, days = 7)) ## ✔ Retention policy matched zero versions; nothing to prune."},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"automatic-pruning-on-every-st_save","dir":"Articles","previous_headings":"","what":"Automatic pruning (on every st_save())","title":"Version Retention, Pruning, and Table Metadata","text":"call internal .st_apply_retention() end st_save(), can choose global policy stop thinking : enable automatic pruning via st_opts(retain_versions = <policy>), .st_apply_retention() invoked st_save() prune according policy just-written artifact. keeps versions directory compact without extra housekeeping steps. cautious enabling aggressive retention (small n short days) shared collaborative projects: set dry_run = TRUE CI approval step destructive pruning. Disable auto-pruning: set project-wide behavior, set options(stamp.retain_versions = ...) project .Rprofile. runtime, st_opts(retain_versions = ...) takes precedence.","code":"# Keep only the latest 2 versions per artifact going forward st_opts(retain_versions = 2) ## ✔ stamp options updated ##   retain_versions = \"2\" # New save writes + immediate prune xA4 <- data.frame(a = 4:6) st_save(xA4, pA, code = function(z) z) ## ✔ Saved [qs2] → /tmp/RtmpuH54hC/stamp-retention-example/A.qs @ version ##   27476b3a8f664116 nrow(st_versions(pA)) # <= 2 ## [1] 2 st_opts(retain_versions = Inf) # keep all versions ## ✔ stamp options updated ##   retain_versions = \"Inf\""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"primary-key-metadata-load-time-checks","dir":"Articles","previous_headings":"","what":"Primary-key metadata & load-time checks","title":"Version Retention, Pruning, and Table Metadata","text":"Milestone 4 adds PK metadata table carries identity. improves join safety, reproducibility, downstream tooling (e.g., merge validation).","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"record-pk-at-save-time-recommended","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Record PK at save time (recommended)","title":"Version Retention, Pruning, and Table Metadata","text":"Effects Validates PK columns exist unique (unless disable uniqueness). Persists pk artifact sidecar. Attaches attr(x, \"stamp_pk\") memory subsequent st_load().","code":"pop <- data.frame(   country = c(\"PER\", \"PER\", \"COL\"),   year = c(2023, 2024, 2023),   reporting_level = c(\"national\", \"urban\", \"national\"),   pop = c(34e6, 12e6, 52e6) )  p_pop <- fs::path(root, \"inputs/population.qs\")  # Validates uniqueness by default and writes PK to sidecar # Note: `st_save(..., pk = ...)` validates the keys against the provided data # and persists the `pk` element into the artifact's sidecar (stmeta/). st_save(pop, p_pop, pk = c(\"country\", \"year\", \"reporting_level\")) ## ✔ Saved [qs2] → /tmp/RtmpuH54hC/stamp-retention-example/inputs/population.qs @ ##   version 9233c80086254319"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"inspect-repair-pk-later","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Inspect / repair PK later","title":"Version Retention, Pruning, and Table Metadata","text":"","code":"st_inspect_pk(p_pop) # read PK from sidecar ## [1] \"country\"         \"year\"            \"reporting_level\" # If an older artifact lacks PK or you need to repair metadata, use: st_add_pk(p_pop, keys = c(\"country\", \"year\", \"reporting_level\")) ## ✔ stamp options updated ##   require_pk_on_load = \"FALSE\" ## ✔ Loaded [qs2] ← /tmp/RtmpuH54hC/stamp-retention-example/inputs/population.qs ## ✔ Recorded primary key for ##   /tmp/RtmpuH54hC/stamp-retention-example/inputs/population.qs --> country, ##   year, reporting_level ## ✔ stamp options updated ##   require_pk_on_load = \"FALSE\""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"load-time-behavior-options","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Load-time behavior & options","title":"Version Retention, Pruning, and Table Metadata","text":"Missing PK policy:","code":"obj <- st_load(p_pop) ## ✔ Loaded [qs2] ← ## /tmp/RtmpuH54hC/stamp-retention-example/inputs/population.qs attr(obj, \"stamp_pk\") # keys attached on load ## $keys ## [1] \"country\"         \"year\"            \"reporting_level\" st_opts(\"require_pk_on_load\", .get = TRUE) # default FALSE ## [1] FALSE st_opts(\"warn_missing_pk_on_load\", .get = TRUE) # default TRUE ## [1] TRUE # CI: make PK presence a hard requirement st_opts(require_pk_on_load = TRUE, warn_missing_pk_on_load = FALSE) ## ✔ stamp options updated ##   require_pk_on_load = \"TRUE\", warn_missing_pk_on_load = \"FALSE\""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"why-pks-matter-joins-merges","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Why PKs matter (joins & merges)","title":"Version Retention, Pruning, and Table Metadata","text":"","code":"pop <- data.frame(   country = c(\"PER\", \"MEX\"),   year = c(2023, 2022),   pop = c(34.5, 126.7) ) pop <- st_with_pk(pop, c(\"country\", \"year\"))  gdp <- data.frame(   country = c(\"PER\", \"MEX\"),   year = c(2023, 2022),   gdp = c(0.27, 1.26) ) gdp <- st_with_pk(gdp, c(\"country\", \"year\"))  merged <- merge(pop, gdp, by = c(\"country\", \"year\")) attr(merged, \"stamp_pk\") <- list(keys = c(\"country\", \"year\")) # preserve grain merged ##   country year   pop  gdp ## 1     MEX 2022 126.7 1.26 ## 2     PER 2023  34.5 0.27"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"catalog-corruption-safety","dir":"Articles","previous_headings":"Primary-key metadata & load-time checks","what":"Catalog corruption & safety","title":"Version Retention, Pruning, and Table Metadata","text":"rare occasions catalog file can become unreadable (disk issues, manual edit, process crash). package conservative: .st_catalog_read() error catalog parsed. can recover removing corrupted catalog file (lives <root>/<state_dir>/catalog.qs2) re-running st_save(); catalog recreated remaining snapshot directories. Always back catalog.qs2 (.stamp/versions/) running destructive operations production. Example recovery steps (manual): Move corrupted catalog: mv <state>/catalog.qs2 <state>/catalog.qs2.bak Re-run st_save() representative artifact recreate catalog. steps safe pruning catalog operations never touch live artifact files — committed snapshots catalog. Tips Include identifier columns PK (country, year, reporting_level, …). Measures part PK. Prefer recording PKs write time. Post-hoc repairs supported easier forget.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"sidecar-metadata-quick-reference","dir":"Articles","previous_headings":"","what":"Sidecar metadata (quick reference)","title":"Version Retention, Pruning, and Table Metadata","text":"Every artifact JSON sidecar sibling stmeta/ : Core: format, created_at, size_bytes Integrity: content_hash, code_hash, optional file_hash Lineage: parents, code_label Tabular: pk, optional domain Inspect: Integrity checks load (enabled via st_opts(verify_on_load = TRUE)): Warn mismatched content_hash (object changed). Warn mismatched file_hash (file bytes changed), recorded.","code":"side <- st_read_sidecar(p_pop) names(side) ##  [1] \"path\"         \"format\"       \"created_at\"   \"size_bytes\"   \"content_hash\" ##  [6] \"code_hash\"    \"file_hash\"    \"code_label\"   \"parents\"      \"attrs\"        ## [11] \"pk\" side$pk ## $keys ## [1] \"country\"         \"year\"            \"reporting_level\""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"partitioned-datasets-hive-style","dir":"Articles","previous_headings":"","what":"Partitioned datasets (Hive-style)","title":"Version Retention, Pruning, and Table Metadata","text":"need one file per key combo (e.g., per country/year), use partition helpers. Layout:","code":"<base>/<k1>=<v1>/<k2>=<v2>/part.<ext>"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"create-partitions-save-parts","dir":"Articles","previous_headings":"Partitioned datasets (Hive-style)","what":"Create partitions & save parts","title":"Version Retention, Pruning, and Table Metadata","text":"st_save_part() uses st_save() hood writes sidecars local stmeta/ directory inside partition.","code":"base <- fs::path(root, \"inputs\", \"country_year\")  # Paths (order of keys doesn't matter; normalized internally) p_per_2023 <- st_part_path(   base,   key = list(country = \"PER\", year = 2023),   format = \"qs2\" ) p_mex_2022 <- st_part_path(base, key = list(country = \"MEX\", year = 2022))  per_tbl <- data.frame(country = \"PER\", year = 2023, pop = 34.5) mex_tbl <- data.frame(country = \"MEX\", year = 2022, pop = 126.7)  # Save; PK recorded in each partition's sidecar st_save_part(   per_tbl,   base,   key = list(country = \"PER\", year = 2023),   pk = c(\"country\", \"year\") ) ## ✔ Saved [qs2] → ##   /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 ##   @ version 40e4e0ecf091a604 st_save_part(   mex_tbl,   base,   key = list(country = \"MEX\", year = 2022),   pk = c(\"country\", \"year\") ) ## ✔ Saved [qs2] → ##   /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=MEX/year=2022/part.qs2 ##   @ version 8cecb274446089eb"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"discover-load","dir":"Articles","previous_headings":"Partitioned datasets (Hive-style)","what":"Discover & load","title":"Version Retention, Pruning, and Table Metadata","text":"Notes partition artifact data.frame, st_load_parts() returns one-row table .object list-column still appends key columns. Folder keys (e.g., country=PER/year=2023) agree partition table’s PK columns.","code":"# List artifacts (sidecars under stmeta/ are ignored) st_list_parts(base) ##                                                                                         path ## 1 /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=MEX/year=2022/part.qs2 ## 2 /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 ##   country year ## 1     MEX 2022 ## 2     PER 2023 st_list_parts(base, filter = list(country = \"PER\")) ##                                                                                         path ## 1 /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 ##   country year ## 1     PER 2023 # Bind rows (adds key columns as ordinary columns) all_parts <- st_load_parts(base, as = \"rbind\") ## ✔ Loaded [qs2] ← ##   /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=MEX/year=2022/part.qs2 ## ✔ Loaded [qs2] ← ##   /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 all_parts ##   country year   pop ## 1     MEX 2022 126.7 ## 2     PER 2023  34.5 # data.table option (if installed) if (requireNamespace(\"data.table\", quietly = TRUE)) {   dt <- st_load_parts(base, as = \"dt\")   dt[] } ## ✔ Loaded [qs2] ← ##   /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=MEX/year=2022/part.qs2 ## ✔ Loaded [qs2] ← ##   /tmp/RtmpuH54hC/stamp-retention-example/inputs/country_year/country=PER/year=2023/part.qs2 ##    country   year   pop ##     <char> <char> <num> ## 1:     MEX   2022 126.7 ## 2:     PER   2023  34.5"},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"recommendations-recipes","dir":"Articles","previous_headings":"","what":"Recommendations & Recipes","title":"Version Retention, Pruning, and Table Metadata","text":"Safety first: always dry_run = TRUE large catalogs; store plan auditability. Auto vs. manual: prefer auto retention day--day saves; add manual prune step release housekeeping jobs. Project defaults: set options(stamp.retain_versions = ...) .Rprofile; override runtime st_opts(). CI: enforce require_pk_on_load = TRUE run st_prune_versions(..., dry_run = TRUE) produce log destructive steps. Time windows: retention windows based created_at recorded version creation; keep machine clocks sane shared hosts.","code":""},{"path":"https://randrescastaneda.github.io/stamp/articles/version_retention_prune.html","id":"faq","dir":"Articles","previous_headings":"","what":"FAQ","title":"Version Retention, Pruning, and Table Metadata","text":"pruning ever delete latest version? . latest version per artifact always protected. ’s union semantics list(n, days)? version kept among n recent created_at falls within days window. PKs stored? artifact’s sidecar JSON sibling stmeta/. st_load() re-attaches attr(x, \"stamp_pk\"). partition helpers change retention works? . partition artifact versioned/pruned independently, inheriting retention policies.","code":""},{"path":"https://randrescastaneda.github.io/stamp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"R.Andres Castaneda. Author, maintainer.","code":""},{"path":"https://randrescastaneda.github.io/stamp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Castaneda R (2025). stamp: Reproducible Artifact Store Sidecars, Versions, Partitions. R package version 0.0.3, https://randrescastaneda.github.io/stamp/.","code":"@Manual{,   title = {stamp: Reproducible Artifact Store with Sidecars, Versions, and Partitions},   author = {R.Andres Castaneda},   year = {2025},   note = {R package version 0.0.3},   url = {https://randrescastaneda.github.io/stamp/}, }"},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"stamp","dir":"","previous_headings":"","what":"stamp","title":"stamp","text":"Lightweight versioned artifact store R sidecar metadata, pruning policies, Hive-style partitions.","code":""},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"stamp","text":"can install development version stamp GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"randrescastaneda/stamp\")"},{"path":"https://randrescastaneda.github.io/stamp/index.html","id":"quickstart","dir":"","previous_headings":"","what":"Quickstart","title":"stamp","text":"stamp? Sidecars: hashes, provenance, PKs. Retention: keep latest N /recent days. Partitions: Hive-style directories, easy bind & filter. See vignettes retention + partition details.","code":"library(stamp) root <- tempdir() st_init(root) #> ✔ stamp initialized #>   root: C:/Users/wb384996/AppData/Local/Temp/Rtmpama7Fa #>   state: C:/Users/wb384996/AppData/Local/Temp/Rtmpama7Fa/.stamp  p <- fs::path(root, \"demo.qs\") x <- data.frame(id = 1:3, val = letters[1:3])  st_save(x, p, pk = \"id\", code = function(z) z) #> ✔ Saved [qs2] → 'C:/Users/wb384996/AppData/Local/Temp/Rtmpama7Fa/demo.qs' @ #>   version 127affba57484657 y <- st_load(p) #> ✔ Loaded [qs2] ← 'C:/Users/wb384996/AppData/Local/Temp/Rtmpama7Fa/demo.qs' st_versions(p) #>          version_id      artifact_id     content_hash        code_hash #>              <char>           <char>           <char>           <char> #> 1: 127affba57484657 e7350537ff428064 2ba92a4feeebbf98 f61faf5f16af2f9f #>    size_bytes           created_at sidecar_format #>         <num>               <char>         <char> #> 1:        255 2025-11-06T22:43:15Z           json  # Retention st_opts(retain_versions = 2) #> ✔ stamp options updated #>   retain_versions = \"2\" st_save(transform(x, val = toupper(val)), p, code = function(z) z) #> ✔ Retention policy matched zero versions; nothing to prune. #> ✔ Saved [qs2] → 'C:/Users/wb384996/AppData/Local/Temp/Rtmpama7Fa/demo.qs' @ #>   version 66a5ca432fe09e5a st_versions(p) #>          version_id      artifact_id     content_hash        code_hash #>              <char>           <char>           <char>           <char> #> 1: 66a5ca432fe09e5a e7350537ff428064 ac6d1caaa0c15f0e f61faf5f16af2f9f #> 2: 127affba57484657 e7350537ff428064 2ba92a4feeebbf98 f61faf5f16af2f9f #>    size_bytes           created_at sidecar_format #>         <num>               <char>         <char> #> 1:        228 2025-11-06T22:43:16Z           json #> 2:        255 2025-11-06T22:43:15Z           json  # Partitions base <- fs::path(root, \"inputs/country_year\") st_save_part(   data.frame(country = \"PER\", year = 2023, pop = 34.5),   base,   key = list(country = \"PER\", year = 2023),   pk = c(\"country\", \"year\") ) #> ✔ Retention policy matched zero versions; nothing to prune. #> ✔ Saved [qs2] → #>   'C:/Users/wb384996/AppData/Local/Temp/Rtmpama7Fa/inputs/country_year/country=PER/year=2023/part.qs2' #>   @ version b79b777eef2607f4 st_list_parts(base) #>                                                                                                 path #> 1 C:/Users/wb384996/AppData/Local/Temp/Rtmpama7Fa/inputs/country_year/country=PER/year=2023/part.qs2 #>   country year #> 1     PER 2023 st_load_parts(base, as = \"rbind\") #> ✔ Loaded [qs2] ← #>   'C:/Users/wb384996/AppData/Local/Temp/Rtmpama7Fa/inputs/country_year/country=PER/year=2023/part.qs2' #>   country year  pop #> 1     PER 2023 34.5"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_artifact_id.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute artifact identifier (internal) — .st_artifact_id","title":"Compute artifact identifier (internal) — .st_artifact_id","text":"Derive artifact identifier path using stable SipHash normalized path. identifier used group versions belonging logical artifact.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_artifact_id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute artifact identifier (internal) — .st_artifact_id","text":"","code":".st_artifact_id(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_artifact_id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute artifact identifier (internal) — .st_artifact_id","text":"path Character path artifact.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_artifact_id.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute artifact identifier (internal) — .st_artifact_id","text":"Character scalar identifier.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_empty.html","id":null,"dir":"Reference","previous_headings":"","what":"Empty catalog template (internal) — .st_catalog_empty","title":"Empty catalog template (internal) — .st_catalog_empty","text":"Create empty catalog structure used catalog file exists disk. structure contains artifacts versions tables use data.table available, otherwise base data.frame.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_empty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empty catalog template (internal) — .st_catalog_empty","text":"","code":".st_catalog_empty()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_empty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Empty catalog template (internal) — .st_catalog_empty","text":"list elements artifacts versions (data.frame data.table).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_latest_version_row.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","title":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","text":"Return latest version record (single-row data.frame data.table) artifact identified path. artifact version exists, NULL returned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_latest_version_row.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","text":"","code":".st_catalog_latest_version_row(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_latest_version_row.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","text":"path Path artifact.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_latest_version_row.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve the latest version row for an artifact (internal) — .st_catalog_latest_version_row","text":"single-row data.frame/data.table version metadata, NULL.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Catalog file path (internal) — .st_catalog_path","title":"Catalog file path (internal) — .st_catalog_path","text":"Return path -disk catalog file package state directory: /<state_dir>/catalog.qs2","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Catalog file path (internal) — .st_catalog_path","text":"","code":".st_catalog_path()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Catalog file path (internal) — .st_catalog_path","text":"Character scalar path catalog file.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_read.html","id":null,"dir":"Reference","previous_headings":"","what":"Read catalog from disk (internal) — .st_catalog_read","title":"Read catalog from disk (internal) — .st_catalog_read","text":"Read persisted catalog -disk catalog file. file exist, empty catalog template returned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_read.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read catalog from disk (internal) — .st_catalog_read","text":"","code":".st_catalog_read()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_read.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read catalog from disk (internal) — .st_catalog_read","text":"list elements artifacts versions.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_record_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Record a new version in the catalog (internal) — .st_catalog_record_version","title":"Record a new version in the catalog (internal) — .st_catalog_record_version","text":"Record new version catalog (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_record_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Record a new version in the catalog (internal) — .st_catalog_record_version","text":"","code":".st_catalog_record_version(   artifact_path,   format,   size_bytes,   content_hash,   code_hash,   created_at,   sidecar_format )"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_record_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Record a new version in the catalog (internal) — .st_catalog_record_version","text":"artifact_path Character path artifact file. format Character format name (e.g. \"rds\", \"qs2\"). size_bytes Numeric size artifact bytes. content_hash Character content hash artifact. code_hash Character code hash (available). created_at Character ISO8601 timestamp creation. sidecar_format Character sidecar format present (\"json\", \"qs2\", \"\", \"none\").","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_record_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Record a new version in the catalog (internal) — .st_catalog_record_version","text":"Character version id (SipHash artifact id, hashes, timestamp).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_write.html","id":null,"dir":"Reference","previous_headings":"","what":"Write catalog to disk (internal) — .st_catalog_write","title":"Write catalog to disk (internal) — .st_catalog_write","text":"Persist catalog list disk using QS2-backed format. write performed atomically writing temporary file directory moving place.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_write.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write catalog to disk (internal) — .st_catalog_write","text":"","code":".st_catalog_write(cat)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_write.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write catalog to disk (internal) — .st_catalog_write","text":"cat Catalog list persist (artifacts versions).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_catalog_write.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write catalog to disk (internal) — .st_catalog_write","text":"Invisible path catalog file.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_children_once.html","id":null,"dir":"Reference","previous_headings":"","what":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","title":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","text":"Internal helper finds immediate children list path parent committed parents.json snapshots. Returned columns: child_path, child_version, parent_path, parent_version.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_children_once.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","text":"","code":".st_children_once(path, version_id = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_children_once.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","text":"path Character path parent artifact. version_id Optional version id match; provided, children listing exact parent version returned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_children_once.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List children (reverse lineage) of an artifact (internal helper) — .st_children_once","text":"data.frame matching children (may empty).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_delete_version_dir_safe.html","id":null,"dir":"Reference","previous_headings":"","what":"Safely delete a version directory (internal) — .st_delete_version_dir_safe","title":"Safely delete a version directory (internal) — .st_delete_version_dir_safe","text":"Safely delete version directory (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_delete_version_dir_safe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Safely delete a version directory (internal) — .st_delete_version_dir_safe","text":"","code":".st_delete_version_dir_safe(vdir)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_dir_create.html","id":null,"dir":"Reference","previous_headings":"","what":"Ensure directory exists (idempotent) — .st_dir_create","title":"Ensure directory exists (idempotent) — .st_dir_create","text":"Create path already exist. Intermediate directories created needed.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_dir_create.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ensure directory exists (idempotent) — .st_dir_create","text":"","code":".st_dir_create(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_dir_create.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ensure directory exists (idempotent) — .st_dir_create","text":"path Character scalar path directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_dir_create.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ensure directory exists (idempotent) — .st_dir_create","text":"Invisibly returns NULL.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_norm_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize a path for use as an identifier (internal) — .st_norm_path","title":"Normalize a path for use as an identifier (internal) — .st_norm_path","text":"Convert path absolute, canonical character representation suitable deterministic hashing use identifier.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_norm_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize a path for use as an identifier (internal) — .st_norm_path","text":"","code":".st_norm_path(p)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_norm_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize a path for use as an identifier (internal) — .st_norm_path","text":"p Character path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_norm_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize a path for use as an identifier (internal) — .st_norm_path","text":"Character scalar absolute path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_now_utc.html","id":null,"dir":"Reference","previous_headings":"","what":"Current time as UTC ISO-8601 (Z) string — .st_now_utc","title":"Current time as UTC ISO-8601 (Z) string — .st_now_utc","text":"Current time UTC ISO-8601 (Z) string","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_now_utc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Current time as UTC ISO-8601 (Z) string — .st_now_utc","text":"","code":".st_now_utc()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_now_utc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Current time as UTC ISO-8601 (Z) string — .st_now_utc","text":"Character scalar like \"2025-10-30T15:42:07Z\"","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parents_normalize.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize parents structure (internal) — .st_parents_normalize","title":"Normalize parents structure (internal) — .st_parents_normalize","text":"Ensure parents object canonical shape: list lists containing path version_id. Accepts data.frames, singleton lists, list--lists.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parents_normalize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize parents structure (internal) — .st_parents_normalize","text":"","code":".st_parents_normalize(parents)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parents_normalize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize parents structure (internal) — .st_parents_normalize","text":"parents Object representing parents (data.frame, list, etc.)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parents_normalize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize parents structure (internal) — .st_parents_normalize","text":"list parent descriptors (list path version_id).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parse_utc_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse UTC timestamp strings (internal) — .st_parse_utc_times","title":"Parse UTC timestamp strings (internal) — .st_parse_utc_times","text":"Parse UTC timestamp strings (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_parse_utc_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse UTC timestamp strings (internal) — .st_parse_utc_times","text":"","code":".st_parse_utc_times(chr)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_policy_keep_ids.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute version IDs to keep under a retention policy (internal) — .st_policy_keep_ids","title":"Compute version IDs to keep under a retention policy (internal) — .st_policy_keep_ids","text":"Compute version IDs keep retention policy (internal)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_policy_keep_ids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute version IDs to keep under a retention policy (internal) — .st_policy_keep_ids","text":"","code":".st_policy_keep_ids(vtab, pol)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_policy_keep_ids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute version IDs to keep under a retention policy (internal) — .st_policy_keep_ids","text":"vtab data.frame versions sorted newest → oldest pol normalized policy .st_normalize_policy()","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_root_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Project root directory recorded by st_init() (internal) — .st_root_dir","title":"Project root directory recorded by st_init() (internal) — .st_root_dir","text":"Return absolute project root directory previously recorded st_init(). set, defaults current working directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_root_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Project root directory recorded by st_init() (internal) — .st_root_dir","text":"","code":".st_root_dir()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_root_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Project root directory recorded by st_init() (internal) — .st_root_dir","text":"Character scalar absolute path project root.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_sidecar_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Sidecar metadata path helper (internal) — .st_sidecar_path","title":"Sidecar metadata path helper (internal) — .st_sidecar_path","text":"Build path sidecar metadata file path. Sidecars live sibling directory named stmeta next file's directory. returned filename original basename .stmeta.<ext> suffix ext typically \"json\" \"qs2\".","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_sidecar_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sidecar metadata path helper (internal) — .st_sidecar_path","text":"","code":".st_sidecar_path(path, ext = c(\"json\", \"qs2\"))"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_sidecar_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sidecar metadata path helper (internal) — .st_sidecar_path","text":"path Character scalar path main data file. ext Character scalar extension sidecar (e.g. \"json\" \"qs2\").","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_sidecar_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sidecar metadata path helper (internal) — .st_sidecar_path","text":"Character scalar computed sidecar path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_state_dir_abs.html","id":null,"dir":"Reference","previous_headings":"","what":"Absolute state directory path (internal) — .st_state_dir_abs","title":"Absolute state directory path (internal) — .st_state_dir_abs","text":"Compute absolute path package state directory. constructed /<state_dir> root st_init() state_dir option stored package state.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_state_dir_abs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Absolute state directory path (internal) — .st_state_dir_abs","text":"","code":".st_state_dir_abs()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_state_dir_abs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Absolute state directory path (internal) — .st_state_dir_abs","text":"Character scalar absolute path state directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_commit_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","title":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","text":"Copy artifact file, sidecars, write parents snapshot version directory given version_id.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_commit_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","text":"","code":".st_version_commit_files(artifact_path, version_id, parents = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_commit_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","text":"artifact_path Path artifact file disk. version_id Version identifier snapshot. parents Optional list parent descriptors write parents.json.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_commit_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Commit artifact and sidecars into a version snapshot (internal) — .st_version_commit_files","text":"Invisibly returns version directory path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Version directory for an artifact (internal) — .st_version_dir","title":"Version directory for an artifact (internal) — .st_version_dir","text":"Compute version directory path artifact_path version_id /<state_dir>/versions. store snapshots relative artifact path root; artifact outside root, fall back collision-free identifier based artifact's unique ID.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Version directory for an artifact (internal) — .st_version_dir","text":"","code":".st_version_dir(artifact_path, version_id)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Version directory for an artifact (internal) — .st_version_dir","text":"artifact_path Path artifact file. version_id Version identifier (character).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Version directory for an artifact (internal) — .st_version_dir","text":"Character scalar path version directory, NA version_id NA/empty.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_read_parents.html","id":null,"dir":"Reference","previous_headings":"","what":"Read parents metadata for a version (internal) — .st_version_read_parents","title":"Read parents metadata for a version (internal) — .st_version_read_parents","text":"Read return parents metadata stored parents.json inside given version_dir. parents file exists empty list returned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_read_parents.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read parents metadata for a version (internal) — .st_version_read_parents","text":"","code":".st_version_read_parents(version_dir)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_read_parents.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read parents metadata for a version (internal) — .st_version_read_parents","text":"version_dir Path version directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_read_parents.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read parents metadata for a version (internal) — .st_version_read_parents","text":"List parent descriptors, empty list.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_write_parents.html","id":null,"dir":"Reference","previous_headings":"","what":"Write parents metadata for a version (internal) — .st_version_write_parents","title":"Write parents metadata for a version (internal) — .st_version_write_parents","text":"Persist list parent descriptors version JSON inside version directory. function performs atomic write avoid partial files disk.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_write_parents.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write parents metadata for a version (internal) — .st_version_write_parents","text":"","code":".st_version_write_parents(version_dir, parents)"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_write_parents.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write parents metadata for a version (internal) — .st_version_write_parents","text":"version_dir Path version directory parents.json written. parents List parent descriptors (list path version_id).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_version_write_parents.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write parents metadata for a version (internal) — .st_version_write_parents","text":"Invisibly NULL.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_versions_root.html","id":null,"dir":"Reference","previous_headings":"","what":"Versions root directory (internal) — .st_versions_root","title":"Versions root directory (internal) — .st_versions_root","text":"Return versions root directory package state directory (.e. /<state_dir>/versions). directory created already exist.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_versions_root.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Versions root directory (internal) — .st_versions_root","text":"","code":".st_versions_root()"},{"path":"https://randrescastaneda.github.io/stamp/reference/dot-st_versions_root.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Versions root directory (internal) — .st_versions_root","text":"Character scalar path versions root directory.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_add_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","title":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","text":"Update artifact sidecar path include primary-key metadata (pk element). artifact file rewritten. default function validates provided keys current -disk artifact (optionally checks uniqueness). Use validate = FALSE skip validation perform pure metadata update.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_add_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","text":"","code":"st_add_pk(path, keys, validate = TRUE, check_unique = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_add_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","text":"path Path artifact file whose sidecar updated. keys Character vector column names set primary key. validate Logical; TRUE validate keys -disk data. check_unique Logical; TRUE assert keys uniquely identify rows -disk data (validate = TRUE).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_add_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add or repair primary-key metadata in an artifact sidecar — st_add_pk","text":"Invisibly returns character vector keys recorded.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_builders.html","id":null,"dir":"Reference","previous_headings":"","what":"List registered builders — st_builders","title":"List registered builders — st_builders","text":"List registered builders","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_builders.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List registered builders — st_builders","text":"","code":"st_builders()"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_builders.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List registered builders — st_builders","text":"data.frame columns: path, name","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed.html","id":null,"dir":"Reference","previous_headings":"","what":"Check whether an artifact would change if saved now — st_changed","title":"Check whether an artifact would change if saved now — st_changed","text":"Compares current object/code/file latest saved metadata (sidecar) reports change detected.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check whether an artifact would change if saved now — st_changed","text":"","code":"st_changed(   path,   x = NULL,   code = NULL,   mode = c(\"any\", \"content\", \"code\", \"file\") )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check whether an artifact would change if saved now — st_changed","text":"path Artifact path disk. x Current -memory object (content comparison). code Optional function/expression/character (code comparison). mode changes check: \"content\", \"code\", \"file\", \"\".","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check whether an artifact would change if saved now — st_changed","text":"list: list(changed = , reason = , detail = )","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed_reason.html","id":null,"dir":"Reference","previous_headings":"","what":"Explain why an artifact would change — st_changed_reason","title":"Explain why an artifact would change — st_changed_reason","text":"Explain artifact change","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed_reason.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Explain why an artifact would change — st_changed_reason","text":"","code":"st_changed_reason(   path,   x = NULL,   code = NULL,   mode = c(\"any\", \"content\", \"code\", \"file\") )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed_reason.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Explain why an artifact would change — st_changed_reason","text":"path Artifact path disk. x Current -memory object (content comparison). code Optional function/expression/character (code comparison). mode changes check: \"content\", \"code\", \"file\", \"\".","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_changed_reason.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Explain why an artifact would change — st_changed_reason","text":"Character scalar: \"no_change\", \"missing_artifact\", \"missing_meta\", e.g. \"content+code\"","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_children.html","id":null,"dir":"Reference","previous_headings":"","what":"List children (reverse lineage) of an artifact — st_children","title":"List children (reverse lineage) of an artifact — st_children","text":"Finds artifacts depend path (.e., record parents.json snapshots). version_id given, matches specific parent version; otherwise, parent version path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_children.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List children (reverse lineage) of an artifact — st_children","text":"","code":"st_children(path, version_id = NULL, depth = 1L)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_children.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List children (reverse lineage) of an artifact — st_children","text":"path Character path parent artifact. version_id Optional version id path match. Default: . depth Integer depth >= 1. Use Inf recurse fully.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_children.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List children (reverse lineage) of an artifact — st_children","text":"data.frame columns: level, child_path, child_version, parent_path, parent_version.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_clear_builders.html","id":null,"dir":"Reference","previous_headings":"","what":"Clear all builders (or only those for a given path) — st_clear_builders","title":"Clear all builders (or only those for a given path) — st_clear_builders","text":"Clear builders (given path)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_clear_builders.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clear all builders (or only those for a given path) — st_clear_builders","text":"","code":"st_clear_builders(path = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_clear_builders.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clear all builders (or only those for a given path) — st_clear_builders","text":"path Optional character path; provided, builders path removed.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","title":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","text":"Convenience helper subset data.frame set named values. filters argument named list mapping column names allowed values (vector). strict = TRUE, unknown filter columns raise error.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","text":"","code":"st_filter(df, filters = list(), strict = TRUE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","text":"df data.frame filter. filters Named list filtering values, e.g. list(country = \"PER\"). strict Logical; TRUE unknown filter columns cause error.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_filter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter a data.frame by primary-key values (or arbitrary columns) — st_filter","text":"subsetted data.frame (columns df).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_formats.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect available formats — st_formats","title":"Inspect available formats — st_formats","text":"Return sorted character vector names formats currently registered internal registry.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_formats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect available formats — st_formats","text":"","code":"st_formats()"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_formats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect available formats — st_formats","text":"Character vector format names.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_formats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inspect available formats — st_formats","text":"","code":"st_formats() #> [1] \"csv\"  \"fst\"  \"json\" \"qs2\"  \"rds\""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_get_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","title":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","text":"Extract primary-key column names either -memory data.frame (via stamp_pk attribute) sidecar/meta list (previously recorded pk element). Returns empty character vector none found.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_get_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","text":"","code":"st_get_pk(x_or_meta)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_get_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","text":"x_or_meta Either data.frame (attribute stamp_pk) sidecar/meta list returned st_read_sidecar().","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_get_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read primary-key keys from a data.frame or sidecar/meta list — st_get_pk","text":"Character vector primary-key column names (may length 0).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":null,"dir":"Reference","previous_headings":"","what":"Stable SipHash-1-3 of code — st_hash_code","title":"Stable SipHash-1-3 of code — st_hash_code","text":"Accepts function, expression (language), character. functions, includes formals body. Whitespace normalized conservatively.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stable SipHash-1-3 of code — st_hash_code","text":"","code":"st_hash_code(code)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stable SipHash-1-3 of code — st_hash_code","text":"code function, expression, character vector.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_code.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stable SipHash-1-3 of code — st_hash_code","text":"Lowercase hex string (16 hex chars).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":null,"dir":"Reference","previous_headings":"","what":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"SipHash-1-3 file (bytes disk)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"","code":"st_hash_file(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"path Path file.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SipHash-1-3 of a file (bytes on disk) — st_hash_file","text":"Lowercase hex string (16 hex chars).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Stable SipHash-1-3 of an R object — st_hash_obj","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"Serializes object base::serialize(version = 3) hashes raw bytes via secretbase::siphash13(). stable across sessions (given R version object structure) suitable change detection.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"","code":"st_hash_obj(x)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"x R object.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_hash_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stable SipHash-1-3 of an R object — st_hash_obj","text":"Lowercase hex string (16 hex chars) siphash13().","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","title":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","text":"Inspect artifact's current status (sidecar + catalog + snapshot location)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","text":"","code":"st_info(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","text":"path Artifact path","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect an artifact's current status (sidecar + catalog + snapshot location) — st_info","text":"named list fields: sidecar: sidecar list (NULL) catalog: list(latest_version_id, n_versions) snapshot_dir: absolute path latest version dir (NA) parents: list(...) parsed latest version's parents.json ()","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize stamp project structure — st_init","title":"Initialize stamp project structure — st_init","text":"Initialize stamp project structure","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize stamp project structure — st_init","text":"","code":"st_init(root = \".\", state_dir = \".stamp\")"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize stamp project structure — st_init","text":"root project root (default \".\") state_dir directory name internal state (default \".stamp\")","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize stamp project structure — st_init","text":"(invisibly) absolute state dir","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_inspect_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","title":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","text":"Read sidecar path return recorded primary-key column names. sidecar pk information present, returns character(0).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_inspect_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","text":"","code":"st_inspect_pk(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_inspect_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","text":"path Path artifact file.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_inspect_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect primary-key of an artifact from its sidecar — st_inspect_pk","text":"Character vector primary-key column names (may length 0).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_is_stale.html","id":null,"dir":"Reference","previous_headings":"","what":"Is a child artifact stale because its parents advanced? — st_is_stale","title":"Is a child artifact stale because its parents advanced? — st_is_stale","text":"Inspect committed parents.json latest snapshot path determine whether parent now different latest version id.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_is_stale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Is a child artifact stale because its parents advanced? — st_is_stale","text":"","code":"st_is_stale(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_is_stale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Is a child artifact stale because its parents advanced? — st_is_stale","text":"path Character path artifact inspect.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_is_stale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Is a child artifact stale because its parents advanced? — st_is_stale","text":"Logical scalar. TRUE parent advanced, otherwise FALSE.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_latest.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the latest version_id for an artifact path — st_latest","title":"Get the latest version_id for an artifact path — st_latest","text":"Get latest version_id artifact path","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_latest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the latest version_id for an artifact path — st_latest","text":"","code":"st_latest(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_latest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the latest version_id for an artifact path — st_latest","text":"path file directory path","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_lineage.html","id":null,"dir":"Reference","previous_headings":"","what":"Show immediate or recursive parents for an artifact — st_lineage","title":"Show immediate or recursive parents for an artifact — st_lineage","text":"Show immediate recursive parents artifact","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_lineage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show immediate or recursive parents for an artifact — st_lineage","text":"","code":"st_lineage(path, depth = 1L)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_lineage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show immediate or recursive parents for an artifact — st_lineage","text":"path Artifact path (child) depth Integer depth >= 1. Use Inf walk recursively.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_lineage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show immediate or recursive parents for an artifact — st_lineage","text":"data.frame columns: level, child_path, child_version, parent_path, parent_version","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":null,"dir":"Reference","previous_headings":"","what":"List available partitions under a base directory — st_list_parts","title":"List available partitions under a base directory — st_list_parts","text":"List available partitions base directory","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List available partitions under a base directory — st_list_parts","text":"","code":"st_list_parts(base, filter = NULL, recursive = TRUE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List available partitions under a base directory — st_list_parts","text":"base Base dir filter Named list restrict partitions (exact match key fields) recursive Logical; search subdirs (default TRUE)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_list_parts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List available partitions under a base directory — st_list_parts","text":"data.frame columns: path plus one column per partition key","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":null,"dir":"Reference","previous_headings":"","what":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"Load object disk (format auto-detected; optional integrity checks)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"","code":"st_load(file, format = NULL, ...)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"file path st_path format optional format override ... forwarded format reader","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load an object from disk (format auto-detected; optional integrity checks) — st_load","text":"loaded object","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":null,"dir":"Reference","previous_headings":"","what":"Load and row-bind partitioned data — st_load_parts","title":"Load and row-bind partitioned data — st_load_parts","text":"Load row-bind partitioned data","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load and row-bind partitioned data — st_load_parts","text":"","code":"st_load_parts(base, filter = NULL, as = c(\"rbind\", \"dt\"))"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load and row-bind partitioned data — st_load_parts","text":"base Base dir filter Named list restrict partitions (exact match) Data frame binding mode: \"rbind\" (base) \"dt\" (data.table available)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_parts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load and row-bind partitioned data — st_load_parts","text":"Data frame unioned columns extra columns key fields","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Load a specific version of an artifact — st_load_version","title":"Load a specific version of an artifact — st_load_version","text":"Load previously committed snapshot artifact identified path version_id. artifact file requested version read version snapshot directory using format-specific read handler registered package. useful inspecting restoring historical versions artifacts.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load a specific version of an artifact — st_load_version","text":"","code":"st_load_version(path, version_id, ...)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load a specific version of an artifact — st_load_version","text":"path Character path artifact (value used st_save/st_load). version_id Character version identifier (returned st_save present catalog). ... Additional arguments forwarded format's read function (e.g. read options).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load a specific version of an artifact — st_load_version","text":"object produced format-specific read handler (typically R object loaded disk).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load a specific version of an artifact — st_load_version","text":"function abort requested version snapshot exist registered format handler artifact's format.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_load_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load a specific version of an artifact — st_load_version","text":"","code":"if (FALSE) { # \\dontrun{ # load a historical version of a dataset old <- st_load_version(\"data/cleaned.rds\", \"20250101T000000Z-abcdef01\") } # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":null,"dir":"Reference","previous_headings":"","what":"Get or set package options — st_opts","title":"Get or set package options — st_opts","text":"Setter: st_opts(meta_format = \"\", versioning = \"timestamp\") Getter: st_opts(.get = TRUE) returns named list options Single getter: st_opts(\"meta_format\", .get = TRUE) returns one value","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get or set package options — st_opts","text":"","code":"st_opts(..., .get = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get or set package options — st_opts","text":"... Named pairs setting options; single character key .get = TRUE. .get Logical. TRUE, performs read instead write.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get or set package options — st_opts","text":"setters, invisible(NULL). getters, requested value(s).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get or set package options — st_opts","text":"Valid keys (defined .stamp_default_opts R/aaa.R): meta_format, versioning, force_on_code_change, retain_versions, code_hash, store_file_hash, verify_on_load, default_format, verbose, timezone, timeformat, usetz, require_pk_on_load, warn_missing_pk_on_load. single authoritative source truth, see .stamp_default_opts R/aaa.R; changes object determine set supported keys.","code":""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_get.html","id":null,"dir":"Reference","previous_headings":"","what":"Convenience getter (optional sugar) — st_opts_get","title":"Convenience getter (optional sugar) — st_opts_get","text":"Convenience getter (optional sugar)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_get.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convenience getter (optional sugar) — st_opts_get","text":"","code":"st_opts_get(key = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_get.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convenience getter (optional sugar) — st_opts_get","text":"key Option name NULL ","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_get.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convenience getter (optional sugar) — st_opts_get","text":"Value list values","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_reset.html","id":null,"dir":"Reference","previous_headings":"","what":"Reset all options to package defaults — st_opts_reset","title":"Reset all options to package defaults — st_opts_reset","text":"Reset options package defaults","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_reset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reset all options to package defaults — st_opts_reset","text":"","code":"st_opts_reset()"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_opts_reset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reset all options to package defaults — st_opts_reset","text":"invisible(NULL)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_part_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Build a concrete partition path under a base directory — st_part_path","title":"Build a concrete partition path under a base directory — st_part_path","text":"Build concrete partition path base directory","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_part_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build a concrete partition path under a base directory — st_part_path","text":"","code":"st_part_path(base, key, file = NULL, format = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_part_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build a concrete partition path under a base directory — st_part_path","text":"base Character base directory (e.g., \"data/users\") key Named list scalar values, e.g. list(country=\"US\", year=2025) file Optional filename (default \"part.\") format Optional format (qs2|rds|csv|fst|json); default = stamp option","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_part_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build a concrete partition path under a base directory — st_part_path","text":"Character file path partition artifact","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Declare a path (with optional format & partition hint) — st_path","title":"Declare a path (with optional format & partition hint) — st_path","text":"Declare path (optional format & partition hint)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Declare a path (with optional format & partition hint) — st_path","text":"","code":"st_path(path, format = NULL, partition_key = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Declare a path (with optional format & partition hint) — st_path","text":"path file directory path format optional explicit format (\"qs2\",\"rds\",\"csv\",\"fst\",\"json\") partition_key optional partition key (used M2)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Declare a path (with optional format & partition hint) — st_path","text":"list class 'st_path'","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize a primary-key specification — st_pk","title":"Normalize a primary-key specification — st_pk","text":"Normalize validate primary-key (pk) specification. canonical representation list element keys containing character vector column names. x (data.frame) provided validate = TRUE function check columns exist (optionally uniquely identify rows).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize a primary-key specification — st_pk","text":"","code":"st_pk(x = NULL, keys, validate = TRUE, check_unique = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize a primary-key specification — st_pk","text":"x Optional data.frame validate keys . NULL, keys vector normalized. keys Character vector column names comprising primary key. validate Logical; TRUE validate columns exist (uniqueness check_unique TRUE). check_unique Logical; TRUE assert keys uniquely identify rows x (checked x provided).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize a primary-key specification — st_pk","text":"list element keys containing canonical character vector.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_plan_rebuild.html","id":null,"dir":"Reference","previous_headings":"","what":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","title":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","text":"Returns set stale descendants targets. Two modes: \"propagate\" (default): treat target \"change\", breadth-first schedule children whose parents intersect set nodes marked \"change\". Newly scheduled nodes also marked \"change\" children considered next level. \"strict\": include nodes already stale parents' current latest versions (propagation).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_plan_rebuild.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","text":"","code":"st_plan_rebuild(   targets,   depth = Inf,   include_targets = FALSE,   mode = c(\"propagate\", \"strict\") )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_plan_rebuild.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","text":"targets Character vector artifact paths. depth Integer depth >= 1, Inf. include_targets Logical; TRUE target stale, include level 0. mode \"propagate\" (default) \"strict\".","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_plan_rebuild.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plan a rebuild of descendants when parents changed — st_plan_rebuild","text":"data.frame columns: level, path, reason, latest_version_before","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":null,"dir":"Reference","previous_headings":"","what":"Prune stored versions according to a retention policy — st_prune_versions","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"Prune stored versions according retention policy","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"","code":"st_prune_versions(path = NULL, policy = Inf, dry_run = TRUE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"path Optional character vector artifact paths restrict pruning. NULL (default), applies policy artifacts catalog. policy One : Inf (keep everything) numeric scalar n (keep n recent per artifact) list(n = <int>, days = <num>) (keep recent n /newer days; union two conditions) dry_run logical; TRUE, report pruned.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"Invisibly, data.frame pruned (-prune) versions columns: artifact_path, version_id, created_at, size_bytes.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"Retention policy semantics policy = Inf — keep versions (pruning). policy = <numeric> — interpreted “keep n recent versions per artifact.” example, policy = 2 keeps latest two prunes older ones. policy = list(...) — combined policy multiple conditions UNIONed (kept condition keeps ): n: keep latest n per artifact. days: keep versions whose created_at within last days days. keep_latest / min_keep (internal fields flows) ensure least floor versions preserved; typical use covered n + days. Grouping & order. Pruning decisions made per artifact, sorting artifact’s versions created_at (newest → oldest). “latest n” condition applied order. Dry runs vs destructive mode. dry_run = TRUE, function reports pruned (estimates reclaimed space). dry_run = FALSE, deletes snapshot directories <state_dir>/versions/... updates catalog accordingly: removes rows versions table, adjusts artifact’s n_versions latest_version_id (newest remaining version), drops artifact row none remain. Scope. can restrict pruning specific artifacts supplying paths via path argument. default (path = NULL), pruning considers artifacts recorded catalog. provide one artifact paths, versions associated artifacts considered pruning. Integration writes. set default policy via st_opts(retain_versions = <policy>), internal helpers may apply pruning right st_save() just-written artifact (keep-default). Safety notes. Pruning never touches live artifact files (.qs, etc.) — stored version snapshots catalog entries. Use dry_run = TRUE first verify removed.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_prune_versions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prune stored versions according to a retention policy — st_prune_versions","text":"","code":"# \\donttest{ # Minimal setup: temp project with three artifacts and multiple versions st_opts_reset() st_opts(versioning = \"content\", meta_format = \"json\") #> ✔ stamp options updated #>   versioning = \"content\", meta_format = \"json\"  root <- tempdir() st_init(root) #> ✔ stamp initialized #>   root: /tmp/RtmpmLWXQ3 #>   state: /tmp/RtmpmLWXQ3/.stamp  # A, B, C pA <- fs::path(root, \"A.qs\"); xA <- data.frame(a = 1:3) pB <- fs::path(root, \"B.qs\"); pC <- fs::path(root, \"C.qs\")  # First versions st_save(xA, pA, code = function(z) z) #> ✔ Saved [qs2] → /tmp/RtmpmLWXQ3/A.qs @ version 8d0864c29e87b570 st_save(transform(xA, b = a * 2), pB, code = function(z) z,         parents = list(list(path = pA, version_id = st_latest(pA)))) #> ✔ Saved [qs2] → /tmp/RtmpmLWXQ3/B.qs @ version 7eda5fdeb16175f1 st_save(transform(st_load(pB), c = b + 1L), pC, code = function(z) z,         parents = list(list(path = pB, version_id = st_latest(pB)))) #> Warning: No primary key recorded for /tmp/RtmpmLWXQ3/B.qs. #> ℹ You can add one with `st_add_pk()`. #> ✔ Loaded [qs2] ← /tmp/RtmpmLWXQ3/B.qs #> ✔ Saved [qs2] → /tmp/RtmpmLWXQ3/C.qs @ version 9d6838890381ac86  # Create a couple of extra versions for A to have data to prune st_save(transform(xA, a = a + 10L), pA, code = function(z) z) #> ✔ Saved [qs2] → /tmp/RtmpmLWXQ3/A.qs @ version 38e8f2e24ff93fda st_save(transform(xA, a = a + 20L), pA, code = function(z) z) #> ✔ Saved [qs2] → /tmp/RtmpmLWXQ3/A.qs @ version 66360849e384b238  # Inspect versions for A st_versions(pA) #>          version_id      artifact_id     content_hash        code_hash #>              <char>           <char>           <char>           <char> #> 1: 8d0864c29e87b570 98d9ea2eafb773bf d73e0bf1cb9d8dc5 488e8fa49c740261 #> 2: 66360849e384b238 98d9ea2eafb773bf abf956f7a95c9738 488e8fa49c740261 #> 3: 38e8f2e24ff93fda 98d9ea2eafb773bf f61c312c86365348 488e8fa49c740261 #>    size_bytes           created_at sidecar_format #>         <num>               <char>         <char> #> 1:        201 2025-11-12T22:21:57Z           json #> 2:        155 2025-11-12T22:21:57Z           json #> 3:        155 2025-11-12T22:21:57Z           json  # 1) Keep everything (no-op) st_prune_versions(policy = Inf, dry_run = TRUE) #> ✔ Retention policy is Inf: no pruning performed.  # 2) Keep only the latest 1 per artifact (dry run) st_prune_versions(policy = 1, dry_run = TRUE) #> ✔ DRY RUN: 2 versions would be pruned across 1 artifact. #>   Estimated space reclaimed: ~310 bytes  # 3) Combined policy: #    - keep the latest 2 per artifact #    - and also keep any versions newer than 7 days (union of both) st_prune_versions(policy = list(n = 2, days = 7), dry_run = TRUE) #> ✔ Retention policy matched zero versions; nothing to prune.  # 4) Restrict pruning to a single artifact path st_prune_versions(path = pA, policy = 1, dry_run = TRUE) #> ✔ DRY RUN: 2 versions would be pruned across 1 artifact. #>   Estimated space reclaimed: ~310 bytes  # 5) Apply pruning (destructive): keep latest 1 everywhere #    (Uncomment to run for real) # st_prune_versions(policy = 1, dry_run = FALSE)  # Optional: set a default retention policy and have st_save() apply it # after each write via .st_apply_retention() (internal helper). # For example, keep last 2 versions going forward: st_opts(retain_versions = 2) #> ✔ stamp options updated #>   retain_versions = \"2\" # Next saves will write a new version and then prune older ones for that artifact. # }"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_qs.html","id":null,"dir":"Reference","previous_headings":"","what":"saving in qs2 format in stamps — st_qs","title":"saving in qs2 format in stamps — st_qs","text":"Attempts write x path using qs2::qs_save() qs2::qsave() available, otherwise falls back qs::qsave(). Errors neither package installed. Reads object path using qs2::qs_read() qs2::qread() available, otherwise falls back qs::qread(). Errors neither package installed.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_qs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"saving in qs2 format in stamps — st_qs","text":"","code":".st_write_qs2(x, path, ...)  .st_read_qs2(path, ...)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_qs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"saving in qs2 format in stamps — st_qs","text":"x R object save. path Destination file path. ... Additional arguments passed underlying writer.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_qs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"saving in qs2 format in stamps — st_qs","text":"Invisibly returns underlying writer returns. R object read path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_read_sidecar.html","id":null,"dir":"Reference","previous_headings":"","what":"Read sidecar metadata (internal) — st_read_sidecar","title":"Read sidecar metadata (internal) — st_read_sidecar","text":"Read sidecar metadata path exists, returning NULL sidecar file present. Preference order JSON first, QS2. QS2 variant encountered function try qs2 fall back qs.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_read_sidecar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read sidecar metadata (internal) — st_read_sidecar","text":"","code":"st_read_sidecar(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_read_sidecar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read sidecar metadata (internal) — st_read_sidecar","text":"path Character path data file whose sidecar read.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_read_sidecar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read sidecar metadata (internal) — st_read_sidecar","text":"list (parsed JSON / qs object) NULL found.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_rebuild.html","id":null,"dir":"Reference","previous_headings":"","what":"Rebuild artifacts from a plan (level order) — st_rebuild","title":"Rebuild artifacts from a plan (level order) — st_rebuild","text":"Rebuild artifacts plan (level order)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_rebuild.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rebuild artifacts from a plan (level order) — st_rebuild","text":"","code":"st_rebuild(plan, rebuild_fun = NULL, dry_run = FALSE)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_rebuild.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rebuild artifacts from a plan (level order) — st_rebuild","text":"plan data.frame st_plan_rebuild(...) columns: level, path, reason, latest_version_before. rebuild_fun Optional function called : rebuild_fun(path, parents) -> list(x=..., format=?, metadata=?, code=?, code_label=?). omitted (NULL), st_rebuild() look registered builder path (st_register_builder()). dry_run TRUE, write anything; just report happen.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_rebuild.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rebuild artifacts from a plan (level order) — st_rebuild","text":"Invisibly, data.frame build results (status, version_id, msg).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_builder.html","id":null,"dir":"Reference","previous_headings":"","what":"Register a builder for an artifact path — st_register_builder","title":"Register a builder for an artifact path — st_register_builder","text":"\"builder\" knows (re)create artifact. called st_rebuild() fun(path, parents) must return list:","code":"list(     x = <object to save>,           # required     format = NULL,                  # optional (\"qs2\", \"rds\", ...)     metadata = list(),              # optional, merged into sidecar     code = NULL,                    # optional (function/expr/character)     code_label = NULL               # optional (short description)   )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_builder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Register a builder for an artifact path — st_register_builder","text":"","code":"st_register_builder(path, fun, name = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_builder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Register a builder for an artifact path — st_register_builder","text":"path Character path builder produces (exact match). fun Function signature function(path, parents). name Optional label can register multiple builders per path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_builder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Register a builder for an artifact path — st_register_builder","text":"Invisibly TRUE.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":null,"dir":"Reference","previous_headings":"","what":"Register or override a format handler — st_register_format","title":"Register or override a format handler — st_register_format","text":"Public function allows users register new format handler override existing one. Handlers must functions expected signatures documented .","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Register or override a format handler — st_register_format","text":"","code":"st_register_format(name, read, write, extensions = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Register or override a format handler — st_register_format","text":"name Character scalar: format name (e.g. \"qs2\", \"rds\"). read Function function(path, ...) returning R object. write Function function(object, path, ...) writes object path. extensions Optional character vector file extensions (e.g. c(\"qs\",\"qs2\")) map format; case-insensitive; without dots.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Register or override a format handler — st_register_format","text":"Invisibly returns TRUE success.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_register_format.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Register or override a format handler — st_register_format","text":"","code":"st_register_format(   \"txt\",   read  = function(p, ...) readLines(p, ...),   write = function(x, p, ...) writeLines(x, p, ...),   extensions = \"txt\" ) #> ✔ Registered format txt #>   extensions: .txt"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save.html","id":null,"dir":"Reference","previous_headings":"","what":"Save an R object to disk with metadata & versioning (atomic move) — st_save","title":"Save an R object to disk with metadata & versioning (atomic move) — st_save","text":"Save R object disk metadata & versioning (atomic move)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save an R object to disk with metadata & versioning (atomic move) — st_save","text":"","code":"st_save(   x,   file,   format = NULL,   metadata = list(),   code = NULL,   parents = NULL,   code_label = NULL,   pk = NULL,   domain = NULL,   unique = TRUE,   ... )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save an R object to disk with metadata & versioning (atomic move) — st_save","text":"x object save file destination path (character st_path) format optional format override (\"qs2\" | \"rds\" | \"csv\" | \"fst\" | \"json\") metadata named list extra metadata (merged sidecar) code Optional function/expression/character whose hash stored code_hash. parents Optional list parent descriptors: list(list(path = \"\", version_id = \"\"), ...). code_label Optional short label/description producing code (humans). pk optional character vector primary-key columns (tables) domain optional character scalar vector label(s) dataset unique logical; enforce uniqueness pk save time (default TRUE) ... forwarded format writer","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save an R object to disk with metadata & versioning (atomic move) — st_save","text":"invisibly, list path, metadata, version_id (skipped=TRUE)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save_part.html","id":null,"dir":"Reference","previous_headings":"","what":"Save a single partition (uses st_save under the hood) — st_save_part","title":"Save a single partition (uses st_save under the hood) — st_save_part","text":"Save single partition (uses st_save hood)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save_part.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save a single partition (uses st_save under the hood) — st_save_part","text":"","code":"st_save_part(   x,   base,   key,   code = NULL,   parents = NULL,   code_label = NULL,   format = NULL,   ... )"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save_part.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save a single partition (uses st_save under the hood) — st_save_part","text":"x Object save base Base dir partitions key Named list scalar values (e.g., list(country=\"US\", year=2025)) code, parents, code_label, format, ... Passed st_save()","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_save_part.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save a single partition (uses st_save under the hood) — st_save_part","text":"invisibly, list(path=..., version_id=...)","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_should_save.html","id":null,"dir":"Reference","previous_headings":"","what":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","title":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","text":"Decide save proceed given current st_opts() Uses versioning policy code-change rule.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_should_save.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","text":"","code":"st_should_save(path, x = NULL, code = NULL)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_should_save.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","text":"path Artifact path disk. x Current -memory object (content comparison). code Optional function/expression/character (code comparison).","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_should_save.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Decide if a save should proceed given current st_opts() Uses versioning policy and code-change rule. — st_should_save","text":"list(save = , reason = , latest_version_id = )","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_versions.html","id":null,"dir":"Reference","previous_headings":"","what":"List versions for an artifact path — st_versions","title":"List versions for an artifact path — st_versions","text":"Return table recorded versions artifact identified path catalog. data.table available result data.table; otherwise base data.frame returned. table contains one row per recorded version columns described . Rows ordered created_at descending.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_versions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List versions for an artifact path — st_versions","text":"","code":"st_versions(path)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_versions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List versions for an artifact path — st_versions","text":"path file directory path","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_versions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List versions for an artifact path — st_versions","text":"data.frame data.table columns: version_id Character version identifier. artifact_id Character artifact identifier (hashed). content_hash Character content hash version (may NA). code_hash Character code hash version (may NA). size_bytes Numeric size stored artifact bytes. created_at Character ISO8601 timestamp version recorded. sidecar_format Character sidecar format present: \"json\", \"qs2\", \"\", \"none\". empty table returned versions exist given path.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_with_pk.html","id":null,"dir":"Reference","previous_headings":"","what":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","title":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","text":"Attach primary-key metadata data.frame setting attribute stamp_pk normalized pk list returned st_pk(). modify -disk sidecars; -memory convenience.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_with_pk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","text":"","code":"st_with_pk(x, keys)"},{"path":"https://randrescastaneda.github.io/stamp/reference/st_with_pk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","text":"x Data.frame annotate. keys Character vector column names making primary key.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/st_with_pk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Attach primary-key metadata to a data.frame (in-memory) — st_with_pk","text":"input data.frame attribute stamp_pk set.","code":""},{"path":"https://randrescastaneda.github.io/stamp/reference/stamp-package.html","id":null,"dir":"Reference","previous_headings":"","what":"stamp: Reproducible Artifact Store with Sidecars, Versions, and Partitions — stamp-package","title":"stamp: Reproducible Artifact Store with Sidecars, Versions, and Partitions — stamp-package","text":"Stamp saves R objects sidecar metadata (hashes, provenance, PKs), keeps version history, prunes old versions, supports Hive-style partitions.","code":""},{"path":[]},{"path":"https://randrescastaneda.github.io/stamp/reference/stamp-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"stamp: Reproducible Artifact Store with Sidecars, Versions, and Partitions — stamp-package","text":"Maintainer: R.Andres Castaneda acastanedaa@worldbank.org (ORCID)","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"stamp-003","dir":"Changelog","previous_headings":"","what":"stamp 0.0.3","title":"stamp 0.0.3","text":"standardize helpers use data.table Add get started vignette Add builders plan vignette","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"stamp-002","dir":"Changelog","previous_headings":"","what":"stamp 0.0.2","title":"stamp 0.0.2","text":"first version share","code":""},{"path":"https://randrescastaneda.github.io/stamp/news/index.html","id":"stamp-001","dir":"Changelog","previous_headings":"","what":"stamp 0.0.1","title":"stamp 0.0.1","text":"first stable version without testing vignettes Initial CRAN submission.","code":""}]

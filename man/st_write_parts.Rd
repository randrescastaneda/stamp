% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/partitions.R
\name{st_write_parts}
\alias{st_write_parts}
\title{Auto-partition and save a dataset (Hive-style)}
\usage{
st_write_parts(
  x,
  base,
  partitioning,
  code = NULL,
  parents = NULL,
  code_label = NULL,
  format = NULL,
  pk = NULL,
  domain = NULL,
  unique = TRUE,
  .progress = NULL,
  ...
)
}
\arguments{
\item{x}{Data.frame or data.table to partition and save}

\item{base}{Base directory for partitions (e.g., "data/welfare_parts")}

\item{partitioning}{Character vector of column names to partition by
(e.g., c("country", "year", "reporting_level"))}

\item{code, parents, code_label, format, ...}{Passed to st_save() for each partition}

\item{pk}{Optional primary key columns (passed to st_save())}

\item{domain}{Optional domain label(s) (passed to st_save())}

\item{unique}{Logical; enforce PK uniqueness at save time (default TRUE)}

\item{.progress}{Logical; show progress bar for partitions (default TRUE for >10 parts)}
}
\value{
Invisibly, a data.frame with columns:
\itemize{
\item partition_key: list-column of key values
\item path: file path
\item version_id: version identifier
\item n_rows: number of rows in partition
}
}
\description{
Splits a data.frame/data.table by partition columns and saves each partition
to a separate file using Hive-style directory structure. Eliminates manual
looping and splitting logic.
}
\section{Performance}{

For large datasets with many partitions, this function uses data.table's
split for efficiency when available. Progress reporting can be disabled
with \code{.progress = FALSE}.
}

\examples{
\dontrun{
# Create sample data
welfare <- data.frame(
  country = rep(c("USA", "CAN"), each = 100),
  year = rep(2020:2021, each = 50),
  reporting_level = sample(c("national", "urban"), 200, replace = TRUE),
  value = rnorm(200)
)

# Auto-partition and save
st_write_parts(
  welfare,
  base = "data/welfare_parts",
  partitioning = c("country", "year", "reporting_level"),
  code_label = "welfare_partition"
)

# Result: files saved to:
#   data/welfare_parts/country=USA/year=2020/reporting_level=national/part.qs2
#   data/welfare_parts/country=USA/year=2020/reporting_level=urban/part.qs2
#   ... etc
}

}
